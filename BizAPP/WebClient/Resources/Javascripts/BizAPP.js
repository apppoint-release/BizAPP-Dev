/*!*
* Copyright (C) 2000 - 2011, AppPoint Software Solutions.
* The program code and other information contained herein are not for public use, 
* include confidential and proprietary information owned by AppPoint Software Solutions. 
* Any reproduction, disclosure, reverse engineering, in whole or in part, is prohibited 
* unless with prior explicit written consent of AppPoint Software Solutions. 
*
* This software is protected by local Copyright law, patent law, and international treaties.
* Unauthorized reproduction or distribution may be subject to civil and criminal penalties and is 
* strictly prohibited. Portions of this program code, documentation, processes, and information 
* could be patent pending.
* 
**/
var callServer;var sourceObj;var ajaxArgs;var sourceId;var requestId=0,loginusingbizappoauth="";var popUpControls=new Array();var nonAjaxRequests=new Array();var delegateControls=new Array();var enterpriseBody;var enableAjax=true;var g_customAjax=true,g_useJSONForCustomAjax=true,g_forceSyncCalls=false;var g_enableLog=false;var g_activeCtrl=null;var g_locked=false;var exceptionStack="";var logStack="";var isPopupCalledBySilverlight=false;var popupCallBackElementId="";var popupCallBackElementDetails="";var dependentFiles=new Array();var onMessageCallbacks={};var sessions={};function getControlToReplace(e){var d=e.parent();var a=e.attr("id");var b=d.attr("id");var f=d.attr("bza_targetid");while(a&&(a==b||a==f)){e=e.parent();var d=e.parent();b=e.parent().attr("id");f=d.attr("bza_targetid")}return e}function refreshTargetFrame(a,b){if(!a&&!b){var d=document.getElementById(a);if(!d){d.setAttribute("src",b)}}}function validateJavaAuthenticationControl(d,q){var k=document.getElementById("BizAPPAuthenticationControlContainer");var p=document.getElementById("AuthenticationContainer");k.style.display="none";p.style.display="block";var f;if(deployJava&&deployJava.versionCheck(q+"+")){var b=document.getElementById("BizAPPAuthenticationControl");if(b){var e=document.getElementById("MacIdHolder");if(e){e.value=f="";try{do{}while(!b.getIsReady());var a=b.getMacAddresses().split(",");var t=b.getIpV4Addresses().split(",");var h=b.getIpV6Addresses().split(",");if(t.length>0&&a.length==t.length&&t.length==h.length){for(var m=0;m<a.length;m++){var v=a[m];var o=t[m];var u=h[m];if(v&&o&&u){f+=v+","+o+","+u+";"}}}e.value=f}catch(n){logError("failed to get macid.",n)}}}}else{logError(d.format(q))}}String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,d){return typeof a[d]!="undefined"?a[d]:"{"+d+"}"})};if(!String.prototype.encodeHTML){String.prototype.encodeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}if(g_customAjax){String.prototype.startsWith=function(b){return this.substr(0,b.length)===b};String.prototype.endsWith=function(a){return this.length>=a.length&&this.substr(this.length-a.length)==a};String.prototype.trimLeft=function(){return this.replace(/^\s*/,"")};String.prototype.trimRight=function(){return this.replace(/\s*$/,"")};String.prototype.trim=function(){return this.trimRight().trimLeft()}}function jqExtns(){if(typeof jQuery!="undefined"){if(!jQuery.cachedScript){$(document).ajaxSend(function(b,d,a){$.ajax.mostRecentCall=d;$.ajax.mostRecentCall.settings=a});jQuery.cachedScript=function(b,a){a=$.extend(a||{},{dataType:"script",cache:true,url:b});return jQuery.ajax(a)}}if(!$.getCss){$.extend({getCss:function(e,f,b){if(isIE()==8){$('style[url="'+e+'"]').remove();$.get(e,function(a){$("head").append('<style url="'+e+'">'+a+"</style>");if(typeof f=="function"){f()}})}else{$('link[href="'+e+'"]').remove();if(b){var d=$(b)}if(d&&d.length>0){$("<link>",{rel:"stylesheet",type:"text/css",href:e,media:"screen"}).on("load",function(){if(typeof f=="function"){f()}}).insertBefore(b)}else{$("<link>",{rel:"stylesheet",type:"text/css",href:e,media:"screen"}).on("load",function(){if(typeof f=="function"){f()}}).appendTo("head")}}}})}$.fn.findSelf=function(d){var e=this.find(d);return(this.is(d))?e.add(this):e}}}jqExtns();function callGetCurrentTimeZoneName1(){tmSummer=new Date(Date.UTC(2001,6,30,0,0,0,0));so=-1*tmSummer.getTimezoneOffset();tmWinter=new Date(Date.UTC(2001,12,30,0,0,0,0));wo=-1*tmWinter.getTimezoneOffset();var a="Greenwich Standard Time";if(so==0&&wo==0){a="Morocco Standard Time"}else{if(so==60&&wo==0){a="GMT Standard Time"}else{if(so==0&&wo==0){a="Greenwich Standard Time"}else{if(so==120&&wo==60){a="W. Europe Standard Time"}else{if(so==120&&wo==60){a="Central Europe Standard Time"}else{if(so==120&&wo==60){a="Romance Standard Time"}else{if(so==120&&wo==60){a="Central European Standard Time"}else{if(so==60&&wo==60){a="W. Central Africa Standard Time"}else{if(so==180&&wo==120){a="Jordan Standard Time"}else{if(so==180&&wo==120){a="GTB Standard Time"}else{if(so==180&&wo==120){a="Middle East Standard Time"}else{if(so==180&&wo==120){a="Egypt Standard Time"}else{if(so==120&&wo==120){a="South Africa Standard Time"}else{if(so==180&&wo==120){a="FLE Standard Time"}else{if(so==120&&wo==120){a="Israel Standard Time"}else{if(so==180&&wo==120){a="E. Europe Standard Time"}else{if(so==60&&wo==120){a="Namibia Standard Time"}else{if(so==240&&wo==180){a="Arabic Standard Time"}else{if(so==180&&wo==180){a="Arab Standard Time"}else{if(so==240&&wo==180){a="Russian Standard Time"}else{if(so==180&&wo==180){a="E. Africa Standard Time"}else{if(so==180&&wo==180){a="Georgian Standard Time"}else{if(so==270&&wo==210){a="Iran Standard Time"}else{if(so==240&&wo==240){a="Arabian Standard Time"}else{if(so==300&&wo==240){a="Azerbaijan Standard Time"}else{if(so==240&&wo==240){a="Mauritius Standard Time"}else{if(so==300&&wo==240){a="Caucasus Standard Time"}else{if(so==270&&wo==270){a="Afghanistan Standard Time"}else{if(so==360&&wo==300){a="Ekaterinburg Standard Time"}else{if(so==300&&wo==300){a="Pakistan Standard Time"}else{if(so==300&&wo==300){a="West Asia Standard Time"}else{if(so==330&&wo==330){a="India Standard Time"}else{if(so==330&&wo==330){a="Sri Lanka Standard Time"}else{if(so==345&&wo==345){a="Nepal Standard Time"}else{if(so==420&&wo==360){a="N. Central Asia Standard Time"}else{if(so==360&&wo==360){a="Central Asia Standard Time"}else{if(so==390&&wo==390){a="Myanmar Standard Time"}else{if(so==420&&wo==420){a="SE Asia Standard Time"}else{if(so==480&&wo==420){a="North Asia Standard Time"}else{if(so==480&&wo==480){a="China Standard Time"}else{if(so==540&&wo==480){a="North Asia East Standard Time"}else{if(so==480&&wo==480){a="Singapore Standard Time"}else{if(so==480&&wo==480){a="W. Australia Standard Time"}else{if(so==480&&wo==480){a="Taipei Standard Time"}else{if(so==540&&wo==540){a="Tokyo Standard Time"}else{if(so==540&&wo==540){a="Korea Standard Time"}else{if(so==600&&wo==540){a="Yakutsk Standard Time"}else{if(so==570&&wo==630){a="Cen. Australia Standard Time"}else{if(so==570&&wo==570){a="AUS Central Standard Time"}else{if(so==600&&wo==600){a="E. Australia Standard Time"}else{if(so==600&&wo==660){a="AUS Eastern Standard Time"}else{if(so==600&&wo==600){a="West Pacific Standard Time"}else{if(so==600&&wo==660){a="Tasmania Standard Time"}else{if(so==660&&wo==600){a="Vladivostok Standard Time"}else{if(so==660&&wo==660){a="Central Pacific Standard Time"}else{if(so==720&&wo==780){a="New Zealand Standard Time"}else{if(so==720&&wo==720){a="Fiji Standard Time"}else{if(so==780&&wo==780){a="Tonga Standard Time"}else{if(so==0&&wo==-60){a="Azores Standard Time"}else{if(so==-60&&wo==-60){a="Cape Verde Standard Time"}else{if(so==-60&&wo==-120){a="Mid-Atlantic Standard Time"}else{if(so==-180&&wo==-120){a="E. South America Standard Time"}else{if(so==-180&&wo==-180){a="Argentina Standard Time"}else{if(so==-180&&wo==-180){a="SA Eastern Standard Time"}else{if(so==-120&&wo==-180){a="Greenland Standard Time"}else{if(so==-180&&wo==-120){a="Montevideo Standard Time"}else{if(so==-150&&wo==-210){a="Newfoundland Standard Time"}else{if(so==-180&&wo==-240){a="Atlantic Standard Time"}else{if(so==-240&&wo==-240){a="SA Western Standard Time"}else{if(so==-240&&wo==-180){a="Central Brazilian Standard Time"}else{if(so==-240&&wo==-180){a="Pacific SA Standard Time"}else{if(so==-270&&wo==-270){a="Venezuela Standard Time"}else{if(so==-300&&wo==-300){a="SA Pacific Standard Time"}else{if(so==-240&&wo==-300){a="Eastern Standard Time"}else{if(so==-300&&wo==-300){a="US Eastern Standard Time"}else{if(so==-360&&wo==-360){a="Central America Standard Time"}else{if(so==-300&&wo==-360){a="Central Standard Time"}else{if(so==-300&&wo==-360){a="Central Standard Time (Mexico)"}else{if(so==-360&&wo==-360){a="Canada Central Standard Time"}else{if(so==-420&&wo==-420){a="US Mountain Standard Time"}else{if(so==-360&&wo==-420){a="Mountain Standard Time (Mexico)"}else{if(so==-360&&wo==-420){a="Mountain Standard Time"}else{if(so==-420&&wo==-480){a="Pacific Standard Time"}else{if(so==-420&&wo==-480){a="Pacific Standard Time (Mexico)"}else{if(so==-480&&wo==-540){a="Alaskan Standard Time"}else{if(so==-600&&wo==-600){a="Hawaiian Standard Time"}else{if(so==-660&&wo==-660){a="Samoa Standard Time"}else{if(so==-720&&wo==-720){a="Dateline Standard Time"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return a}function callGetCurrentTimeZoneName(){BizAPP.Session.SetTimeZone(callGetCurrentTimeZoneName1())}function initializeDebugConsole(a){if(a==true||a=="true"){callShowLogs()}}function clearExceptionLog(a){exceptionStack="";callShowErrors()}function clearLog(a){logStack="";callShowLogs()}function addExceptionLog(b){var a="",d="";$.each(b.split("Message:"),function(e,f){if(f){a+="\n"+d+"Message:"+f.replace(/\n/g,"\n"+d);d+="\t"}});b=a;if(window.dialogArguments){window.dialogArguments.exceptionStack='<font color="red"  size="3">*** Exception Stack Begin***\n</font>'+b+'\n<font color="red"  size="3">*** Exception Stack End***</font>\n\n\n\n'+window.dialogArguments.exceptionStack}else{exceptionStack='<font color="red"  size="3">*** Exception Stack Begin***\n</font>'+b+'\n<font color="red"  size="3">*** Exception Stack End***</font>\n\n\n\n'+exceptionStack}}function logError(b,a){if(a){if(isIE()){addLog(b+" : "+a.name+" : "+a.message,true)}else{addLog(b+" : "+a.toString(),true)}}else{addLog(b,true)}}function addLog(b,a){if(g_enableLog||location.href.toLowerCase().indexOf("enterpriseview.aspx")==-1){if(a){b="<font color=Red>\n"+b+"</font>"}logStack=b+logStack;if(typeof console!="undefined"){if(a){console.error(b)}else{console.info(b)}}}}function setAjaxTimeout(a){try{if(typeof AjaxPro!="undefined"){AjaxPro.timeoutPeriod=a}}catch(b){logError("Set Ajax Timeout failed",b)}}function getNextRequestId(){requestId++;return requestId}function getCurrentRequestId(){return requestId}function callMinimize(a){toggle(a)}function expand(e,a,d){if(isIE()){if(e.getAttribute("maximized")!="true"){e.setAttribute("maximized","true");e.setAttribute("orileft",e.style.left);e.setAttribute("oritop",e.style.top);e.style.zIndex=110;if(e.style.pixelHeight==0){var b=getValidSizedParent(e);e.setAttribute("oriheight",b.style.pixelHeight);e.setAttribute("oriwidth",b.style.pixelWidth);e.setAttribute("oriposition",b.style.position)}else{e.setAttribute("oriheight",e.style.pixelHeight);e.setAttribute("oriwidth",e.style.pixelWidth);e.setAttribute("oriposition",e.style.position)}e.style.left="0px";e.style.top="0px";e.style.pixelHeight=a;e.style.pixelWidth=d}else{e.setAttribute("maximized","false");e.style.zIndex=100;e.style.left=e.getAttribute("orileft");e.style.top=e.getAttribute("oritop");e.style.pixelHeight=e.getAttribute("oriheight");e.style.pixelWidth=e.getAttribute("oriwidth");e.style.position=e.getAttribute("oriposition")}}}function collapseResize(d,a,b){if(d.getAttribute("maximized")!=true){d.setAttribute("maximized",true);d.style.pixelHeight=a;d.style.pixelWidth=b}else{d.setAttribute("maximized",false);d.style.height=d.getAttribute("oriheight");d.style.width=d.getAttribute("oriwidth")}}function callRestore(d){var n=getElementByBizAPPId(d);var q=getClientHeight();var e=getClientWidth();if(n){expand(n,q,e);var t=n.children[0];collapseResize(t,q,e);var b=t.children[0].children[0].children[0].children[0].children[0].children[0].children[1];collapseResize(b,b.style.height,e);var o=q-20;var f=t.children[0].children[1];collapseResize(f,o,e);var a=f.children[0];collapseResize(a,o,e);var p=a.children[0];collapseResize(p,o,e);var m=p.children[0].children[0];collapseResize(m,o,e);var h=m.children[0];collapseResize(h,o,e);var k=h.children[0];collapseResize(k,o,e)}document.body.innerHTML=document.body.innerHTML}function callRestoreControl(e,b,a){display(e);if(RestoreControl!=null){var d=new Array();d[0]="RestoreBackControl";d[1]=b;d[2]=a;callMinimizeControl(d)}}function hide(b){var a=getElementByBizAPPId(b,"div");if(a!=null){a.style.display="none"}}function display(b){var a=getElementByBizAPPId(b,"div");if(a!=null){a.style.display="block"}}function toggle(b){var a=getElementByBizAPPId(b,"div");if(a!=null){if(a.style.display!="none"){a.style.display="none"}else{a.style.display="block"}}}var enableDebug=false;var lastFunCall="";var _session__=new Array();var applyStepEvents=new Array();var eventList=new Array();var enterprise="enterprise";var enableCopy=false;var stack=new Array();var appbuliderid="BizAPPid";var _sessionid__;var _userUid__;var _enterpriseName__,__bts_,_srServer__;var _allowScriptTagInput__;var activeRecordArgs;var debugLevel="exception;debug;info";var showDebug="exception;";function debug(k,n,m,d,h,a){m=m||"";d=d||false;if(enableDebug==true){if(n=="info"){displayStatus(k)}}addLog(k);if(showDebug.indexOf(n)>=0){var b="";if(k.indexOf("[type]")!=-1){k=k.split("[type]");b=k[1];k=k[0]}try{BizAPP.UI.InlinePopup.Alert({title:"",errorMessage:k,btnOk:true,txtOk:"OK",type:b,addnInfo:m,btnCancel:d,txtCancel:h,txtCancelOnclick:a})}catch(f){alert(k)}}}function callPopupExceptions(a){a=a.replace(/\[SQ]/g,"'");a=a.replace(/\[NL]/g,"\n");a=a.replace(/\[TB]/g,"\r");displayMessage(a)}var eventManager=new Array(),g_customTooltip=0;function getSessionId(){return _sessionid__}function getEnterpriseName(){return _enterpriseName__}function setEnterpriseName(a,e,b,t,k,o,q,d,n,f,p){if(window.localStorage){localStorage.removeItem("html.navurl")}_enterpriseName__=a;_userUid__=e;_sessionid__=b;_srServer__=f;g_enableLog=t=="0"?false:true;BizAPP.Session.__dateFormat=k;BizAPP.Session.__datetimeFormat=o;g_appBasePath=BizAPP.UI.basePath=q;BizAPP.UI.appendBasePath=(p.appendbasepath=="true");__bts_=n;g_customTooltip=p.customtooltip;g_blockedExtns=p.blockedfileextensions;__readonlyajaxcalls=JSON.parse(p.readonlyajax);BizAPP.UI.controlMapping=p.UIControlMapping;BizAPP.UI.controlDependency=p.UIControlDependency;BizAPP.UI.controlSelector=p.UIControlSelector;_allowScriptTagInput__=p.AllowScriptTagInput;BizAPP.UI.impersonateField=p.ImpersonateField;BizAPP.UI.widgetChartHeight=p.WidgetChartHeight;BizAPP.UI.InlinePopup._template=p.InlinePopupTemplate;BizAPP.UI.brandName=p.brandname;BizAPP.UI.brandUrl=p.brandurl;BizAPP.UI.firstAccess=p.FirstAccess;BizAPP.UI.currentApplication=JSON.stringify(p.currentApplication);jqExtns();if(location.href.toLowerCase().indexOf("diagnostics.aspx")==-1&&location.href.toLowerCase().indexOf("navigationpage.aspx")==-1){if(location.href.toLowerCase().indexOf("enterpriseview.aspx")==-1){callGetCurrentTimeZoneName()}if(location.href.toLowerCase().indexOf("testview.aspx")==-1){setTimeout(function(){localStorage.setItem("BZA_CollabdeskInfo",JSON.stringify({srServer:_srServer__,sessionId:_sessionid__,userUid:_userUid__,fullName:d,bts:__bts_}));initHub(_srServer__,_sessionid__,_userUid__,d,__bts_,function(){},{loadChat:p.loadSignalr})},location.href.toLowerCase().indexOf("collaboration.aspx")==-1?5000:0)}}var h=BizAPP.UI.controlDependency.type;if(h){var m;switch(h){case"controlset":break}if(m){$.cachedScript(BizAPP.UI.GetBasePath(m)).done(function(){console.log("Control set js download.")})}}if(!isMobile.any()){document.addEventListener("visibilitychange",function(){if(document.hidden){}else{var u=BizAPP.Session.EvaluateExpression({expression:"Session.sessionid",sync:true,compute:true}).value[1];if(_sessionid__!=JSON.parse(u)){location.reload()}}})}}function initSystemTray(){if(location.href.toLowerCase().indexOf("diagnostics.aspx")==-1&&location.href.toLowerCase().indexOf("navigationpage.aspx")==-1&&location.href.toLowerCase().indexOf("collaboration.aspx")==-1){$.cachedScript(BizAPP.UI.GetBasePath("Resources/SystemTray/systemTray.js?v="+__bts_)).done(function(a,b){BizAPP.SystemTray.Init();setTimeout(function(){if(BizAPP.UI.firstAccess){BizAPP.Session.EvaluateExpression({expression:"dataexist:ESystemb1686",callback:function(d){var e=d=="True";if(e){BizAPP.UI.Toast.Notify({title:"Job(s) Completed",text:"You have jobs completed since your last visit.",type:"info"})}}})}BizAPP.SystemTray.AddMenu({id:"bza-mobile-menu",html:'<i class="fa fa-mobile" title="Mobile"></i>',click:function(){BizAPP.UI.LoadView({inlinePopup:true,url:"uiview.asmx?html.jar=true&html.args=runtimeviewenterpriseid[NVS]"+BizAPP.UI.MobileSystemTrayView})}});BizAPP.SystemTray.AddMenu({id:"bza-JR-menu",html:'<i class="fa fa-ticket" title="My Job Requests"></i>',click:function(){BizAPP.UI.LoadView({inlinePopup:true,url:"uiview.asmx?html.jar=true&html.args=runtimeviewenterpriseid[NVS]"+BizAPP.UI.JobRequestSystemTrayView})}})},5000)})}}function initHub(k,a,d,e,h,f,b){$.cachedScript(BizAPP.UI.GetBasePath("resources/javascripts/jquery.signalR.js?v="+__bts_)).done(function(m,n){$.cachedScript(BizAPP.UI.GetBasePath("resources/javascripts/boothubs.js?v="+__bts_)).done(function(o,p){BizAPP.UI.Hub.Boot((k?k:BizAPP.UI.basePath),a,d,e,h,f,b)})})}function setSessionId(a){_sessionid__=a}function pushEvent(a){stack.push(a)}function popEvent(a){if(a&&a.stack){return a.stack.pop()}}function navigateToCurrentViewWithObject(d,a,b){ajaxAsyncCall("HelperEx",["NavigateToCurrentViewWithObject",d,a,b],false,true)}function navigateToCurrentView(){ajaxAsyncCall("HelperEx",["NavigateToCurrentView"],false,true)}function navigateToPreviousView(){ajaxAsyncCall("HelperEx",["NavigateToPreviousView"],false,true)}function setFocus(a){try{var b=getElementByBizAPPId(a);if(b!=null&&b.disabled==false){b.focus();if(b.tagName!="SPAN"&&b.tagName!="DIV"&&b.tagName!="SELECT"&&b.tagName!="TABLE"){b.select()}}}catch(d){}}function setForceFocus(d,b){var a=document.activeElement;if(a&&(a.tagName=="INPUT"||a.tagName=="TEXTAREA")){$(a).blur()}if(b==null){b=window.event}if(b){try{var e=getElementByBizAPPId(d);if(e!=null&&e.disabled==false){e.style.position="absolute";e.style.left=b.clientX;e.style.top=b.clientY;e.focus();if(e.tagName!="SPAN"&&e.tagName!="DIV"&&e.tagName!="SELECT"&&e.tagName!="TABLE"){e.select()}}}catch(f){}}}function ProcessingStatus(a,b){ProcessingStatus1(a,b)}function ProcessingStatus1(a,b){if(b==true||b=="true"){var d=getElementByBizAPPId("Processing","div");if(d){if(a==true){d.style.left="0";d.style.top="0";d.style.display="block";if(!isIE7()){d.style.position="fixed"}}else{d.style.display="none"}}}}function activeRecordChanged(method,eventName,source,activeRecord,args){activeRecordArgs=args;var call=method+" ( '"+eventName+"', '"+source+"', '"+activeRecord+"');";addLog("\n"+call);try{eval(call)}catch(Error){logError("activeRecordChanged failure - "+call,Error)}}function fireActiveRecordChanged(h,b,e,a){var f=getElementByBizAPPId(a,"select",false);var d="";if(f){d=f.value}activeRecordChanged(h,b,e,d)}function callMinimizeControl(a){ajaxAsyncCall("RestoreEx",a,false)}function isWebkit(){return/webkit/.test(navigator.userAgent.toLowerCase())}function isChrome(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&navigator.userAgent.toLowerCase().indexOf("edge")==-1}function isSafari(){return navigator.userAgent.toLowerCase().indexOf("safari")>-1&&navigator.userAgent.indexOf("Chrome")==-1}function isFirefox(){return navigator.userAgent.indexOf("Firefox")!=-1?true:false}function isIE(){var a=0;if(navigator.appVersion.indexOf("MSIE")!=-1){temp=navigator.appVersion.split("MSIE");a=parseFloat(temp[1])}!a?(navigator.userAgent.match(/Trident.*rv\:11\./)?a=11:null):null;return a}function isIE6(){var a=isIE();return(a==6)}function isIE7(){var a=isIE();return(a==7)}function getCheckBoxValue(d){var b="uncheckedvalue";var a;if(d.tagName.toLowerCase()=="select"){var e=d.getElementsByTagName("INPUT")[0];if(e&&e.checked){b="checkedvalue"}a=getAttributeValue(d,b)}else{if(d.tagName.toLowerCase()=="input"){if(d.checked){b="checkedvalue"}a=getAttributeValue(d,b);if(!a){a=getAttributeValue(d.parentNode,b)}}}return a}function getRichTextBoxValue(e,f){if(e.childNodes.length>0){var h=e.childNodes[0].src;var b=null;for(var d=0;d<document.frames.length;d++){if(document.frames(d).location.href==h){b=document.frames(d);break}}if(b){switch(f){case"formrichtext":return b.frames(0).document.documentElement.childNodes[1].innerHTML;break;case"forminrichtext":var a=b.document.getElementById("WebHtmlEditor_tw");if(a){return a.innerHTML}break}}}return null}var freeTextContent;function getFreeTextBoxValue(b){var a=document.getElementById("RichText_htmlEditorArea");if(a){var d;if(isIE()){d=a.childNodes[0].innerText}else{d=a.childNodes[1].value}freeTextContent=d;return d}return null}var g_ig_richtextchc;function ig_richtextsave(d,b,a){window.top.BizAPP.UI.Textbox.setValue(d)}function getElementByGroupId(b,a){var f=getAllElements();for(var e=0;e<f.length;e++){var d=f[e];if(d.tagName&&d.getAttribute(b)==a){return d}}}function getElementsByGroupId(b,a){var h=getAllElements();var k=new Array();var f;var d=0;for(f=0;f<h.length;f++){var e=h[f];if(e.tagName&&e.getAttribute(b)==a){k[d++]=e}}return k}function getElementByBizAPPIdFromRoot(b,a){return getElementByBizAPPId(b,a,true)}function getElement(d,f){var a;var e=new Array();for(var b=0;b<d.length;b++){a=d[b].getAttribute("BizAPPid");if(a!=null&&a!=d[b].id){e[a]=d[b].id}if(a==f){return d[b]}}return null}function getElementByBizAPPId(a){return getElementByBizAPPId(a,"DIV",false)}function getElementsByBizAPPId(k,b){var h=new Array();var n=new Array();var d=0;for(var f=0;f<k.length;f++){var a=k[f];var e=document.getElementById(a);if(e){h[a]=e}else{n[d]=a;d=d+1}}var m=null;if(n.length==1){h[n[0]]=getElementByBizAPPId(n[0])}else{if(n.length>1){m=getElementsForIE(b,null)}}if(m){for(var f=0;f<m.length;f++){h[m[f].getAttribute("bizappid")]=m[f]}}return h}function getElementByBizAPPId(d,a,f){var b;if(d==""||!d){return b}b=document.getElementById(d);if(b&&a){if(b.nodeName.toLowerCase()!=a.toLowerCase()){b=null}}if(b!=null){return b}try{b=$('[bizappid="'+d+'"]')[0];if(b!=null){return b}}catch(e){}b=getElementForMozilla(d,a,f);if(isIE()&&b==null&&a==undefined){b=getElementForIE(d,f)}return b}function getElementForMozilla(e,a,k){if(!a){a="DIV"}var h;var d;if(k){d=this.parent.document}else{d=document}try{if(!isIE()){h=d.getAnonymousElementByAttribute(document.documentElement,"BizAPPid",e)}}catch(f){}if(h){return h}h=d.getElementsByTagName(a);var b=getElement(h,e);return b}function getElementsForIE(h){var a;var f=new Array();var b=0;var e=getAllElements();for(var d=0;d<e.length&&h.trim();d++){if(e[d].attributes!=null){a=e[d].getAttribute("bizappid");if(a&&h.indexOf(a+" ")>-1){f[b++]=e[d];while(h.indexOf(a+" ")>-1){h=h.replace(a+" ","")}}}}return f}function getElementForIE(a,d){if(a==null||a==""){debug("Empty customid passed","info")}else{try{if(d&&this.parent.document){return getElement(this.parent.document.all,a)}else{return getElement(document.all,a)}}catch(b){}}}function evalAjaxActualCall(){var result=eval(lastFunCall);replaceControls(result)}function evalAjaxCall(funcName,args,context){var evalCall=funcName+"( "+args+" );";eval(evalCall)}function hidePopups(){hideContextMenu();hideCalendar()}function showDialog(f,b,e,d){debug("Please Wait, Loading Popup","info");if(d==null){d="yes"}x=document.documentElement.offsetWidth/3;y=document.documentElement.offsetHeight/2;try{var a=OpenModalDialog(f,b,e,x,y,"yes","yes");return a}catch(h){if(h.message.trim()=="Access is denied."){displayMessage("Popup has been blocked, Please enable this site in the popup blockers allowed site list and try again. \n Tools - Pop-up Blocker - Pop-up Blocker Settings")}else{displayMessage(h.description.trim())}}}function showDialogWithOptions(h,b,e,d,f){debug("Please Wait, Loading Popup","info");if(d==null){d="yes"}x=document.documentElement.offsetWidth/3;y=document.documentElement.offsetHeight/2;try{var a=OpenModalDialog(h,b,e,x,y,"yes","yes");if(!a&&a!=null){a=false}else{handleEvent(a)}return a}catch(k){if(k.message.trim()=="Access is denied."){displayMessage("Popup has been blocked, Please enable this site in the popup blockers allowed site list and try again. \n Tools - Pop-up Blocker - Pop-up Blocker Settings")}else{displayMessage(k.description)}}}function callValidateShowDialog(b,a){if(!a){ajaxAsyncCall("HelperEx",["ValidatePopupCall",b],false)}}function getCheckBoxSelection(a){var b=getPersistedValue(g_gridStoreName,a);if(b){b=b.concat(",")}else{b=""}b=b.concat(getGridSelectedValues(a));removePersistedValue(g_gridStoreName,a);b=eliminateDuplicatesFromArray(b.split(",")).join(",");return b}function eliminateDuplicatesFromArray(b){var e,a=b.length,d=[],f={};for(e=0;e<a;e++){f[b[e]]=0}for(e in f){d.push(e)}return d}function getGridSelectedValues(e){var b="";var a;if(isIE()){a=$('[name="BizAPP.object"][checked][type=checkbox][bizappid="'+e+'"]')}else{a=$('[name="BizAPP.object"][type=checkbox][bizappid="'+e+'"]')}if(a&&a.length==0){if(isIE()){a=$('[name="BizAPP.object"][checked][type=radio][bizappid="'+e+'"]')}else{a=$('[name="BizAPP.object"][type=radio][bizappid="'+e+'"]')}}if(a){for(i=0;i<a.length;i++){var d=a[i];if(d.checked==true){if(b!=""){b=b.concat(",")}b=b.concat(d.id)}}if(b){return b}}if((!a||a.length==0)&&isIE()){a=document.getElementsByName("BizAPP.object")}if(!a||a.length==0){a=document.getElementsByTagName("INPUT")}if(a!=null){if(a.length!=null){for(i=0;i<a.length;i++){var d=a[i];if(d.getAttribute("BizAPPid")==e){if(d.tagName.toLowerCase()=="input"){if(d.type=="checkbox"){if(d.checked==true){if(b!=""){b=b.concat(",")}b=b.concat(d.id)}}else{if(d.type=="radio"){if(d.checked==true){b=b.concat(d.id)}}}}}}}}return b}function getControlName(a){switch(a){case"ViewBusinessObjectForm":return"OutlineControl";case"ViewDataGrid":return"GridControl";case"ViewTreeControl":return"TreeControl"}}function getSessionValue(a){return _session__[a]}function setSessionValue(a,b){_session__[a]=b}function getContextById(a){return getSessionValue(a)}function getContext(a){return a;return getSessionValue(a+"_context")}function bza_getSize(b){var d=getElementByBizAPPId(b);if(d){var a=getWidth(d)+","+getHeight(d);return a}}function fireEvents(d){if(d){if(d.length<4){var b=d;d=window.sessionStorage.getItem(b);window.sessionStorage.removeItem(b)}var a=new Array();a=d.split("[ES]");for(j=0;j<a.length;j++){var e=a[j];handleEvent(e)}handleEvents(false)}}function handleEvent(a){if(a!=null){eventList.push(a)}}function handleEvents(callback){while(eventList.length>0){var eve=eventList.shift();try{eval(eve)}catch(Error){if(Error.message==="event is not defined"){var event;try{eval(eve)}catch(Error){logError("Event handling failed - "+eve,Error)}}else{logError("Event handling failed - "+eve,Error)}}}if(callback){setTimeout(handleEvents,100)}}function getClassName(b){var a=b;while(a!=null&&a.className==null){a=a.parentNode}if(a.className!=null&&a.className.length!=0){return a.className}if(a.parentNode){return a.parentNode.className}return null}function displayDebugs(a){if(a!=null&&a.length>0){debug(a.replace("[DBS]","\n"),"debug");$.each(a.split("[DBS]"),function(){addExceptionLog(this)})}}function displayExceptions(f,a){if(f!=null&&f.length>0){var e=f.split("[EXS]");var b=[];if(a){b=a.split("[DBS]")}for(var d=0;d<e.length;d++){if(b[d]){if($.ajax.mostRecentCall&&$.ajax.mostRecentCall.settings&&$.ajax.mostRecentCall.settings.data){if(JSON.parse($.ajax.mostRecentCall.settings.data).type!="CredentialsEx"){b[d]=b[d]+$.ajax.mostRecentCall.settings.data.encodeHTML()}}b[d]='<div id="err_tech" class="err-tech"><hr>'+b[d]+"</div>"}debug(e[d],"exception",b[d])}}}function callSetInMemoryObjects(a,d,b){ajaxAsyncCall("OptGridEx",["SetInMemoryObjects",b,getcbValue(a)],true,true)}function callSetDefaultQuery(h,m,f){var e,d;var k=getSourceElement(h);if(k){var n=k.parentNode.parentNode.previousSibling.children[0];e=n.value;d=n.options[n.selectedIndex].getAttribute("ispq")}ajaxAsyncCall("OptGridEx",["SetDefaultQuery",f,getcbValue(m),e,d],true,true)}function getcbValue(d){var a="uncheckedvalue";if(d.tagName=="input"||d.tagName=="INPUT"){if(d.checked){a="checkedvalue"}return getAttributeValue(d.parentNode,a)}else{for(var b=0;b<d.childNodes.length;b++){if(d.childNodes[0].tagName=="input"&&d.childNodes[0].checked){a="checkedvalue"}}}return getAttributeValue(d,a)}function callSearchInline(a,d,b){ajaxAsyncCall("OptGridEx",["DoSearchInline",a,d,getFilter(b)],true,true)}function callOriginalGridFromSearchInline(a){ajaxAsyncCall("OptGridEx",["OriginalGridFromSearchInline",a],true,true)}function callMSROLink(b,a,d,e){if(!e){return}ajaxSyncCall("OptGridEx",["EvaluateMSROLink",b,a,d.replace(/\[BSQ]/g,"'")])}var g_MSROContext;function callEvaluateMultiSelectLink(n,k,b,f,h,m){if(!f){displayMessage(BizAPP.UI.Localization.NoRecordsSelected);return}var a=parseInt($(n).closest("[bza_msbc]").attr("bza_msbc"));if(!a){a=5}if(!m&&f.split(",").length>a){var d=[];var e=f.split(",");$.each(e,function(p,o){if(p<a){d.push(e.shift())}});g_callBacks.push(function(){callEvaluateMultiSelectLink(n,k,b,e.join(","),h)});InternalMultiSelectLink(n,k,b,d.join(","),h)}else{InternalMultiSelectLink(n,k,b,f,h)}}function InternalMultiSelectLink(h,f,m,n,k){var e,d;e=getMSCbValue(m);if(!e){e="false"}if(g_MSROContext){d=g_MSROContext;g_MSROContext=undefined;ajaxAsyncCall("OptGridEx",["EvaluateMultiSelectLinks",f,e,n,k,d],true,true);return}ajaxAsyncCall("OptGridEx",["EvaluateMultiSelectLinks",f,e,n,k],true,true)}function getMSCbValue(d){var b=getElementByBizAPPId(d);var a;if(b){if(isIE()&&b.childNodes>0){a=b.childNodes[0].checked.toString()}else{if(b.childNodes>1){a=b.childNodes[1].checked.toString()}}}else{b=getElementByBizAPPId(d,"input");if(b){a=b.checked.toString()}}return a}function callEvaluateContextMenuLink(e,d,f){var b=getAttributeValue(contextMenuObj,"roid");hideContextMenu();if(b){ajaxAsyncCall("OptGridEx",["EvaluateContextMenuLink",d,f,b],true,true)}}function callEvaluateAdditionalLink(b,a,d){ajaxAsyncCall("OptGridEx",["EvaluateAdditionalLink",a,d],true,true)}function getAFChildMetaData(m,k,b){var f=$(m).parent();var h=f.children(".gExpPP");var e="collapse";if(h.length==0){e="cbExpText gExpPP";f.children("div").hide();h=f.children(".collapse")}else{if(h.length==1){var d=f.children("div");if(d.length==1){d.show()}else{var a=ajaxSyncCallAndNoResponseHandler("OptGridEx",["GetChildFields",b,k,$(m).attr("fieldName")]);$(m).parent().append(a.value[1])}}}h[0].className=e}function callAddGPQuery(d,f,b){if(!b){b=window.event}var a=getSourceElement(b);if(a){a=$(a).closest("table")[0];var m="<span>Create Query</span>";var e='<div class="bza-pq-cont"><input type="radio" name="type" onclick="SwitchView(false)"        value="addpq" checked>Add Personalized Query <input type="radio" name="type" onclick="SwitchView(true)" value="create">Create New Query        <div id="PersonalizedQueryContainer" class="personalize-query" style="padding:10px;"><div chc="'+d+'" style="padding: 5px; width: 300px; height: 30px;"> <span>Query Name : </span><input class="formtextbox" id="tbQueryName"         style="width: 205px"></div>';if(f.toLowerCase()=="true"){e+='<div style="padding: 5px;"><input class="formcheckbox" type="checkbox" style="margin-left: 0pt;"><span>                             Show Query To All Users</span></div>'}e+='<div id="CreateQueryContainer" class="create-query" style="padding:10px;display:none"></div></div>';var h='<div><table cellspacing="0" cellpadding="0" align="Left" style="border-collapse:collapse;"><tbody><tr valign="top"><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="S" class="stepcenternormal" onclick="backGroundBlocker( \'true\');callAddPQuery();zoomout();" prevstate="normal">Ok</span></div></td><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="C" class="stepcenternormal cancelstep" onclick="zoomout();">Cancel</span></div></td></tr></tbody></table></div>';var n={headline:m,body:e,steps:h};var k=BizAPP.UI.InlinePopup.GetMarkupWithTemplate(n);BizAPP.UI.InlinePopup.CreateNew({html:addWindowEvent(k),stropenjs:' $(".bizappContainer").css("min-width", "");'})}}function SwitchView(a){if(a){$("#CreateQueryContainer").show();if(!$.trim($("#CreateQueryContainer").html())){BizAPP.UI.LoadView({url:"uiview.asmx?html.args=runtimeviewenterpriseid[NVS]ESystemafe33&html.jar=true",selector:$("#CreateQueryContainer"),callback:function(){$(".pqube_header").removeClass("pqube_header")}})}}else{$("#CreateQueryContainer").hide()}}function callRemoveGPQuery(a,b){callGPQuery(a,b,"RemovePersonalizedQuery")}function callUpdateGPQuery(a,b){callGPQuery(a,b,"UpdatePersonalizedQuery")}function CallGPQGetFields(d,a){if(!a){a=window.event}var b=getSourceElement(a);BizAPP.UI.Grid._stampViewParamsOnPopup();BizAPP.UI.Grid.initAddnFieldsPopup("","",$(b).closest("[bizapp_eid]").attr("bizapp_eid"),d)}function showAddnFields(a,d,b){var e=$(getElementByBizAPPId(a,"div"));e.show();e.css("top",d+"px");e.css("left",(parseInt(b)-e.width())+"px")}function callAddPQuery(){var e=$("#PersonalizedQueryContainer").find("#tbQueryName");if(e){contextHashCode=e.closest("div[chc]").attr("chc");if(contextHashCode&&e[0].value!=""){var d=new Array();d[0]="AddPersonalizedQuery";d[1]=contextHashCode;d[2]=e[0].value;var a=$("#PersonalizedQueryContainer").find(".formcheckbox");d[3]=(a&&a.length>0&&a[0].checked).toString();var b=$("input[name=type]:checked").val()=="create";d[4]=b.toString();if(b){d[5]=BizAPP.UI.Query._editor.getValue()}ajaxAsyncCall("OptGridEx",d,true,true)}}}function callGPQuery(f,b,a){if(!b){b=window.event}var e=getSourceElement(b);var d="";if(a=="RemovePersonalizedQuery"||a=="UpdatePersonalizedQuery"){d=$(e).closest("tr").find('select[onchange*="callApplySelectedQuery"]').val();if(d){ajaxAsyncCall("OptGridEx",[a,f,d],true,true)}}}function grdLastPage(b){var a=getElementByBizAPPId(b,"select",false);if(a){a.selectedIndex=a.options.length-1}}function cancelBubble(a){if(a){a.cancelBubble=true}return false}function grdClick(d,b,h,f,e){if(d==null){d=window.event}cancelBubble(d);var m,n,a=getSourceElement(d);if(a){if(isIE()){if(a.onclick&&a.onclick.length!=0){return}}else{if(a.onclick&&a.onclick.length!=1){return}}if(a.getAttribute("type")=="radio"||a.getAttribute("type")=="checkbox"){return}var o=a.parentNode;if(o.tagName!="TR"&&o.tagName!="tr"){o=o.parentNode}m=getAttributeValue(o,"roid");n=getAttributeValue(o,"class")}CloseAllPopups();if(m!=""&&m!=null&&m!="[NEWOBJECT]"){if(a.className=="gEdit"){var t=getAttributeValue(b.offsetParent.offsetParent.offsetParent.offsetParent,"bizappid");if(t){g_editableGrids.Add(t,t)}callgEdit(a)}else{if(a.className=="gCancel"){callgCancel(a,true)}else{if(a.className=="gCommit gCommitRow"){return}else{if(e&&e.toString().toLocaleLowerCase()=="true"){if(f!=""&&f!="[SEP]Inline"){handleExpandView(d,m,f,true)}else{if(commitEditableGrids()!=true){return}var p=$(a).closest(".grid").find("[onclick*=exeSqSearchCallBack]");if(p.length>0){$(a).closest("tr").find("input").prop("checked","true");p.click()}else{var q="";var k=new Array();k.push("roid[VPNVS]"+m);$(o).find("td").each(function(){var v=$(this);var u=v.closest("table").find("th").eq(v.index()).text().trim();if(u){k.push(u+"[VPNVS]"+v.text().trim())}});if(k.length){q=k.join("[VPPMS]")}ajaxAsyncCall("OptGridEx",["GridHandler",h,m,n,q],true,true)}}}}}}}else{if(m=="[NEWOBJECT]"&&a.className=="gCancel"){b.deleteRow(o.rowIndex)}}}function handleExpandView(f,e,b,d){var a=b.split("[SEP]")[0];var h=b.split("[SEP]")[1];if(h=="Popup"){callExpandViewPopup(f,e,a,true)}else{callInlineExpandView(f,e,a)}}function callInlineExpandView(d,o,f){var a=getSourceElement(d);var m=a.parentNode.parentNode.parentNode;var k=getFirstElementByAttributeValue(m,"TR","expand",true);if(k){m.removeChild(k)}var p=a.parentNode.parentNode;var q=p.nextSibling;var t=p.nextSibling;if(t&&t.getAttribute("expand")){$(t).remove()}else{var u=document.createElement("TR");var h=document.createElement("TD");var e=document.createElement("TD");u.setAttribute("expand",true);u.appendChild(h);u.appendChild(e);var b=document.createElement("DIV");b.appendChild(document.createTextNode("Expanding ..."));e.appendChild(b);e.colSpan=p.cells.length;if(q){m.insertBefore(u,q)}else{m.appendChild(u)}var n="Ctrl"+Math.floor(Math.random()*1000);b.setAttribute(appbuliderid,n);callNavigateToViewByRuntimeViewRuntimeObjectShowCaption(n,f,o,"false")}}function callGridExecuteProcess(b,a){ajaxSyncCall("OptGridEx",["ExecuteProcess",b,a])}function getSourceElement(a){if(!a){return null}if(a.srcElement){return a.srcElement}else{if(a.target){return a.target}}}function getAttributeValue(a,b){var d=a.getAttribute(b);try{if(!d||d==""){d=a.attributes[b].value}}catch(e){}return d}function getBizAppElementsByClassName(b,h,a){var f=(h=="*"&&b.all)?b.all:b.getElementsByTagName(h);var m=new Array();a=a.replace(/\-/g,"\\-");var k=new RegExp("(^|\\s)"+a+"(\\s|$)");var e;for(var d=0;d<f.length;d++){e=f[d];if(k.test(e.className)){m.push(e)}}return(m)}function getBizAppElementByIdInParent(e,f){if(!parent){return null}var d=e.childNodes;for(var b=0;b<d.length;b++){oElement=d[b];if(oElement.id==f){return oElement}}for(var b=0;b<d.length;b++){oElement=d[b];var a=getBizAppElementByIdInParent(oElement,f);if(a){return a}}}function getElementsByAttributeValue(a,f,d,k){var e=(f=="*"&&a.all)?a.all:a.getElementsByTagName(f);var h=new Array();for(var b=0;b<e.length;b++){oElement=e[b];if(getAttributeValue(oElement,d)==k){h.push(oElement)}}return(h)}function getFirstElementByAttributeValue(b,e,d,f){var a=getElementsByAttributeValue(b,e,d,f);if(a.length>0){return a[0]}return null}function getElementInnerText(a){var b;if(a){if(a.innerText){b=a.innerText}else{if(a.textContent){b=a.textContent}}}return b}function callgEdit(a){a.className="gCancel";a.title="Cancel";$(a).next().css("display","inline-block");var o=$(a).closest("tr"),m=o.closest("table"),n=o.children("td").get(),d=m.find(".bza_vdg_header").children("th").get(),h=m.attr("ecols");rowOverrides=o.attr("ecols"),rowOverrideindexes="";if(rowOverrides){rowOverrides=rowOverrides.split(":");if(rowOverrides.length>0){$.each(d,function(k){var p=getElementInnerText(this);$.each(rowOverrides,function(q){if(p==rowOverrides[q]){rowOverrideindexes+=k+":";return false}})})}}h=h.split("[IECPS]");rowOverrideindexes=rowOverrideindexes.split(":");if(rowOverrideindexes&&rowOverrideindexes.length>0){for(i=0;i<rowOverrideindexes.length;i++){for(j=0;j<h.length;j++){if(rowOverrideindexes[i]==h[j].split(":")[0]){h[j]=""}}}}var f=new Array();for(var e=0;e<=h.length;e++){var b=h[e];if(b){f.push(b)}}replaceWithEditors1(f,n,false)}function replaceWithEditors(a,d,e){var h=a.split("[IECPS]");var f=new Array();for(var b=0;b<=h.length;b++){var m=h[b];if(m){f.push(m)}}replaceWithEditors1(f,d,e)}function replaceWithEditors1(a,w,o){var f=a.length,q=$(w[0]).parent()[0].rowIndex;for(var n=0;n<f;n++){var v=a[n].split(":");var p=parseInt(v[0]);if(a[n]!=""&&p!=NaN){var t=w[p];var u=html="";if(o==true){u=v[3]}else{u=getElementInnerText(t);if(u!=undefined){u=u.trim()}}html=t.innerHTML.replace(/</g,"{ST}");html=html.replace(/>/g,"{ET}");html=html.replace(/\"/g,"{QT}");var e="";if(n==f-1&&o==false){var d=$(t).closest(".grid").find(".gCommit")[0].onclick.toString().split("'");e="onkeydown=\"if(event.keyCode == '9'){callCommitRow('"+d[1]+"',this,'"+d[3]+"', event);}\""}if(v[2]&&v[2]!=""){e+=' class="'+v[2]+'"'}else{if(typeof(BizAPP.Bootstrap)=="undefined"){e+=' style="width:90%"'}}var b=new Date().getTime().toString()+q+n;switch(v[1]){case"ComboBox":var h='<select id="'+b+'" '+e+' onclick="event.cancelBubble = true;" oldval="'+html+'"/>';var z=v[3].split("[AVL]");for(var m=0;m<z.length;m++){if(z[m].trim()==html||z[m].trim()==u){h+="<option selected>"+z[m]+"</option>"}else{h+="<option>"+z[m]+"</option>"}}h+="</select>";t.innerHTML=h;break;case"DatetimePicker":b=$(t).parent()[0].rowIndex+p+v[0];editorHTML='<input id="'+b+'" '+e+' type="text" onclick="event.cancelBubble = true;" oldval="'+html+'" value="'+u+'"/>';if(typeof(BizAPP.Bootstrap)!="undefined"){editorHTML='<div class="input-group">'+editorHTML+'<span class="input-group-addon">                                            <span class="glyphicon glyphicon-calendar"></span>                                        </span></div>'}t.innerHTML=editorHTML;BizAPP.UI.DateTime.Init(b,"","ShowTimePicker");break;case"Multiline":t.innerHTML='<textarea id="'+b+'" '+e+' type="'+v[1]+'" onclick="event.cancelBubble = true;" oldval="'+html+'"></textarea>';$("#"+b).val(u);break;case"CheckBox":if(u=="true"||u=="True"||u=="1"){t.innerHTML='<input id="'+b+'" '+e+' type="'+v[1]+'" onclick="event.cancelBubble = true;" oldval="'+html+'" checked/>'}else{t.innerHTML='<input id="'+b+'" '+e+' type="'+v[1]+'" onclick="event.cancelBubble = true;" oldval="'+html+'"/>'}break;default:if(n==0){t.innerHTML='<input id="'+b+'" '+e+' type="'+v[1]+"\"id='focusfirstitem' bizappid='focusfirstitem' onclick=\"event.cancelBubble = true;\" oldval=\""+html+'"/>'}else{t.innerHTML='<input id="'+b+'" '+e+' type="'+v[1]+'" onclick="event.cancelBubble = true;" oldval="'+html+'"/>'}$("#"+b).val(u);if(v[4]){$("#"+b).attr("bza_fields",v[5]).attr("bza_basefield",v[4]).attr("bizapp_context",$("#"+b).closest("tr").attr("roid"));BizAPP.UI.Textbox.EnhanceAutoComplete({selector:"#"+b,userStatus:"false",selectCallback:function(A,k){$(A.target).attr("bza_ieval",k.item.identifier)}})}break}if(typeof(BizAPP.Bootstrap)!="undefined"){$("#"+b).addClass("form-control")}$("#"+b).attr("oldtext",u)}}setFocus("focusfirstitem")}function callDTP(a,b){BizAPP.UI.DateTime.Init(b)}function callgCancel(a,f){a.className="gEdit";a.title="Modify";$(a).next().hide();var o=a.parentNode.parentNode.getElementsByTagName("td");var m=a.parentNode.offsetParent.getAttribute("ecols");var b=m.split("[IECPS]");for(var e=0;e<b.length;e++){try{var n=b[e].split(":");if(b[e]!=""&&parseInt(n[0])!=NaN){if(f&&f!=false){var k=$(o[parseInt(n[0])]).find("[oldval]").attr("oldval")}else{var d=$(o[parseInt(n[0])]).find("[oldval]")[0];switch(d.type.toLowerCase()){case"checkbox":k=d.checked==true?"1":"0";break;case"select-one":case"combobox":k=d.options[d.selectedIndex].text;break;default:k=d.value;break}}k=k.replace(/{ST}/g,"<");k=k.replace(/{ET}/g,">");k=k.replace(/{QT}/g,'"');o[parseInt(n[0])].innerHTML=k}}catch(h){logError("grid cancel failed - ",h)}}}function editGrid(e){var a=getElementByBizAPPId(e,"DIV");if(a){var d=getBizAppElementsByClassName(a,"DIV","gEdit");while(d&&d.length>0){var b=d.pop();if(b&&b.onclick){try{if(b.click){b.click()}else{if(b.onclick){b.onclick()}}}catch(f){}break}}}}function callEdit(f,h){if(f.className=="gEdit"){f.className="gCancel";f.title="Cancel";var e=getElementByBizAPPId(h,"div"),d=$(e).find("table.gridcontrol div.gEdit"),a=getAttributeValue(e,"bizappid")||h;if(a){g_editableGrids.Add(a,a)}for(var b=0;b<d.length;b++){callgEdit(d[b])}}else{if(f.className=="gCancel"){f.className="gEdit";f.title="Modify";var e=getElementByBizAPPId(h,"div");var d=$(e).find("div.gCancel");for(var b=0;b<d.length;b++){callgCancel(d[b],true)}deleteNewRows(e)}}}function deleteNewRows(d){var b=getElementsByAttributeValue(d,"tr","roid","[NEWOBJECT]");if(d.nodeName.toLowerCase()!="table"){var a=getBizAppElementsByClassName(d,"TABLE","gridcontrol")[0]}else{a=d}while(b.length>0){var e=b.pop();a.deleteRow(e.rowIndex)}}function callCommit(e,a,d,b){callCommitRefresh(e,a,d,true,b)}function callCommitRow(d,a,k,b){if(a){var e=false;var p=new Array();p.push(a.parentNode.parentNode);var n=getChangedValues(p);if(n!=""){e=true}if(e==true){var m=new Array();m[0]="Commit";m[1]=d;m[2]=k;m[3]=n;m[4]="false";var h=ajaxSyncCallAndNoResponseHandler("OptGridEx",m);if(h.value[3]==""){var f=getBizAppElementsByClassName(p[0],"div","gCancel");callgCancel(f[0],false);if(p[0].nextSibling){var o=p[0].nextSibling.getElementsByTagName("input")[0];if(o){o.focus()}else{if(o=p[0].nextSibling.getElementsByTagName("select")[0]){if(o){o.select()}}}b.preventDefault();b.stopPropagation()}}}}}function callCommitRefresh(h,b,m,p,e){var q=getElementByBizAPPId(m,"div");var n;if(e){n=new Array();n.push(h)}else{n=getBizAppElementsByClassName(q,"div","gCancel")}for(var k=0;k<n.length;k++){n[k]=n[k].parentNode.parentNode}var d=false;var u=n.length;if(u>0){var t=getChangedValues(n);if(t!=""){d=true}else{return true}}if(d==true){var o=["Commit",b,m,t,"true"],a="OptGridEx";if(p==true){ajaxAsyncCall(a,o,false,true)}else{var f=ajaxSyncCall(a,o);if(f.value[3]==""){return true}}}}function getChangedValues(q){var t="",v="",u,a;for(var m=0;m<q.length;m++){var z=q[m],o=z.getAttribute("roid");if(o!=null){v+=o+"[OS]";var w=z.childNodes;if(!u){u=z.parentNode.parentNode.getAttribute("ecols");a=u.split("[IECPS]")}for(var k=0;k<a.length;k++){var h=a[k].split(":");var b=parseInt(h[0]);if(!isNaN(b)){try{var p,d;switch(h[1]){case"ComboBox":var e=w[b].childNodes[0];p=e.options[e.selectedIndex].text;d=getAttributeValue(e,"oldtext");break;case"CheckBox":var e=w[b].childNodes[0];p=e.checked.toString().toLowerCase();d=getAttributeValue(e,"oldtext").toLowerCase();break;case"DatetimePicker":case"TextBox":var f=$(w[b]).find("input");p=f.attr("bza_ieval")||f.val();d=f.attr("oldtext");break;default:p=w[b].childNodes[0].value;d=w[b].childNodes[0].getAttribute("oldtext");break}if(p!=d){v+=b.toString()+"[VS]"+p+"[PS]"}}catch(n){logError(n.message)}}}if(v!=(z.getAttribute("roid")+"[OS]")){v+="[ORS]";t+=v}v=""}}return t}function callCreate(d,f){var e=getElementByBizAPPId(f,"div");var b=getBizAppElementsByClassName(e,"table","gridcontrol");if(b.length==1){b=b[0];insertRow(b);var a=getAttributeValue(b.offsetParent.offsetParent.offsetParent.offsetParent,"bizappid");if(a){g_editableGrids.Add(a,a)}}}function insertRow(d){var o=d.insertRow(d.rows.length);o.setAttribute("roid","[NEWOBJECT]");var b=d.getAttribute("ecols");var k=d.rows[0].cells.length;try{var m=getBizAppElementsByClassName(d.rows[o.rowIndex-1],"DIV","gEdit");var h=m[0];if(!h){h=getBizAppElementsByClassName(d.rows[o.rowIndex-1],"DIV","gCancel")[0]}if(h){h=h.parentNode;h=h.cellIndex}else{h=0}}catch(f){}for(var e=0;e<k;e++){var n=o.insertCell(e);if(e==h){n.innerHTML='<div title="Cancel" class="gCancel">&nbsp;</div>'}else{n.innerHTML=""}}replaceWithEditors(b,o.cells,true)}function callCreateOnTab(e,d,h){if(e.keyCode==9){var f=getSourceElement(e);if(f.tagName.toLowerCase()=="input"||f.tagName.toLowerCase()=="textarea"){var a=f.parentNode;if(a.cellIndex==d.rows[0].cells.length-1){var k=a.parentNode;if(k.rowIndex==d.rows.length-1){if(isIE()){var b=getBizAppElementsByClassName(getElementByBizAPPId(h),"DIV","gCommit")[0].onclick.toString().split("'")[1]}else{b=getBizAppElementsByClassName(getElementByBizAPPId(h),"DIV","gCommit")[0].onclick.toString().split(",")[1];b=b.split('"')[1]}if(b&&callCommitRefresh(null,b,h,false)==true){d=getBizAppElementsByClassName(getElementByBizAPPId(h),"TABLE","gridcontrol")[0];insertRow(d)}}}}}}var g_gridStoreName="bizapp_ui_grid";function saveSelectionOnSearchGrid(a){var b=getGridSelectedValues(a);if(!b){return}var d=getPersistedValue(g_gridStoreName,a);if(d){d=d.concat(",")}else{d=""}persistValue(g_gridStoreName,a,d.concat(b));$('<span class="bza-sg-ammsg">Selected items have been added, you can continue to add more.</span>').insertBefore(".searchsteps");setTimeout(function(){$(".bza-sg-ammsg").remove()},3000)}function resetSelectionOnSearchGrid(a){removePersistedValue(g_gridStoreName,a)}function callAssociate(a,e,b,k,n,p,h,o){setForceFocus("forcefocus",a);var m="";var f=getElementByBizAPPId(p,"input");if(f){if(f.tagName=="input"||f.tagName=="INPUT"){m=f.checked.toString()}else{if(isIE()&&f.childNodes>0){m=f.childNodes[0].checked.toString()}else{if(f.childNodes>1){m=f.childNodes[1].checked.toString()}}}}if(m!="true"&&!k){displayMessage(BizAPP.UI.Localization.NoRecordsSelected);return}ProcessingStatus(true,true);var d=ajaxSyncCall("HelperEx",[e,b,k,n,m,h,o]);if($(".tinner #tabs").length>0){$(".tinner #tabs").tabs({active:1})}}function callAssociateAdvancedGrid(f,h,e,d){setForceFocus("forcefocus",f);var a=getAdvancedGridCheckBoxSelection();if(a!=null){var b=ajaxSyncCall("HelperEx",[h,e,a,d]);responseHandler(b)}}function callAssociateOperation(a,d,b,h,m,k,f,o){if(h!=null){var e=getElementByBizAPPId(o,"SPAN");var n="false";if(e&&e.childNodes>0){n=e.childNodes[0].checked.toString()}else{e=getElementByBizAPPId(o,"INPUT");if(e&&e.checked!=null){n=e.checked.toString()}}ajaxAsyncCall("HelperEx",[d,b,h,m,k,f,n],true)}}function callAssociateAdvancedGridOperation(f,h,a,b,e){var d=ajaxSyncCall("HelperEx",[f,h,getAdvancedGridCheckBoxSelection(),a,b,e]);responseHandler(d)}function callAssociateSearchOnly(b,a){closeWindow(a)}function callAssociateAdvancedGridSearchOnly(a){closeWindow(getAdvancedGridCheckBoxSelection())}function callAddObjects(b,a){var d=ajaxSyncCall("HelperEx",["AddSelectedObjects",b,a]);responseHandler(d)}function callAdvancedSearch(a,d){var b=ajaxSyncCall("SearchEx",["AdvancedSearch",serializeArgs,BizAPP.UI.getValue(d,"formcombobox")]);responseHandler(b)}function callRuntimeMethod(a){ajaxSyncCall("HelperEx",["CallRuntimeMethod",a])}function callPostRuntimeMethod(a){ajaxSyncCall("HelperEx",["CallPostRuntimeMethod",a])}function callHelper(b,a){ajaxAsyncCall("HelperEx",[b,a],true)}function getPendingStatusArgs(a){return["PendingActionStatus","PendingActionStatus"]}function callWizard(b){var a=getElementByBizAPPId(b);if(a!=null){a.click()}}function initializeStartUp(){}function getElementByAttribute(d,b){var e=getAllElements();if(b!=null){for(var a=0;a<e.length;a++){var f=e[a];if(f.getAttribute(d)==b){return f}}}else{for(var a=0;a<e.length;a++){var f=e[a];if(f.tagName&&f.getAttribute(d)!=null){return f}}}}function getAllElementsForMozilla(d,b){for(var a=0;a<b.childNodes.length;a++){d.push(b.childNodes[a])}for(a=0;a<b.childNodes.length;a++){getAllElementsForMozilla(d,b.childNodes[a])}}function getAllElements(){if(isIE()){return document.all}else{var a=new Array();getAllElementsForMozilla(a,document.documentElement);return a}}function replaceControls(result){if(result!=null){res=result.value;var resIndex=0;if(res!=null){debug("replaceControls( "+res+" )","info");var responses=new Array();responses=res.split("[START_OF_RESPONSE]");for(j=1;j<responses.length;j++){var response=responses[j].split("[END_OF_RESPONSE]")[0];var divIDValues=new Array();divIDValues=response.split("[DS]");var divIDValue=new Array();for(i=0;i<divIDValues.length;i++){divIDValue=divIDValues[i].split("[IDS]");var replaceMode=divIDValue[0];var oObject=getElementByBizAPPId(divIDValue[1],getClientTagName(divIDValue[3]));debug(divIDValue[2]);if(oObject!=null){var replaceStr="oObject."+divIDValue[0]+" = divIDValue[2]";var obj=document.createElement(divIDValue[2]);eval(replaceStr)}}}if(res!=null){var events=new Array();events=res.split("[START_OF_EVENT]");for(i=1;i<events.length;i++){var eves=events[i].split("[END_OF_EVENT]")[0];var evesList=new Array();evesList=eves.split("[ES]");for(j=0;j<evesList.length;j++){var eve=evesList[j];handleEvent(eve)}}}if(res!=null){var exceptions=new Array();exceptions=res.split("[START_OF_EXCEPTION]");for(i=1;i<exceptions.length;i++){var exception=exceptions[i].split("[END_OF_EXCEPTION]")[0]}}}}else{debug("null result")}}function getClientTagName(a){switch(a){case"TEXTAREA":return"TEXTAREA";case"Label":case"TextBox":case"CheckBox":case"Radio":case"INPUT":return"INPUT";case"ComboBox":case"SELECT":return"SELECT";case"SPAN":return"SPAN";case"TR":return"TR";case"TABLE":return"TABLE";default:return"DIV"}}function backGroundBlocker(a){var b=getElementByBizAPPId("backgroundmasker","div");if(b!=null){if(a=="true"||a=="True"){b.style.position="absolute";b.style.top=0+"px";b.style.left=0+"px";b.style.width=window.screen.availWidth+"px";b.style.height=window.screen.availHeight+"px";b.style.display="block"}else{b.style.display="none"}}}function responseHandler(f){addLog("*** Response Handler Begin. ***");ProcessingStatus(false,true);var n=getElementByBizAPPId("backgroundmasker","div");if(n!=null){n.style.display="none"}if(f!=null&&f.value!=null){var b=(new Date()).getTime();var h=f.value[0];var m=f.value[1];var o=f.value[2];var d=f.value[3];var p=f.value[4];var e=f.value[5];var q=f.value[6];var k=f.value[7];var a=true;if(m&&m.split("IDS").length>1){addLog("Response received for : "+e+", Replacing "+m.split("[IDS]")[1])}else{addLog("Response received for : "+e)}if(!requestCancelled(e)){if(q){displayStatus(h)}replaceHTML(m,a,function(){displayExceptions(d,p);fireEvents(o);BizAPP.UI.InlinePopup._setTINYPosition(true);if(p){displayDebugs(p)}BizAPP.UI.successHandler(m)})}}IncrementRequestCount(-1);processResponseTime(b,k,q,f);addLog("*** Response Handler End("+e+"). ***")}function processResponseTime(a,k,t,d){return;if(t&&(getActiveRequests()<=0||g_ajaxRequests<=0)){var b=getTotalRequestTime("__TR__");var o=(new Date()).getTime();var m=o-a;var q=getTotalRequestTime("__TR1__");var h=(parseInt(k)-getSessionValue("__TR1__"))/1000;var n=(a-(parseInt(k)+parseInt(t)))/1000;var f=n+h;var e;var p=0;if(d.value[1]!=null){p=Math.floor(d.json.length/1024)}if(p>1){e=("Network Time: "+f.toString().substring(0,5)+" s, Server Response Time: "+(t/1000).toString().substring(0,5)+" s, Browser Response Time : "+(m/1000).toString().substring(0,5)+" s, Bytes Received: "+p+" KB")}else{e=("Network Time: "+f.toString().substring(0,5)+" s, Server Response Time: "+(t/1000).toString().substring(0,5)+" s, Browser Response Time : "+(m/1000).toString().substring(0,5)+" s, Bytes Received:"+d.json.length+" B")}addLog("\n"+e);displayStatus(e,true)}}function displayStatus(d,b){if(!d){return}window.status=d;if(b){var a=$("#displayStatus");if(a.length==0){$("body").append('<div id="displayStatus" style="position:fixed;bottom:0;left:250px;background-color:#D8DFEA;height:9px;padding:5px 10px;"><span style="padding: 0 5px;cursor:pointer" onclick="$(this).next().toggle().text(); $(this).text($(this).text() == \'<\' ? \'>\' : \'<\');">&lt;</span><span class="stat_txt" style="display: inline;">'+d+"</span></div>")}else{a.find(".stat_txt").append("\n"+d)}}}function callShowStatus(){var a=getElementByBizAPPId("_StatusDetails");if(a!=null){a.style.display="block"}}function replaceControl(divIDValue,oObject,callback){if(oObject!=null){BizAPP.UI.TransformUI($(divIDValue[2]),function($html){var transformedHtml="";$html.each(function(i,v){if(v&&v.outerHTML){transformedHtml+=v.outerHTML}});divIDValue[2]=transformedHtml;BizAPP.UI.PreResponseHandler(divIDValue[1]);var replaceStr=null;var subStr="";var className=getClassName(oObject);switch(className){case"formcombocolorbox":replaceComboBox(divIDValue,oObject);break;case"formdelete":case"formcreatenewbutton":if(isIE()){replaceStr=replaceDefaultString(divIDValue[0]);eval(replaceStr)}else{replaceImage(divIDValue[2],oObject)}break;default:if(divIDValue[0]=="outerHTML"){if(oObject.parentElement!=null&&oObject.parentElement.getAttribute("styletype")=="DUMMY"){oObject=oObject.parentElement}if(isIE6()){divIDValue[2]='<div styletype="DUMMY" style="height:1px;width:100%;valign:top;">'+divIDValue[2]+"</div>"}replaceOuterHTML(oObject,divIDValue)}else{if(!isIE()){oObject.style.display="block";if(className!="RichTextEx"&&className!="formrichtext"){oObject.style.top=oObject.style.left="0px"}}try{oObject.innerHTML=divIDValue[2]}catch(Err){$(oObject).html(divIDValue[2])}}break}BizAPP.UI.TabControl.ResponsiveInit();if(callback){callback()}})}else{if(callback){callback()}}}function replaceOuterHTML(a,b){if(a.outerHTML){a.outerHTML=b[2]}else{if(isChrome()){chromeOuterHTML(a,b[2])}else{$(a).replaceWith(b[2])}}}function chromeOuterHTML(f,h){var a=f.parentNode;if(!a){return}try{var e=document.createElement("div");e.innerHTML=h;var b=document.createRange();b.selectNodeContents(e);var d=b.extractContents();a.insertBefore(d,f);a.removeChild(f)}catch(k){a.replaceChild(e.children[0],f)}}function replaceDefaultString(a){var b="oObject."+a+" = divIDValue[2]";return b}function removeTagNode(a,e){var d=new Array();var h=new Array();var f="";d=a.split("</"+e+">");h=d[0].split('">');if(h.length>2){for(var b=1;b<h.length-1;b++){f=f+h[b]+'">'}f=f+h[b]}else{f=h[1]}return f}function setBehaviour(a,b){if(b=="True"){a.disabled=false}else{a.disabled=true}}function setCheckBoxBehaviour(a,b){if(!isIE6()){setBehaviour(a,b)}else{if(b=="True"){a.disabled=false;if(a.childNodes.length==2){a.childNodes[0].disabled=false;a.childNodes[1].disabled=false}else{a.parentNode.disabled=false}}else{a.disabled=true;if(a.childNodes.length==2){a.childNodes[0].disabled=true;a.childNodes[1].disabled=true}else{a.parentNode.disabled=true}}}}function replaceImage(b,d){var a=b.split('src="')[1];if(a){a=a.split('"')[0]}d.src=a;a=b.split('class="')[1];if(a){a=a.split('"')[0]}setControlAttribute(d,"class",a);a=b.split('onclick="')[1];if(a){a=a.split('"')[0]}setControlAttribute(d,"onclick",a)}function setControlAttribute(e,b,d){if(e.attributes[b]){if(d){e.attributes[b].value=d}else{e.attributes.removeNamedItem(b)}}else{var a=document.createAttribute(b);a.value=d;e.attributes.setNamedItem(a)}}function replaceComboBox(b,f){for(i=f.options.length;i>=0;i--){f.remove(i)}var h=b[2].split("[_IS]");setBehaviour(f,h[0]);for(i=1;i<h.length;i++){var n=h[i];var a=n.split("[_TVS]");var m=a[0];var k=a[1];var d=a[2];var o=document.createElement("OPTION");o.text=m;o.value=k;if(f.className=="formcombocolorbox"){try{o.style.backgroundColor=k}catch(e){}}if(d=="True"){o.selected=true}if(isIE()){f.add(o)}else{f.options.add(o)}}}function replaceHTML(m,a,q){if(m!=null&&m!="null"&&m!=""){var b=(new Date()).getTime();var e="";try{if(document.activeElement){e=$(document.activeElement).closest("[bizappid]").attr("bizappid")}}catch(k){}m=addWindowEvent(m);var p=new Array();p=m.split("[DS]");var h=new Array();var o=null;var n=0;internalReplaceHTML(n,p,a,q);try{if(e!=null&&e.length>0){var d=$(getElementByBizAPPId(e));if(!d.is(":focus")){d.focus();d.select()}}}catch(f){}}else{if(q){q()}}}function internalReplaceHTML(index,divIDValues,retry,callback){var callback1;if((index+1)<divIDValues.length){callback1=function(){internalReplaceHTML(index+1,divIDValues,retry,callback)}}else{callback1=callback}divIDValue=divIDValues[index].split("[IDS]");var oObject=getElementByBizAPPId(divIDValue[1],getClientTagName(divIDValue[3]));var replaceMode=divIDValue[0];if(!oObject){logError("control replace failed : "+divIDValue[1]);if(retry==true||retry=="true"){try{if(window.parent!=window){try{window.parent.replaceHTML(html,retry,callback)}catch(Error){replaceItems[replaceIndex]=divIDValue[2];setTimeout("replaceValueMode( '"+replaceMode+"', "+oObject+", 'replaceItems["+replaceIndex+"]', "+callback1+" )",100);replaceIndex++;if(replaceIndex>5){replaceIndex=1}}}}catch(Error){}}else{}}if(!oObject&&divIDValue.length==5){var parent=getElementByBizAPPId(divIDValue[4],getClientTagName("DIV"));if(parent!=null){var object=document.createElement(getClientTagName(divIDValue[3]));eval("object."+divIDValue[0]+"= divIDValue[2];");parent.appendChild(object)}}replaceValueMode(replaceMode,oObject,divIDValue,callback1)}var replaceItems=new Array();var replaceIndex=1;function replaceValueMode(a,d,e,f){switch(a){case"create":if(d==null){d=document.createElement("DIV");document.appendChild(d)}e[0]="outerHTML";case"innerHTML":case"outerHTML":replaceControl(e,d,f);break;case"replaceHTML":var b=null;d.outerHTML=e[2];break}}function updateControl(b,a){updateControl(b,a,"")}function updateControl(f,a,e){var d;var b=f.controltype;debug("updateControl ( "+b+" ) ","info");var h=new Array();h[1]=f.context;if(getSessionValue("viewcontrol")){h[2]=getSessionValue("viewcontrol");setSessionValue("viewcontrol","")}else{h[2]=f.context}h[3]=a;if(f.view){h[4]=f.view}h[5]=bza_getSize(f.context);h[6]=activeRecordArgs;switch(b){case"ViewBusinessObjectForm":case"BizAPPForm":h[0]="GetRenderedOutlineControl";callOutline(h);break;case"BizAPPGrid":h[0]="GetRenderedGrid";callGrid(h);break;case"ViewTreeControl":h[0]="GetRenderedTree";callTree(h);break;case"ViewCollectionControl":h[0]="GetRenderedViewCollection";callViewCollection(h);break;case"RecentViewControl":h[0]="GetRenderedViewCollection";callRecentViewCollection(h);break;case"ViewControl":h[0]="RenderView";callView(h);break;case"RestoreControl":h[0]="MinimizeControl";callMinimizeControl(h);break;case"ScreenControl":h[0]="ChangeFavourites";h[3]=e;callScreenControl(h);break;case"SchedulerControl":h[0]="RenderSchedulerControl";ajaxAsyncCall("HelperEx",h,false,true);break;default:debug("undefined type "+f.controltype,"info")}}function renderTargetControl(f,h,b,a,d){var e=new Array();e[0]=f;e[1]=h;e[2]=b;e[3]=d;e[4]=a;e[5]="null,null";ajaxAsyncCall("HelperEx",e,false,true)}function showWindow(a){window.open(a)}function showView(b,d){var a=b+"&"+d+"="+getSessionValue(d);window.open(a)}function displayMessage(a,b){if(b){BizAPP.UI.InlinePopup.CreateNew({html:a})}else{alert(a)}}function closePopupWindowAndNavigate(a){var b=BizAPP.UI.InlinePopup.getActivePopup(false);if(!b){closeWindow(a)}else{zoomout();handleEvent(a)}}function closePopupWindow(a,b){if(a==true||a=="true"||a=="True"){if(location.href!=window.top.location.href){if(b){window.parent.returnValue=a;window.top.close()}else{window.returnValue=a;window.close()}}else{window.top.zoomout()}}}function closeWindow(){closeWindow("")}function closeWindow(a){closePopupWindow(true,false)}function closeParentWindow(a){closePopupWindow(a,true)}function openInNewWindow(b,a,e){if(a=="true"){window.close()}if(e=="true"){var d="resizable=yes,scrollbars=yes,status=yes,menubar=no,titlebar=yes,location=no";window.open(b,"_blank",d,"")}else{window.open(b)}}function openInNewWindowInFullScreen(e,a){if(!e){e=window.event}var d=window.document.documentElement.offsetWidth;if(isIE()){d=d-20}var b="height="+window.document.documentElement.offsetHeight+",width="+d+",top=0,left=0,resizable=yes,scrollbars=yes,status=no,menubar=yes,titlebar=yes,location=no,toolbar=yes";window.open(a,"",b,"")}function getPopUp(){var a=getElementByBizAPPIdFromRoot("popup","DIV");if(a==null){a=this.parent.getElementByBizAPPIdFromRoot("popup","DIV")}if(a){return a}else{debug("popup windows unavailable")}}function callEmbedControl(n,d,o,k,m,f,a,b){var e=new Array();var h=0;e[h++]="EmbedControl";e[h++]=n;e[h++]=d;e[h++]=o;e[h++]=k;e[h++]=bza_getSize(d);e[h++]=m;e[h++]=f;e[h++]=a;e[h++]=b;ajaxAsyncCall("HelperEx",e,false)}function IncrementRequestCount(b){var a=getSessionValue("__AR__");if(a==null||a==0){a=0;initiateTotalRequestTime()}a+=b;setSessionValue("__AR__",Math.max(0,a))}function getActiveRequests(){var a=getSessionValue("__AR__");return a}function initiateTotalRequestTime(){var a=new Date();setSessionValue("__TR__",a.getTime())}function getTotalRequestTime(d){var b=getSessionValue(d);var a=new Date();return(a.getTime()-b)/1000}function setHeight(b,a){if(isIE()){b.style.height=a}else{setHeightForMozilla(b,a)}}function getHeightForMozilla(b){if(b.style){var a=b.style.height;if(a&&a!="0px"){if(a.indexOf("%")==-1){return a.split("px")[0]}}}return null;if(b.style&&b.style.height){return b.style.height}return b.clientHeight}function getHeight(b){if(!isIE()){return getHeightForMozilla(b)}if(b.style){var a=b.style.height;if(a&&a!="0px"){if(a.indexOf("%")==-1){return a.split("px")[0]}}}return null}function setHeightForMozilla(b,a){if(isNaN(a)){b.style.height=a}else{b.style.height=a+"px"}}function setWidthForMozilla(b,a){if(isNaN(a)){b.style.width=a}else{b.style.width=a+"px"}}function setWidth(b,a){if(isIE()){b.style.width=a}else{setWidthForMozilla(b,a)}}function getWidthForMozilla(a){if(a.style&&a.style.width){return a.style.width}return a.clientWidth}function getWidth(b){if(!isIE()){return getWidthForMozilla(b)}if(b.style){var a=b.style.width;if(a&&a!="0px"){if(a.indexOf("%")==-1){return a.split("px")[0]}}}return null}function setWindowSize(a,b){if(window){a=parseInt(a.replace("px",""));b=parseInt(b.replace("px",""));a+=40;b+=20;if(isIE()){var e=((window.screen.availWidth/2)-(b)/2);var f=((window.screen.availHeight/2)-(a)/2);window.dialogTop=f+"px";window.dialogLeft=e+"px";a+="px";b+="px";window.dialogHeight=a;window.dialogWidth=b}else{window.resizeTo(b,a)}if(g_SLFileUpload!=undefined&&g_SLFileUpload!=""){var d=document.getElementById(g_SLFileUpload);if(d){d.style.height=document.body.clientHeight-30;d.style.width=document.body.clientWidth}g_SLFileUpload=""}}}function setSearchWindowSize(){if(window){if(isIE()){setWindowSize("450px","780px")}else{setWindowSize("480","780")}}}function setDownloadPrompPageSize(){if(window){setWindowSize("200","300")}}function setAdvancedSearchWindowSize(){if(window){if(isIE()){setWindowSize("550px","780px")}else{setWindowSize("600","780")}}}function isDialog(){return(window.external.dialogHeight!=null)}function redirectToPage(a){try{if(a.toLowerCase()=="login.aspx"&&document.URL.toLowerCase().indexOf("system/diagnostics.aspx")>-1){a="../login.aspx"}if(a.toLowerCase()=="enterpriseview.aspx"&&document.URL.toLowerCase().indexOf("system/diagnostics.aspx")>-1){a="../enterpriseview.aspx"}if(getQSParamByName("html.redirectself").toLowerCase()=="false"&&(a.indexOf("html.su=true")==-1||a.toLowerCase().indexOf("enterpriseview.aspx")!=-1)){window.top.location.href=a}else{if(window.location.hostname==window.top.location.hostname){window.top.location.href=a}else{window.location.href=a}}}catch(b){window.location.href=a}}function callGeneratePPT(){var a=new Array();a[0]="GeneratePPT";callPPTWithProcessing(a)}function callPPTWithProcessing(a){debug("PPT: calling "+a[0],"info");ajaxAsyncCall("PowerPointEx",a,false,true)}function ShowPPT(a){location.href=a}function refeshUrl(){window.parent.location.href=window.parent.location.href}function navigate(a){if(isIE()){if(event.shiftKey){window.open(a.href.replace("EnterpriseView.aspx","TestView.aspx"));return false}else{var b=a.href.search.subString(10);return false}}}function OpenDownloadPage(a){window.open(a,"","width=350,height=170,resizable=yes,scrollbars=yes,status=no,location=no,menubar=no")}function download(a){bizapp_initDwnld(a)}function bizapp_exportTable(a,b){if(!b){b="excelexport"}setSessionVariable("bizappuiexporttable",escape($(a).html()),false);return bizapp_initDwnld("download.asmx?mode="+b)}function bizapp_initDwnld(a){a+="&bza-transmit=1";a+="&html.app="+JSON.parse(BizAPP.UI.currentApplication).bizappcurrentapplicationeid;if($.fileDownload){ProcessingStatus(true,true);$.fileDownload(a,{successCallback:function(d){ProcessingStatus(false,true)},failCallback:function(d,e){ProcessingStatus(false,true);alert("failed to download file")}})}else{var b=bizapp_GCDwnldFrame();b.src="";if(a.indexOf("?")==-1){b.src=a+"?v="+new Date().getTime()}else{b.src=a+"&v="+new Date().getTime()}return b}}function handleExternalLink(a){if(isChrome()){BizAPP.UI.InlinePopup.CreateNew({iframe:a})}else{window.top.open(a)}}function manualDownload(a){window.close();download(a)}function labelout(a){a.style.textDecoration="none"}function labelover(a){a.style.textDecoration="underline"}function WebHtmlEditor_Blur(a){this.form1.submit()}function displayChartTemplate(e,m,b,h,f,k,a){if(e==null){e=window.event}var d=$(this).closest("[bizapp_name]").attr("bizapp_context");BizAPP.UI.Grid.initChartPopup(e,m,"",h,f,k,a)}function callRenderChart(a,b){callChart(["RenderChart",a,BizAPP.UI.getValue(b,"formcombobox")])}function callChart(a){ajaxAsyncCall("MSChartEx",a,false,false)}var displayMode="both";var showCalc=false;var calendarId="__Calendar_";function closeCalendar(a){if($("#chat-panel").is(":visible")){try{if(arguments.callee.caller.toString().indexOf("bza_BaseClickHandler")>0){}else{if(typeof BizAPP.Collaboration!="undefined"){BizAPP.Collaboration.toggleCtrl()}}}catch(b){BizAPP.Collaboration.toggleCtrl()}}$(".gridcontrol .bza-dropdown").removeClass("open");hideExpandViewPopup();showHideMenu();BizAPP.UI.Grid.RemoveNonAppliedFilter();BizAPP.MenuPopup.HideOrRemovePopup();$(".sort-popup").hide();if($.danidemo){$.danidemo.updateFileProgress(0,"100%")}try{if(isIE()){document.parentWindow.hideCalendar()}else{this.parent.hideCalendar()}}catch(d){}}function hideExpandViewPopup(){var a=getElementByBizAPPId("gridexpandviewpopupcontainer","div");if(a!=null&&a.style.display!="none"){a.style.display="none"}}function hideCalendar(){if(showCalc){showCalc=false}var calendar=getElementByBizAPPIdFromRoot(calendarId,"DIV");if(calendar){try{calendar.style.display="none";var eve=popEvent(this.parent);this.parent.eval(eve)}catch(Error){}}}function showCalendar(a,d){var k=getElementByBizAPPId(calendarId,"div");if(k){if(d==null){d=window.event}var b=getSourceElement(d);var m=getElementPosition(b);var f=d.clientX;var n=d.clientY;if(m){f=m[0];n=m[1]}if(document.body.scrollHeight-n<250){n=document.body.scrollHeight-250}if(document.body.clientWidth-f<213){f=document.body.clientWidth-213}k.style.left=f+"px";k.style.top=n+"px";k.style.display="block";var e=$(getSourceElement(d)).closest(".tbox");k.style.position=e&&e.length>0?e.css("position"):"absolute";var h=$("#"+calendarId).children("iframe")[0];h.src=a;h.height=213;h.width=250;h.style.display="block"}showCalc=true}function setDateValue(d,b,a){var e=getElementByBizAPPId(d,"input");if(e!=null){if(b!=null&&b!=""){e.value=b}e.focus()}if(b!=null&&b!=""){if(a){callGetDependentFields(a)}}}var content;function initialize(b){var d=document.getElementById("RichText");if(d==null){window.setTimeout("initialize( '"+b+"' )",500)}else{var a=document.getElementById("RichText_designEditor");if(a!=null){a.onblur=function(){save(b,d.value)};content=d.value}}}function save(a,b){if(content!=b){content=b;parent.callSetField(a,b)}}function executeAtRoot(a){if(this.parent){this.parent.execute(a)}}function execute(evalCall){eval(evalCall)}function fireEventsOnPageLoad(){if(document.readyState=="complete"){fireEvents()}else{setTimeOut("fireEventsOnPageLoad",500)}}function forceFireEventsOnPageLoad(){try{fireEvents()}catch(a){debug("cought Exception while firing "+a.Message)}}function callChangeExplorerView(a,b){callExplorerControl(["ChangeExplorerView",a,BizAPP.UI.getValue(b,"formcombo")])}function callExplorerControl(a){ajaxAsyncCall("ExplorerEx",a,true,true)}function lgi(a){}function showSelectedRow(d,b){if(b){var a=b.srcElement.parentElement.getAttribute("roid");var e=b.srcElement.parentElement.parentElement.parentElement.getAttribute("viewid");if(a){nvByRF(e,a,"uniqueid")}}}function getCurrentSelection(b,a){return getSessionValue(b+"_"+a)}function setCurrentSelection(d,a,b){setSessionValue(d+"_"+a,b)}function applyClassName(h,f,e,d){var k;var b=getCurrentSelection(h,e);if(b){k=getElementByBizAPPId(b,getClientTagName("TR"));if(k){k.className=k.getAttribute(e)}}else{if(d){var a=getElementByGroupId("groupid",h,getClientTagName("TR"));if(a){a.className="gridrow"}}}k=getElementByBizAPPId(f,getClientTagName("TR"));if(k){k.setAttribute(e,k.className);k.className=e;setCurrentSelection(h,e,f)}}function selectGridRow(b,a){try{applyClassName(b,a,"gridselectedrow",true)}catch(d){}}function callRefreshGrid(b,f,a,e,d,k,h){debug("RefreshGrid ( "+f+", "+a+" );","info");callGrid(["RefreshGrid",b,f,a,e,d,k,bza_getSize(h)],responseHandler)}function callRefreshGridOnFilter(b,f,a,e,d,k,h){debug("RefreshGrid ( "+f+", "+a+" );","info");callGrid(["RefreshGrid",b,f,a,e,d,k,bza_getSize(h),"filter"],responseHandler)}function callApplySelectedQuery(b,d,a){if(b){callGrid(["ApplySelectedQuery",d,"",b.value])}}function callApplySelectedQuery1(a,b){if(a){callGrid(["ApplySelectedQuery",b,"",a.getAttribute("queryenterpriseid")])}}function callGridCount(b,a){if(!b||b==undefined){b="OptGridEx"}ajaxAsyncCall(b,["GetGridRowCount",a,"-1"],true,true)}function callDisplayExportOptions(a){BizAPP.UI.Grid._stampViewParamsOnPopup();callGrid(["DisplayExportOptions",a])}function callExportGridData(d,k,a){var e=getSourceElement(d),h=$(e).closest("[mode]").attr("mode");if(a.toLowerCase()=="true"){BizAPP.UI.Grid.ExportAsJob(k,h)}else{var b="ingridpage.aspx?mode=export"+h+"&html.args="+k;var f=$(getSourceElement(window.event)).closest("[bza_viewparams]");if(f.length>0){b+="&bza_viewparams="+encodeURIComponent(f.attr("bza_viewparams"))}bizapp_initDwnld(b)}zoomout()}function bizapp_GCDwnldFrame(){var a=$("#downloadFrame");a.remove();a=null;if(!a||a.length==0){a=document.createElement("iframe");a.id="downloadFrame";a.style.display="none";document.body.appendChild(a)}return a}g_fileuploadOptions='<td style="font-size:0.85rem;display:none;" onclick="switchFileUploadMode(this,\'file\')"><i class="fa fa-upload" title="Upload"></i></td><td style="font-size:0.85rem" onclick="switchFileUploadMode(this,\'ref\')"><i class="fa fa-link" title="External Link"></i></td><td style="font-size:0.85rem"><i class="fa fa-camera" title="capture"></i></td>';g_fileuploadExternal='<td class="ref" style="display:none"><input class="formtextbox fill" placeholder="External Link"/></td><td><i class="fa fa-ellipsis-v" title="capture"></i></td>';function switchFileUploadMode(a,b){$(a).toggle();$(a).parent().children('[class*="uploader"],[class*="ref"]').toggle();if(b=="ref"){$(a).prev().toggle()}else{$(a).next().toggle()}}function loadUploadControl(d,f,a,b){var k=$('[bza-ctrlid="'+d+'"]');var e=k.attr("bizappid");if(e){k=$(getElementByBizAPPId(e,"DIV"))}var m=k.closest("[bizapp_name].ViewControlEx").attr("bizappid");var h=k.closest(".form").attr("bizapp_eid");var n={viewdef:h,controlname:d,context:f,viewname:m};if(!b){g_callBacks.push(function(){BizAPP.UI.Upload.ImgCtrlInit(d,true)})}ajaxAsyncCall("HelperEx",["LoadUploadControl",n.viewdef,n.controlname,n.context,n.viewname,a,b],true,true)}var g_blockedExtns=["exe","msi","msp","bat","dll"];function CheckFileFormat(k,b){var a=getElementByBizAPPId(k);var n=false;if(a!=null){if(!a.value){return true}var h;if($.isArray(g_blockedExtns)){h=g_blockedExtns}else{h=g_blockedExtns.split(",")}for(var d=0;d<h.length;d++){if(CheckIfAllowedFormat(a,h[d])){displayMessage("executables cannot be uploaded - "+h[d]);return false}}var m=a.getAttribute("FileFormats");if(m){m=m.split(",");if(m!=""){for(var d=0;d<m.length;d++){if(CheckIfAllowedFormat(a,m[d])){n=true;break}}}else{n=true}}else{n=true}if(!n){displayMessage("Invalid file extension. Allowed formats are "+m+".");a.parentNode.innerHTML=a.parentNode.innerHTML.replace('value="'+a.valueOf+'"',"")}else{if(b>0){n=false;var o=0;try{if(a.files){o=a.files[0].size}else{o=new ActiveXObject("Scripting.FileSystemObject").getFile(a.file.value).size}}catch(f){logError("file size check failed.",f)}if(o<=b){n=true}if(!n){if(b/1024<1024){displayMessage("The selected file exceeds the maximum allowed size of {0}Kb.".format(b/1024))}else{displayMessage("The selected file exceeds the maximum allowed size of {0}Mb.".format(b/(1024*1000)))}a.parentNode.innerHTML=a.parentNode.innerHTML.replace('value="'+a.valueOf+'"',"")}}}return n}}function CheckIfAllowedFormat(d,e){if(e!=null){var b=d.value.split(".");var a=b[b.length-1];if(e.toLowerCase()==a.toLowerCase()){return true}else{return false}}}function getCloneObjectSelection(b){var a=getElementByBizAPPId(b,"SPAN");if(a){var d=a.childNodes[0].checked;return d.toString()}return false.toString()}function checkallWithMsg(f,e,a){var d=getElementByBizAPPId(f,"input");var b=d.checked;if(b){if(confirm(""+a+" records will be selected. Do you want to continue ?")){return checkall(f,e)}else{d.checked=false}}else{if(confirm(""+a+" records will be deselected. Do you want to continue ?")){return checkall(f,e)}else{d.checked=true}}}function checkall(k,f){var e=getElementByBizAPPId(k,"input");if(e){var h=e.checked;var d=new Array();var a=0;var b=$(e).closest("table").find('input[type=checkbox][BizAPPid="'+f+'"]').each(function(){if($(this).is(":visible")){this.checked=h;d[a++]=this}});return d}}function selectUnSelectAll(d,h,k){var f=new Array();var a=0;var e="";var b=$('input[type=checkbox][id^="'+h+'_"]').each(function(){if($(this).is(":visible")){this.checked=k;e=e+"[SEP]"+$(this).attr("checkedvalue");f[a++]=this}});_setMultipleAllowedValues(d,e,!k);return f}function UpdateCheckBoxesAndDisplayMessage(f,e,a){var d=getElementByBizAPPId(f);var b=d.childNodes[0].checked;if(b){if(confirm(""+a+" records will be selected. Do you want to continue ?")){return UpdateCheckBoxes(f,e)}else{d.childNodes[0].checked=false}}else{if(confirm(""+a+" records will be deselected. Do you want to continue ?")){return UpdateCheckBoxes(f,e)}else{d.childNodes[0].checked=true}}}function UpdateCheckBoxes(m,h){var e=getElementByBizAPPId(m,"SPAN");var k=null;for(var a=0;a<e.childNodes.length;a++){if(e.childNodes[a].getAttribute("type")=="checkbox"){k=e.childNodes[a].checked}}var b=null;var d=new Array();if(isIE()){b=document.getElementsByName("BizAPP.object")}else{b=document.getElementsByTagName("input")}if(b!=null&&b.length!=null){for(a=0;a<b.length;a++){var f=b[a];if(f.getAttribute("BizAPPid")==h){if(f!=e&&f.tagName.toLowerCase()=="input"){if(f.type=="checkbox"){f.checked=k;d[a]=f}}}}}return d}function getFilter(n){var b={};var p=getElementByBizAPPId(n+"_Filter","DIV");if(p){var d=p.getAttribute("controlids");var e=d.split(",");for(var m=0;m<e.length;m++){var q=getElementByBizAPPId(e[m]+"_Filter","INPUT");if(q){b[q.getAttribute("columnname")]=q.value}}}else{var o=document.getElementsByName("BizAPP.filter");if(o!=null&&o.length>0){for(var m=0;m<o.length;m++){var k=o[m];if(k&&k.getAttribute("BizAPPid")!=null&&k.value!=""){var h=k.getAttribute("BizAPPid");var f=h.split(",")[0];var a=h.split(",")[1];if(a=="Filter_"+n){b[f]=k.value}}}}}return JSON.stringify(b)}function callAdvancedListFilter(e,b,f){if(e==null){e=window.event}window.event=e;if(e){if(e.keyCode=="13"){e.returnValue=false;if(!isIE()){e.preventDefault()}else{e.cancelBubble=true}var h=getElementByBizAPPId(f+"_RecordsPerPageList","select");var a=h?h.value:"-1";var d=getFilter(f);callRefreshGridOnFilter(b,"-1",a,d,"false","",f)}}}function bizapp_advlistQkFilter(h,k,m,f){if(k.keyCode!="13"){return}window.event=k;var e=getElementByBizAPPId(f+"_Filter");var d="";$(e).find("input").each(function(){d+=$(this).attr("columnname")+"[SEP]"});d+="[NVS]"+$(h).val();ajaxAsyncCall("AdvancedListEx",["QuickFilter",m,d])}function callGridFilter(b,a,d){if(b==null){b=window.event}if(b){if(b.keyCode=="13"){callFilter(a,d);b.returnValue=false;if(!isIE()){b.preventDefault()}else{b.cancelBubble=true}}}}function callFilter(b,d){if(commitEditableGrids()!=true){return}var e=getElementByBizAPPId(d+"_RecordsPerPageList","select");var a;if(e){a=e.value}else{a="-1"}callRefreshGridOnFilter(b,"1",a,getFilter(d),"false","",d)}function callChangePage(b,f,e,d){var a=getElementByBizAPPId(f,"DIV");if(a&&getBizAppElementsByClassName(a,"DIV","gCancel").length!=0){return}e=getElementByBizAPPId(e,"select");if(e){e=e.value}d=getElementByBizAPPId(d,"select");if(d){d=d.value}callRefreshGrid(b,e,d,getFilter(f),"false","",f)}function callRefresh(a,b){callRefreshGrid(a,"-1","-1",getFilter(b),"true","",b)}function callRefreshReload(a,b){callRefreshGrid(a,"-1","-1","","true","",b)}function callSort(d,e,m,n,b){var a=getSourceElement(d);if(a.nodeName.toLowerCase()!=="th"){a=$(a).closest(".bza-filter-block").closest("th")}if(!a){return}var f=$(a).attr("sortid");if(!f){return}if(commitEditableGrids()!=true){return}var o=getElementByBizAPPId(n);var p;if(o){p=o.value}else{p="-1"}var h=getElementByBizAPPId(b);var k;if(h){k=h.value}else{k="-1"}callRefreshGrid(e,p,k,getFilter(m),"false",f,m)}function callPage(b,a,d){if(commitEditableGrids()!=true){return}callGrid([d,b,bza_getSize(a)])}function callNextPage(a,b){callPage(a,b,"MoveNextPage")}function callPreviousPage(a,b){callPage(a,b,"MovePreviousPage")}function callLastPage(a,b){callPage(a,b,"MoveLastPage")}function callFirstPage(a,b){callPage(a,b,"MoveFirstPage")}function callGrid(a){ajaxAsyncCall("OptGridEx",a,true,true)}function OnEnterKey(){if(event.keyCode=="13"){return true}return false}function evalFilter(eventString){if(OnEnterKey()){var splitEventString=eventString.split("-");var filterString="callFilter(getSessionValue('"+splitEventString[0]+"'), getSessionValue('"+splitEventString[1]+"'),'"+splitEventString[2]+"')";eval(filterString)}}function callExpandView(b,f,m,u,q,n){if(b==null){b=window.event}if(n=="popup"&&f.className=="gExpPP"){callExpandViewPopup(b,m,q,true)}else{if(n=="popup"&&f.childNodes[0]!=null&&f.childNodes[0].childNodes[0]&&f.childNodes[0].childNodes[0].className=="gExpPP"){callExpandViewPopup(b,m,q,false)}else{if(f.className=="gExp"){f.className="gridcollapse";var h=f.parentElement.parentElement.parentElement;var o=f.parentElement.parentElement;var p=o.nextSibling;var t=o.nextSibling;if(t&&t.getAttribute("expand")){t.style.display="block"}else{var v=document.createElement("TR");var e=document.createElement("TD");var d=document.createElement("TD");v.setAttribute("expand",true);v.appendChild(e);v.appendChild(d);var a=document.createElement("DIV");a.appendChild(document.createTextNode("Expanding ..."));d.appendChild(a);d.colSpan=u-5;if(p){h.insertBefore(v,p)}else{h.appendChild(v)}var k="Ctrl"+Math.floor(Math.random()*1000);a.setAttribute(appbuliderid,k);callNavigateToViewByRuntimeViewRuntimeObjectShowCaption(k,q,m,"false")}}else{f.className="gExp";var o=f.parentElement.parentElement;var p=o.nextSibling;if(p&&p.getAttribute("expand")){p.style.display="none"}}}}}function callExpandViewPopup(d,k,o,e){var p=getElementByBizAPPId("gridexpandviewpopupcontainer","div");var n=getElementByBizAPPId("gridexpandviewpopup","div");p.style.display="block";p.style.left=d.clientX+"px";var h=getElementPosition(getSourceElement(d));var m=d.clientY;if(h){m=h[1]}if(e==true){p.style.top=m+16+"px"}else{p.style.top=m+"px"}var a=getElementByBizAPPId("Ctrl_gridexpandviewpopup","div");if(a){n.innerHTML=""}var b=document.createElement("DIV");b.appendChild(document.createTextNode("Initializing ..."));var f="Ctrl_gridexpandviewpopup";b.setAttribute(appbuliderid,f);n.appendChild(b);callNavigateToViewByRuntimeViewRuntimeObjectShowCaption(f,o,k,"false")}var cancelledRequests=new Array();function ProcessKey(a){switch(a.keyCode){case 27:if(!BizAPP.UI.InlinePopup.getActivePopup(false)){$(".bza-alrtDefaultBtn").click()}cancelCurrentRequest();break}}function requestCancelled(a){if(cancelledRequests[a]){return true}}function cancelCurrentRequest(){var a=getCurrentRequestId();cancelledRequests[a]=true}var _queryString=null;var _locator;var _enterprise;var _provider;function setLocatorValue(a){_locator=a}function setProvider(a){_provider=a}function setEnterprise(a){_enterprise=a}function setQueryString(a){_queryString=a}function getQueryString(){return _queryString}function setPassword(b,a){var d=getElementByBizAPPId(b,"INPUT");if(d){d.value=a}}function submitOnEnter(a){}function signOut(){signOutWithNoDirtyTransactionsCheck()}function signOutWithNoDirtyTransactionsCheck(){closeAllChatWindows();BizAPP.UI.OAuth.Logout(function(){ajaxAsyncCall("LogoutEx",["LogoutWithNoDirtyTranscationsCheck"],true,true)})}function signOutWithSerializedArgs(a){closeAllChatWindows();var b=$(a).closest(".ViewControlEx").eq(0);ajaxAsyncCall("LogoutEx",["Logout",b.attr("bizapp_eid"),b.attr("bizappid"),$(a).closest("[bza-ctrlid]").attr("bza-ctrlid")],true,true)}function pmtnClose(b,a){if(isIE()){window.close()}BizAPP.UI.InlinePopup.Confirm({message:b,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}window.close();redirectToPage(a)},fnCancelOnclick:function(){redirectToPage(a)}})}function setLocator(){var a=getElementByBizAPPId("Locator","select");ajaxAsyncCall("AuthenticateEx",["SetLocator",a.value],false,true)}function callShowAuthenticate(){ajaxAsyncCall("AuthenticationEx",["ShowAutheticate",_locator,_enterprise,_provider],false,true)}function showCredentials(f){var b=getElementByBizAPPId("InvalidLogin","div");b.innerHTML="";var a=getElementByBizAPPId("Locator","select").value;var e=getElementByBizAPPId("Enterprise","select").value;var d=getElementByBizAPPId("Provider","select").value;setLocatorValue(a);setProvider(d);setEnterprise(e);ajaxAsyncCall("AuthenticationEx",["ShowCredentials",a,e,d,""+f],false,true);return false}function setSLFlag(){ajaxAsyncCall("CredentialsEx",["SetSLFlag",CheckSilverlightVersion()],false,true)}function bizapp_insertNAK(f,d){if($("#paramtable nobr").text().indexOf("Network Key")==-1){var e=getElementByBizAPPId(f,"table");var b=e.rows.length-1;var h=e.insertRow(b);var a=h.insertCell(0);$(a).html(d);a=h.insertCell(1);$(a).html('<input name="{0}" type="text" id="{0}" onkeydown="submitOnEnter(event);" bizappid="{0}" style="width:100%;">'.format("parameter"+b))}}function callLogin(){var e=new Array();e[0]="Login";e[1]=_locator;e[2]=_enterprise;e[3]=_provider;e[4]=getElementByBizAPPId("rememberme").checked?"true":"false";e[5]=getElementByBizAPPId("notimeout").checked?"true":"false";e[6]="";var a=window.location.search.substring(1);a.split("?");if(a){a=a.split("html.navurl=");if(a.length>1){a=a[1].split("&")[0];e[6]=a}}e[7]="";var h=document.getElementById("MacIdHolder");if(h&&h.value!=null&&h.value!="undefined"){e[7]=h.value}e[8]=CheckSilverlightVersion();e[9]=checkIfTouchScreen().toString();e[10]=g_geoLocation;var d=11;var b=0;while(true){var f=getElementByBizAPPId("parameter"+b);if(f){e[d]=f.value;d++;b++}else{break}}if(!e[11]){displayMessage("Please enter valid user name and password.")}else{ajaxAsyncCall("CredentialsEx",e,false,true)}}function callLoginWithParams(d){var a={provider:"BizAPP",rememberUserName:true,noTimeout:false,domain:""};for(s in d){a[s]=d[s]}d=a;var b=["Login",d.registry,d.enterprise,d.provider,"false","false",d.logouturl,"",CheckSilverlightVersion(),checkIfTouchScreen().toString(),"",d.UserName,d.Password,d.domain];ajaxAsyncCall("CredentialsEx",b,false,true)}function performRegister(){location.href="../Start/RegisterUser.aspx"}function callRegisterPage(e,a,f,b){var d=e+"?html.size="+getClientWidth()+"px, "+getClientHeight()+"px&html.enterprise="+f;if(b=="true"||b=="True"||b==true){window.open(d)}else{window.parent.location.href=d}}function callForgotPasswordPage(d,a,f,b){var e=d+"?html.args="+a+"&html.size="+getClientWidth()+"px, "+getClientHeight()+"px&html.enterprise="+f;if(b=="true"||b=="True"||b==true){window.open(e)}else{window.parent.location.href=e}}function getClientHeight(){if(isIE6()){return document.documentElement.offsetHeight-37}return document.documentElement.offsetHeight-20}function getClientWidth(){if(isIE6()){return document.documentElement.offsetWidth-20}return document.documentElement.offsetWidth-2}function hideContextMenu(){var a=getElementByBizAPPId("ContextMenu","div");if(a){a.style.display="none"}}function callContextMenu(a,d){var b=new Array();b[0]="GetContextMenu";b[1]=a;b[2]=d;if(event.clientX>110){b[3]=(event.clientX-110)+", "+event.clientY}else{b[3]=event.clientX+", "+event.clientY}ajaxAsyncCall("HelperEx",b,true,true)}function hideMenu(b){var a=getElementByBizAPPId("ContextMenu","div");if(a){a.releaseCapture();a.style.display="none"}}function clickMenu(b){var a=getElementByBizAPPId("ContextMenu","div");if(a){a.releaseCapture();a.style.display="none";var d=new Array();d[0]="ApplyContextMenuStep";d[1]=b;d[2]=getParentDiv(event.srcElement).getAttribute("BizAPPid");d[3]=event.srcElement.parentElement.getAttribute("menutype");ajaxAsyncCall("HelperEx",d,true,true)}}function getParentDiv(a){if(a.tagName=="DIV"){return a}else{return getParentDiv(a.parentElement)}}function switchMenu(){el=event.srcElement;if(el.className=="menuitem"){el.className="highlightitem"}else{if(el.className=="highlightitem"){el.className="menuitem"}}}function registerForApplyStep(d,b,e,a){applyStepEvents.push(d+"( '"+b+"', '"+e+"', '"+a+"' );")}function setFieldValue(d,e,a){var b=BizAPP.UI.getValue(d,e);if(b!=null){callSetField(a,b)}}function setMultipleAllowedValues(b,a){var e=getSourceElement(a);var d="";if(e.checked){d=e.getAttribute("checkedvalue")}else{d=e.getAttribute("uncheckedvalue")}_setMultipleAllowedValues(b,d)}function callSetMultipleAllowedValues(a,e,d){var b=BizAPP.UI.getValue(d,e);_setMultipleAllowedValues(a,b)}function _setMultipleAllowedValues(b,e,a){a=a||false;var d=["SetMultipleAllowedValue",b,e,"True"];if(e.indexOf("!!")==0||a){if(!a){d[2]=e.substring(2,e.length)}d[3]="False"}callOutline(d)}function callShowRepeatPage(m,f,a,h,d,b){if(isIE()&&event){d=event.srcElement}var e=null;if(isIE()){e=getValidBizAPPGroup(d)}else{e=d}ResetTabPages(getTab(e));SelectTabPage(e);var k=new Array();k[0]="GetRepeatPage";k[1]=m;k[2]=f;k[3]=a;k[4]=h;k[5]=b;callOutlineWithProcessing(k)}function callShowNavigateToRepeatPage(f,n,k,m,h,o,e,d,b){var a=new Array();a[0]="NavigateRepeatPage";a[1]=f;a[2]=n;a[3]=k;a[4]=m;a[5]=o;a[6]=e;a[7]=d;a[8]=b;callOutlineWithProcessing(a)}function callMultiSelectDialog(d,b){var a=d+"?html.args="+b;showDialog(a,"300px","200px",true);callGetDependentFields(b)}function getValidBizAPPGroup(a){var b=getParent(a);while(b&&b.groupid==null){b=getParent(b)}return b}function getParent(a){return a.parentNode}function callShowFirstTabPage(d,e,b,a){setForceFocus("forcefocus",d);callOutlineWithProcessing(["GetFirstTabPage",e,b])}function callShowLastTabPage(d,e,b,a){setForceFocus("forcefocus",d);callOutlineWithProcessing(["GetLastTabPage",e,b])}function callShowNextTabPage(d,e,b,a){setForceFocus("forcefocus",d);callOutlineWithProcessing(["GetNextTabPage",e,b])}function callShowPreviousTabPage(d,e,b,a){setForceFocus("forcefocus",d);callOutlineWithProcessing(["GetPreviousTabPage",e,b])}function callShowTabPage(a,m,b,h,k,e){if(commitEditableGrids()!=true){return}setForceFocus("forcefocus",a);var n=getElementByBizAPPId("gridexpandviewpopupcontainer","div");if(n&&n.innerHTML.indexOf(getSourceElement(a).innerHTML)==-1){closeCalendar()}evalRegisteredEvents();k=a.srcElement;var d=null;if(isIE()){d=getValidBizAPPGroup(k)}else{d=k}if(e=="True"){var f=outlineAjaxCall(["GetTabPageEnabled",m,b,h]);if(f.value[0]!="enabled"){displayExceptions(f.value[3],f.value[4]);return}}ResetTabPages(getTab(d));SelectTabPage(d);callOutlineWithProcessing(["GetTabPage",m,b,h])}function callDisplayTab(a){callOutline(["GetRenderedTab",a])}function callDisplayForm(a,b){callOutline(["GetRenderedForm",a,b])}function callOutlineTreeRefresh(a,b){callOutline(["GetOutlineTree",a,b])}function callUploadDocument(d,b,a){var d="UploadPage.aspx?html.args="+a;window.open(d);callGetDependentFields(a)}function downloadAttachment(b){var a="DownloadPage.aspx?html.args=runtimeobjectid[NVS]"+b;window.open(a,null,"dialogWidth=10; dialogHeight=10; edge=none; status=no; unadorned=no; dialogHide=yes; scroll=yes; resizable=1; channelmode=yes; menubar=no; titlebar=no")}function callDownloadDocument(a,d,b){var a="DownloadPage.aspx?html.args="+b;window.open(a)}function callDerivedTypeDialog(e,d){var b=e+"?html.args="+d;var a=showDialog(b,"210px","367px",false);return a}function callCreateNewDialog(h,f,k,b,a,e,d){setForceFocus("forcefocus",h);f=f+"?html.args="+b+"&runtimeobjecttypeid="+d;showDialogWithOptions(f,a+"px",e+"px","yes","yes");callGetDependentFields(b,responseHandler)}function callScheduleDialog(a){if($(a.target).hasClass("formschedule")){var b='<div class="form-scheduler" style="width:450px;height:160px;><table class="fill" cellspacing="0" cellpadding="0" style="border-collapse:collapse;"><tr valign="top"><td><div id="tabs" style="display:none;"><table><tr><td><span>Period:</span></td><td><select id="cbPeriod" onchange="System.Cron.ShowActiveTab(this.value);"><option value="0">Minutes</option><option value="1">Hourly</option><option value="2">Daily</option><option value="3">Weekly</option><option value="4">Monthly</option><option value="5">Yearly</option></select></td></tr></table><div id="tabs-1"><table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="id3"><div class="tab-panel"><table><tbody><tr><td>Every<input style="width: 40px" value="1" name="tabbedPanel:panel:txtMinutes" id="idb3" type="text">minute(s)</td></tr></tbody></table></div></div></td></tr><tr><td height="40"><button class="stepcenternormal" name="btnGenerate" id="idf" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</strong></button></td></tr></tbody></table></td></tr></tbody></table></div><div id="tabs-2"><table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="Div1"><div class="tab-panel"><table><tbody><tr><td><input id="idbb" name="tabbedPanel:panel:radioGroup:Hourly" value="radio35" checked="checked" class="wicket-idba" type="radio">			</td><td>Every<input style="width: 40px" value="1" name="tabbedPanel:panel:radioGroup:txtHours" id="idbc" type="text">hour(s)</td></tr><tr><td><input id="idbd" name="tabbedPanel:panel:radioGroup:Hourly" value="radio36" class="wicket-idba" type="radio"></td><td><table cellpadding="0" cellspacing="0"><tbody><tr><td>At</td><td><span id="idbe"><table><tbody><tr><td><select name="tabbedPanel:panel:radioGroup:timeEntry:hourPart"><option value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option selected="selected" value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</select></td><td><select name="tabbedPanel:panel:radioGroup:timeEntry:minutePart"><option selected="selected" value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23<option value="24">24<option value="25">25<option value="26">26<option value="27">27<option value="28">28<option value="29">29<option value="30">30<option value="31">31			<option value="32">32<option value="33">33<option value="34">34<option value="35">35<option value="36">36<option value="37">37<option value="38">38<option value="39">39<option value="40">40<option value="41">41<option value="42">42<option value="43">43<option value="44">44<option value="45">45<option value="46">46<option value="47">47<option value="48">48<option value="49">49<option value="50">50<option value="51">51<option value="52">52<option value="53">53<option value="54">54<option value="55">55<option value="56">56<option value="57">57<option value="58">58<option value="59">59</select></td></tr></tbody></table></span></td></tr></tbody></table></td></tr></tbody></table></div></div></td></tr><tr><td height="40"><button class="stepcenternormal" name="btnGenerate" id="Button1" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</button></td></tr></tbody></table></td></tr></tbody></table></div><div id="tabs-3"><table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="Div2"><div class="tab-panel"><table><tbody><tr><td><input id="ida9" name="tabbedPanel:panel:radioGroup:Daily" value="radio33" checked="checked" class="wicket-ida8" type="radio"></td><td>Every<input style="width: 40px" value="1" name="tabbedPanel:panel:radioGroup:txtDays" id="idaa" type="text">day(s)</td></tr><tr><td><input id="idab" name="tabbedPanel:panel:radioGroup:Daily" value="radio34" class="wicket-ida8" type="radio"></td><td>Every Week Day</td>			</tr><tr><td colspan="2"><table><tbody><tr><td>Start time</td><td><span id="idac"><table><tbody><tr><td><select name="tabbedPanel:panel:radioGroup:startTime:hourPart"><option value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option selected="selected" value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</select></td><td><select name="tabbedPanel:panel:radioGroup:startTime:minutePart"><option selected="selected" value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23<option value="24">24<option value="25">25<option value="26">26<option value="27">27<option value="28">28<option value="29">29<option value="30">30<option value="31">31<option value="32">32<option value="33">33<option value="34">34<option value="35">35<option value="36">36<option value="37">37<option value="38">38<option value="39">39<option value="40">40<option value="41">41<option value="42">42<option value="43">43<option value="44">44			<option value="45">45<option value="46">46<option value="47">47<option value="48">48<option value="49">49<option value="50">50<option value="51">51<option value="52">52<option value="53">53<option value="54">54<option value="55">55<option value="56">56<option value="57">57<option value="58">58<option value="59">59</select></td></tr></tbody></table></span></td></tr></tbody></table></td></tr></tbody></table></div></div></td></tr><tr><td height="40"><button class="stepcenternormal" name="btnGenerate" id="Button3" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</button></td></tr></tbody></table></td></tr></tbody></table></div><div id="tabs-4"><table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="Div3"><div class="tab-panel"><table><tbody><tr><td><table><tbody><tr><td><input id="id5e" name="tabbedPanel:panel:daysSelected" value="check18" class="wicket-id5d" type="checkbox"></td><td>Monday</td></tr></tbody></table></td><td><table><tbody><tr><td><input id="id5f" name="tabbedPanel:panel:daysSelected" value="check19" class="wicket-id5d" type="checkbox"></td><td>Tuesday</td></tr></tbody></table></td><td><table><tbody><tr><td><input id="id60" name="tabbedPanel:panel:daysSelected" value="check20" class="wicket-id5d" type="checkbox"></td><td>Wednesday</td></tr></tbody></table></td><td><table><tbody><tr><td><input id="id61" name="tabbedPanel:panel:daysSelected" value="check21" class="wicket-id5d" type="checkbox"></td><td>Thursday</td>			</tr></tbody></table></td></tr><tr><td><table><tbody><tr><td><input id="id62" name="tabbedPanel:panel:daysSelected" value="check22" class="wicket-id5d" type="checkbox"></td><td>Friday</td></tr></tbody></table></td><td><table><tbody><tr><td><input id="id63" name="tabbedPanel:panel:daysSelected" value="check23" class="wicket-id5d" type="checkbox"></td><td>Saturday</td></tr></tbody></table></td><td><table><tbody><tr><td><input id="id64" name="tabbedPanel:panel:daysSelected" value="check24" class="wicket-id5d" type="checkbox"></td><td>Sunday</td></tr></tbody></table></td><td></td></tr><tr><td colspan="7"><table><tbody><tr><td>Start time</td><td><span id="id65"><table><tbody><tr><td><select name="tabbedPanel:panel:daysSelected:startTime:hourPart"><option value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option selected="selected" value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</select></td><td><select name="tabbedPanel:panel:daysSelected:startTime:minutePart"><option selected="selected" value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16			<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23<option value="24">24<option value="25">25<option value="26">26<option value="27">27<option value="28">28<option value="29">29<option value="30">30<option value="31">31<option value="32">32<option value="33">33<option value="34">34<option value="35">35<option value="36">36<option value="37">37<option value="38">38<option value="39">39<option value="40">40<option value="41">41<option value="42">42<option value="43">43<option value="44">44<option value="45">45<option value="46">46<option value="47">47<option value="48">48<option value="49">49<option value="50">50<option value="51">51<option value="52">52<option value="53">53<option value="54">54<option value="55">55<option value="56">56<option value="57">57<option value="58">58<option value="59">59</select></td></tr></tbody></table></span></td></tr></tbody></table></td></tr></tbody></table></div></div></td></tr><tr><td height="40"><button class="stepcenternormal" name="btnGenerate" id="Button5" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</button></td></tr></tbody></table></td></tr></tbody></table></div><div id="tabs-5"><table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="Div4"><div class="tab-panel"><table><tbody><tr><td><input id="id40" name="tabbedPanel:panel:radioGroup:Monthly" value="radio14" checked="checked" class="wicket-id3f" type="radio">			</td><td>Day<input style="width: 40px" value="" name="tabbedPanel:panel:radioGroup:txtFirstChoiceDay" id="id41" title="Value must be a number between 1 to 31" type="text">of every<input style="width: 40px" value="" name="tabbedPanel:panel:radioGroup:txtFirstChoiceMonth" id="id42" title="Value must be a number between 1 to 12" type="text">month(s)</td></tr><tr><td><input id="id43" name="tabbedPanel:panel:radioGroup:Monthly" value="radio15" class="wicket-id3f" type="radio"></td><td>The<select name="tabbedPanel:panel:radioGroup:rank" id="id44"><option selected="selected" value="0">First<option value="1">Second<option value="2">Third<option value="3">Fourth</select><select name="tabbedPanel:panel:radioGroup:day" id="id45"><option selected="selected" value="0">Monday<option value="1">Tuesday<option value="2">Wednesday<option value="3">Thursday<option value="4">Friday<option value="5">Saturday<option value="6">Sunday</select>of every<input size="3" value="1" name="tabbedPanel:panel:radioGroup:monthCount" id="id46" type="text">month(s)</td></tr><tr><td colspan="2"><table><tbody><tr><td>Start time</td><td><span id="id47"><table><tbody><tr><td><select name="tabbedPanel:panel:radioGroup:startTime:hourPart"><option value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option selected="selected" value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</select></td><td><select name="tabbedPanel:panel:radioGroup:startTime:minutePart"><option selected="selected" value="0">00			<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23<option value="24">24<option value="25">25<option value="26">26<option value="27">27<option value="28">28<option value="29">29<option value="30">30<option value="31">31<option value="32">32<option value="33">33<option value="34">34<option value="35">35<option value="36">36<option value="37">37<option value="38">38<option value="39">39<option value="40">40<option value="41">41<option value="42">42<option value="43">43<option value="44">44<option value="45">45<option value="46">46<option value="47">47<option value="48">48<option value="49">49<option value="50">50<option value="51">51<option value="52">52<option value="53">53<option value="54">54<option value="55">55<option value="56">56<option value="57">57<option value="58">58<option value="59">59</select></td></tr></tbody></table></span></td></tr></tbody></table></td></tr></tbody></table></div></div></td></tr><tr><td><button class="stepcenternormal" name="btnGenerate" id="Button7" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</button></td></tr></tbody></table></td></tr></tbody></table></div><div id="tabs-6">			<table><tbody><tr><td><table style="width: 100%" cellpadding="0" cellspacing="0"><tbody><tr style="height:92px;"><td valign="top"><div class="tabpanel4" style="width: 450px" id="Div5"><div class="tab-panel"><table><tbody><tr><td><input id="id4f" name="tabbedPanel:panel:radioGroup:Yearly" value="radio16" checked="checked" class="wicket-id4e" type="radio"></td><td>Every<select name="tabbedPanel:panel:radioGroup:selFirstChoiceMonth" id="id50"><option selected="selected" value="January">January<option value="February">February<option value="March">March<option value="April">April<option value="May">May<option value="June">June<option value="July">July<option value="August">August<option value="September">September<option value="October">October<option value="November">November<option value="December">December</select><input class="dayEntry" value="1" name="tabbedPanel:panel:radioGroup:txtFirstChoiceDay" id="id51" type="text"></td></tr><tr><td><input id="id52" name="tabbedPanel:panel:radioGroup:Yearly" value="radio17" class="wicket-id4e" type="radio"></td><td>The<select name="tabbedPanel:panel:radioGroup:secondChoiceRank" id="id53"><option selected="selected" value="First">First<option value="Second">Second<option value="Third">Third<option value="Fourth">Fourth</select><select name="tabbedPanel:panel:radioGroup:secondChoiceDay" id="id54"><option selected="selected" value="Monday">Monday<option value="Tuesday">Tuesday<option value="Wednesday">Wednesday<option value="Thursday">Thursday<option value="Friday">Friday<option value="Saturday">Saturday<option value="Sunday">Sunday</select>of<select name="tabbedPanel:panel:radioGroup:secondChoiceMonth" id="id55"><option selected="selected" value="January">January<option value="February">February			<option value="March">March<option value="April">April<option value="May">May<option value="June">June<option value="July">July<option value="August">August<option value="September">September<option value="October">October<option value="November">November<option value="December">December</select></td></tr><tr><td colspan="2"><table><tbody><tr><td>Start time</td><td><span id="id56"><table><tbody><tr><td><select name="tabbedPanel:panel:radioGroup:startTime:hourPart"><option value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option selected="selected" value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23</select></td><td><select name="tabbedPanel:panel:radioGroup:startTime:minutePart"><option selected="selected" value="0">00<option value="1">01<option value="2">02<option value="3">03<option value="4">04<option value="5">05<option value="6">06<option value="7">07<option value="8">08<option value="9">09<option value="10">10<option value="11">11<option value="12">12<option value="13">13<option value="14">14<option value="15">15<option value="16">16<option value="17">17<option value="18">18<option value="19">19<option value="20">20<option value="21">21<option value="22">22<option value="23">23<option value="24">24<option value="25">25<option value="26">26<option value="27">27<option value="28">28<option value="29">29<option value="30">30<option value="31">31			<option value="32">32<option value="33">33<option value="34">34<option value="35">35<option value="36">36<option value="37">37<option value="38">38<option value="39">39<option value="40">40<option value="41">41<option value="42">42<option value="43">43<option value="44">44<option value="45">45<option value="46">46<option value="47">47<option value="48">48<option value="49">49<option value="50">50<option value="51">51<option value="52">52<option value="53">53<option value="54">54<option value="55">55<option value="56">56<option value="57">57<option value="58">58<option value="59">59</select></td></tr></tbody></table></span></td></tr></tbody></table></td></tr></tbody></table></div></div></td></tr><tr><td height="40"><button class="stepcenternormal" name="btnGenerate" id="Button9" onclick="System.Cron.GetExpression();">Save</button><button class="stepcenternormal" name="btnClose" id="idc" onclick="closeMenuPopup(event);">Cancel</button></td></tr></tbody></table></td></tr></tbody></table></div></div></div><div id="130554998088245823:viewControl1:linkscriptonly"><div class="linkcontrol" bizappid="130554998088245823:viewControl1:linkscriptonly" bza-ctrlid="linkscriptonly" bza-args="False[VS]ESystemaee43" onclick="BizAPP.UI.LinkControl.customLink(this, event);"><!--STARTPOMIT--><div></div><!--ENDPOMIT--></div></div></td></tr></table></div>';b=addWindowEvent(b);if(System.Cron){BizAPP.MenuPopup.Create({html:b,selector:a.target,mode:"open",position:"bottom pright",callback:function(){System.Cron.Init();a.stopPropagation()}})}else{BizAPP.UI.LoadScript({eid:"ESystemae728",callback:function(){BizAPP.MenuPopup.Create({html:b,selector:a.target,mode:"open",position:"bottom pright",callback:function(){System.Cron.Init();a.stopPropagation()}})}})}}}function closeMenuPopup(a){a=a||window.event;$(".bza-dropdown").removeClass("open");a.stopPropagation()}function callSearchDialog(f,e,h,b,d){if(f==null){f=window.event}setForceFocus("forcefocus",f);e=e+"?html.args="+b;var a=showDialogWithOptions(e,"0px","0px","no","no");if(a&&(a==true||a.toLowerCase()=="true")){callGetDependentFields(b)}if(d&&d!=""){try{var k=getElementByBizAPPId(d,"input");if(k){k.focus()}}catch(m){}}}function setSearchFocus(){var b=getElementByBizAPPId("SearchControl","DIV");if(b){try{var a=getBizAppElementsByClassName(b,"INPUT","fftb");if(a[0]&&a[0].focus){a[0].focus()}}catch(d){}}}function callSearchDialogAndExecutePostVerb(f,e,h,d,b){setForceFocus("forcefocus",f);e=e+"?html.args="+d;var a=showDialogWithOptions(e,"0px","0px","no","no");if(a==true||a=="true"){callPostRuntimeMethod(b);g_enableRichTextSave=false;callGetDependentFields(d);g_enableRichTextSave=true}}function callShowImportDialog(d,b,e){setForceFocus("forcefocus",d);var a=380;b=b+"?html.args="+e+"&width="+a;showDialogWithOptions(b,5+"px",a+"px","yes","yes")}function callDelete(b,m,f,o){setForceFocus("forcefocus",b);var h;if(o!=null){var a=getElementByBizAPPId(o);if(a!=null&&a.nodeName=="DIV"){var d=a.getElementsByTagName("select")[0];var k="";for(var e=0;e<d.length;e++){var n=d.options[e];if(n.selected){k+=n.value+";"}}h=k.substring(0,k.length-1).trim()}else{h=o}}else{h=o}callOutlineWithProcessing(["Delete",m,f,h])}function callCommitMoveByPlaces(k,e,m){var n=m;var f;if(m!=null){var a=getElementByBizAPPId(m);if(a!=null){var h;var b=a;for(var d=0;d<b.length;d++){if(h==null){h=b[d].value}else{h=h+","+b[d].value}}f=h}}callOutline(["CommitMoveByPlaces",k,e,f])}function callMoveByPlaces(k,e,m,o){var n=m,p,f;if(m!=null){var a=getElementByBizAPPId(m);if(a!=null){m=a.value;p=a.style.height+","+a.style.width;var h;var b=a;for(var d=0;d<b.length;d++){if(h==null){h=b[d].value}else{h=h+","+b[d].value}}f=h}}callOutline(["MoveByPlaces",k,e,o,n,m,p,f])}function callMoveNext(d,a,b){_callOutlinePagination(d,a,val,"MoveNext")}function callMovePrevious(d,a,b){_callOutlinePagination(d,a,val,"MovePrevious")}function callMoveFirst(d,a,b){_callOutlinePagination(d,a,val,"MoveFirst")}function callMoveLast(d,a,b){_callOutlinePagination(d,a,val,"MoveLast")}function _callOutlinePagination(e,a,d,b){var f=d;if(d!=null){var h=getElementByBizAPPId(d);if(h!=null){f=h.value}else{f=d}}callOutline([b,e,a,f])}function callAddMultipleAllowedValues(e,a,d){var b=getElementByBizAPPId(d);callOutline(["AddMultipleAllowedValues",e,a,b.children[0].children[0].children[0].children[0].children[0].value])}function callRemoveMultipleAllowedValues(e,a,d){var b=getElementByBizAPPId(d);callOutline(["RemoveMultipleAllowedValues",e,a,b.children[0].children[0].children[0].children[2].children[0].value])}function callApplyCloneStep(a,b){setForceFocus("forcefocus",a);callOutline(["ApplyCloneStep",b])}function callApplyStepRefreshStepOnly(e,a,d,b){callOutline(["ApplyActionRefreshStepOnly",a,d,bza_getSize(e),b])}function callWizardApplyStep(h,k,b,f,e,d,a){setForceFocus("forcefocus",h);realWizardApplyStep(k,b,f,e,d,a)}function realWizardApplyStep(h,b,f,e,d,a){if(e&&e!=null&&e!="undefined"){BizAPP.UI.InlinePopup.Confirm({message:e,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}callOutlineWithProcessing(["WizardApplyAction",b,f,bza_getSize(h),d,a])},fnCancelOnclick:function(){ProcessingStatus(false,true)}})}else{callOutlineWithProcessing(["WizardApplyAction",b,f,bza_getSize(h),d,a])}}function callApplyStep(h,k,b,f,e,d,a){if(!h){h=window.event}if(h&&h.type=="focus"&&h.altKey==false){return}BizAPP.UI.StepControl.CheckApplyStep(h,k,b,f,e,d,a,function(){ProcessingStatus(true,true);if(f!="Cancel"&&f!="ObjectCancel"){if(commitEditableGrids()!=true){return}}g_editableGrids.clear();setForceFocus("forcefocus",h);try{var n=getSourceElement(h);if(n){$(n).closest(".StepControlEx").hide();g_callBacks.push(function(){$(n).closest(".StepControlEx").show()})}}catch(o){}if(e&&e!=null&&e!="undefined"){realApplyStep(k,b,f,e,d)}else{var m=100;if($.active){m=2000}ProcessingStatus(true,true);setTimeout("realApplyStep( '"+k+"', '"+b+"', '"+f+"', '"+e+"', '"+d+"')",m)}})}function callApplyPostBackStep(a,h,d,k,b){if(!a){a=window.event}var o="";var m=b.split(",");for(var e=0;e<m.length;e++){var n=m[e].split(":")[0];var f=m[e].split(":")[1];o+=BizAPP.UI.getValue(n,f);o+=","}ajaxSyncCall("OutlineEx",["ApplyPostBackStep",h,d,k,b,o])}function evalRegisteredEvents(){while(applyStepEvents.length>0){var command=applyStepEvents.pop();eval(command)}}function realApplyStep(k,d,h,f,e){evalRegisteredEvents();if(f&&f!=null&&f!="undefined"){BizAPP.UI.InlinePopup.Confirm({message:f,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}var m=["ApplyAction",d,h,bza_getSize(k),e];g_callBacks.push(function(a,o,n){BizAPP.UI.ApplyStepCallback(m,a,o,n)});callOutlineWithProcessing(m)},fnCancelOnclick:function(){backGroundBlocker(false);ProcessingStatus(false,true);if(g_callBack){g_callBack()}BizAPP.UI.ProcessCallBacks(g_callBacks)}})}else{var b=["ApplyAction",d,h,bza_getSize(k),e];g_callBacks.push(function(a,n,m){BizAPP.UI.ApplyStepCallback(b,a,n,m)});callOutlineWithProcessing(b)}}function callApplyStepSyncCall(f,h,a,e,d,b){if(!f){f=window.event}if(f&&f.type=="focus"&&f.altKey==false){return}setForceFocus("forcefocus",f);evalRegisteredEvents();if(d&&d!=null&&d!="undefined"){BizAPP.UI.InlinePopup.Confirm({message:d,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}ajaxSyncCall("OutlineEx",["ApplyAction",a,e,bza_getSize(h),b])},fnCancelOnclick:function(){var k=getElementByBizAPPId("backgroundmasker","div");if(k!=null){k.style.display="none"}}})}else{ajaxSyncCall("OutlineEx",["ApplyAction",a,e,bza_getSize(h),b])}}function callWizardApplySyncStep(f,h,e,k,d,a){setForceFocus("forcefocus",f);var b=outlineAjaxCall(["ApplySyncAction",e,k,d,a]);responseHandler(b)}function callApplySyncStep(e,h,d,k,b,f){if(!e){e=window.event}if(e&&e.type=="focus"&&e.altKey==false){return}setForceFocus("forcefocus",e);var a=outlineAjaxCall(["ApplySyncAction",d,k,b,f]);responseHandler(a)}function callSetAndGetDependentFields(a,b){callOutline(["SetAndGetDependentFields",a,b])}function callSetDependentFields(d,a,b){callSetField(a,b)}function assignFieldValue(d,m,h,f,k,b,e){e=e||false;var a=false;if(d==""||d==NaN||d==undefined){a=true;displayMessage("AssignFieldValue - ROID is empty")}if(m==""||m==NaN||m==undefined){a=true;displayMessage("AssignFieldValue - Field Name is empty")}if(a==false){if(typeof k==="undefined"){k="True"}else{if(k==true){k="True"}else{k="False"}}if(typeof b==="undefined"){b="False"}callOutline(["SetFieldValue",d,m,h.toString(),f.toString(),k,b],e)}}function applyStepOfType(d,e,b){var a=false;if(d==""||d==NaN||d==undefined){displayMessage("ApplyStepOfType - ROID is empty");a=true}if(e==""||e==NaN||e==undefined){displayMessage("ApplyStepOfType - Step Name is empty");a=true}if(b==""||b==NaN||b==undefined){displayMessage("ApplyStepOfType - Step Type is empty");a=true}if(a==false){callOutline(["ApplyStep",d,e,b,"","",""])}}function callSetField(a,b){debug("callSetField ( "+b+" ) ");callOutline(["SetField",a,b])}function callWordSetField(b,e,f,a){var d=new Array();d[0]="SetField";d[1]=b;d[2]=e;d[3]=f;ajaxSyncCall("OutlineEx",d);if(a=="true"||a=="True"){setTimeout("window.returnValue = popup;window.close();",1000)}}function callAllDependentFields(a){var b=new Array();b[0]="GetAllDependentFields";b[1]=a;callOutline(b)}function callGetDependentFields(a){var b=new Array();b[0]="GetDependentFields";b[1]=a;callOutline(b)}function callCancel(d,a){var b=new Array();b[0]="Cancel";b[1]=d;b[2]=a;callOutlineWithProcessing(b)}function callSave(d,a){var b=new Array();b[0]="Save";b[1]=d;b[2]=a;callOutlineWithProcessing(b)}function callDraftSave(d,a){debug("DraftSave ( )");var b=new Array();b[0]="SaveDraft";b[1]=d;b[2]=a;callOutlineWithProcessing(b)}function callRefreshForm(b){var a=new Array();a[0]="RefreshForm";a[1]=b;callOutlineWithProcessing(a)}function callReload(d,b){debug("Reload ( )");var a=new Array();a[0]="Reload";a[1]=b;a[2]=bza_getSize(d);callOutline(a)}function callShowErrors(){callClosePopUp("configcontrolid");BizAPP.UI.InlinePopup.CreateNew({html:'<button class="formbutton" style="float:right" onclick="clearExceptionLog(event);">Clear Exceptions</button><pre style="overflow:auto;width:'+(document.body.clientWidth-200)+'px">'+exceptionStack+"</pre>"})}function callShowLogs(){callClosePopUp("configcontrolid");showPopup("Debug Console - Logs",'<button class="formbutton" style="float:right" onclick="clearLog(event);">Clear Logs</button><pre>'+logStack+"</pre>",document.body.clientHeight-150,document.body.clientWidth-200,true,true)}function calldebugConsole(e,h){if(e!=null&&e!="undefined"){var b=getElementByBizAPPId("exceptionspopup","div");if(b){b.innerHTML='<pre class="excpStack">'+e+"</pre>"}var d=getElementByBizAPPId("exceptionspopupcontainer","div");d.style.display="block";d.title=h;var a=document.documentElement.offsetWidth/4;var f=document.documentElement.offsetHeight/2-150;d.style.left=a+"px";d.style.top=f+"px"}}function callShowConfigControl(b,d,a){ajaxAsyncCall("ConfigControlEx",["ConfigPopUp",d,a,"50px","50px"],false,true)}function callShowProfiling(b,a){var d=new Array();d[0]="ShowProfilerData";d[1]=a;ajaxAsyncCall("ConfigControlEx",d,false,true)}function callProcessProfiling(d,b,a){var e=new Array();e[0]="ProcessProfilingFlag";e[1]=b;if(a.toLowerCase()=="true"){e[2]="false"}else{e[2]="true"}e[3]=_locator;callClosePopUp("configcontrolid");ajaxAsyncCall("ConfigControlEx",e,false,true)}function showProfilerData(b){var a=getElementByBizAPPId(b,"DIV");a.style.display="block";a.style.position="absolute";var d=(screen.availWidth-a.clientWidth)/2;var e=(screen.availHeight-a.clientHeight)/2;a.style.top="0px";a.style.left=d+"px"}function callEnableDebug(d,a,b){var e=getElementByBizAPPId("vfdebugtext");if(e!=null){if($(e).text()=="Enable Debug"){$(e).html("<nobr>Disable Debug</nobr>");g_enableLog=true}else{$(e).html("<nobr>Enable Debug</nobr>");g_enableLog=false}}ajaxAsyncCall("ConfigControlEx",["EnableDebug",serializeArgs,b],false,true)}function callShowVersion(e,a,d){debug("ShowVersion( )");var b=getElementByBizAPPId(a);if(!b){b=event.srcElement}if(b){callOutlineWithProcessing(["ShowVersion",b.value,d,bza_getSize(e)])}}function callOutline(b,a){debug("Form: calling "+b[0],"info");if(a){ajaxSyncCall("OutlineEx",b)}else{ajaxAsyncCall("OutlineEx",b,false,false)}}function callOutlineWithProcessing(a){debug("Form: calling "+a[0],"info");ajaxAsyncCall("OutlineEx",a,false,true)}function callHideHelp(b){var a=getElementByBizAPPId("Frame");if(a!=null){hideCalendar(a.id)}}function callShowHelp(f,b,e,d){var a=getElementByBizAPPId("Frame");if(a!=null){a.style.display="block";a.style.width=e;a.style.height=b;a.style.left=event.clientX;a.style.top=event.clientY;var f=a.children[0];f.src=d;f.height=b;f.width=e;a.focus()}}function deligate(event){if(event==null){event=window.event}var srcEl;if(event.srcElement==undefined){srcEl=event.target}else{srcEl=event.srcElement}var funCall=srcEl.getAttribute("deligate");eval(funCall)}function registerDeligate(b,f,m,e,a){var d=true;if(e=="True"&&a=="False"){for(i=0;i<delegateControls.length;i++){if(delegateControls[i]==b){delegateControls[i]=""}}d=false}if(d&&evaluateControlDelegation(b)){var h=getElementByBizAPPId(b,"SPAN");if(h!=null){var k;if(!isIE()){k=h.getElementsByTagName("input")[0]}else{var k=h.children[0];if(k){k.setAttribute("deligate",m);if(k.addEventListener){k.addEventListener("click",deligate,false)}else{if(k.attachEvent){k.attachEvent(f,deligate)}}}else{h.setAttribute("deligate",m);if(h.addEventListener){h.addEventListener("click",deligate,false)}else{if(h.attachEvent){h.attachEvent(f,deligate)}}}}}}}function evaluateControlDelegation(a){if(delegateControls.length>0){for(i=0;i<delegateControls.length;i++){if(delegateControls[i]==a){return false}}}delegateControls[delegateControls.length]=a;return true}function callSetAttribute(b,d,a){var e=getElementByBizAPPId(b);if(e!=null){e.setAttribute(d,a)}}function callSetClassName(a,b){var d=getElementByBizAPPId(a);if(d!=null){d.className=b}}function highlightstep(b){for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a]!=null){if(b.childNodes[a].className!=null){if(b.childNodes[a].className.endsWith("normal")){b.childNodes[a].className=b.childNodes[a].className.replace("normal","hover");b.childNodes[a].setAttribute("prevstate","normal")}else{if(b.childNodes[a].className.endsWith("selected")){b.childNodes[a].className=b.childNodes[a].className.replace("selected","hover");b.childNodes[a].setAttribute("prevstate","selected")}}}}}}function normalizestep(b){for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a]!=null){if(b.childNodes[a].className!=null){if(b.childNodes[a].className.endsWith("hover")){if(b.childNodes[a].getAttribute("prevstate")=="normal"){b.childNodes[a].className=b.childNodes[a].className.replace("hover","normal")}else{if(b.childNodes[a].getAttribute("prevstate")=="selected"){b.childNodes[a].className=b.childNodes[a].className.replace("hover","selected")}}}}}}}function selectstep(d){for(var a=0;a<d.childNodes.length;a++){if(d.childNodes[a]!=null){if(d.childNodes[a].className!=null){if(d.childNodes[a].className=="tabstepcenterhover"){d.childNodes[a].className="tabstepcenternormalnormal"}else{if(d.childNodes[a].className=="tabstepcenterselected"){d.childNodes[a].className="tabstepcenternormal"}}}}}var e=getElementInnerText(d);var h=d.parentNode.parentNode.parentNode.parentNode.parentNode;var b;b=h.innerHTML;if(b!=null){b=b.replace(/selected/g,"normal");b=b.replace("normalnormal","selected")}try{h.innerHTML=b}catch(f){}}function sltTab(e){e.className="tls";for(var a=0;a<e.childNodes.length;a++){if(e.childNodes[a]!=null&e.childNodes[a].className!=null){e.childNodes[a].className="trs"}}var b=e.parentNode.parentNode.parentNode.parentNode;var d=b.innerHTML;d=d.replace("tabRightSelected","tabRight");d=d.replace("tabLeftSelected","tabLeft");d=d.replace("tls","tabLeftSelected");d=d.replace("trs","tabRightSelected");b.innerHTML=d}var currentSelection=new Array();function callExpandOutlookMenu(b,f,d){var e=getElementsByGroupId("groupid",b);var a=0;for(a=1;a<e.length;a++){if(e[a].getAttribute("outlookid")==f){expandOutlookMenu(e[a],d,e[0].getAttribute("outlooksectioncount"))}else{e[a].style.display="none"}}}function expandOutlookMenu(e,b,a){e.style.display="block";if(e.getAttribute("expanded")!="true"){var d=new Array();d[0]="GetSection";d[1]=b;var f=getWidth(e.parentNode)+","+getHeight(e);d[2]=f;d[3]=a;callOutlook(d)}}function callOutlook(a){if(OutlookControl!=null){debug("View: calling "+a[0],"info");ajaxAsyncCall("OutlookEx",a,true,true)}}function callExpandSingleSectionMenu(e,n,m,h,a){var k=getElementsByGroupId("groupid",e);var f=0;var d=getElementByBizAPPId(n);var b=d.options[d.selectedIndex].text;for(f=1;f<k.length;f++){if(k[f].getAttribute("outlookid")==b){expandMultiSectionMenu(k[f],d.value,k[0].getAttribute("outlooksectioncount"));updateSelectedScreen(h,b)}else{k[f].style.display="none"}}}function callExpandMultiSectionMenu(h,e,v,n,o){var a=o.target;if(!o.target){a=o.srcElement}if(currentSelection[h]){currentSelection[h].className="outlookgroup"}else{var q=a.parentElement.parentElement.parentElement;var b=q.children[0].children[0].children[0];b.className="outlookgroup"}a.className="outlookselectedgroup";currentSelection[h]=event.srcElement;var u=a.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;var p=u.children[2].children[0].children[0].children[0].children.length;var f=u.children[2].children[0].children[0].children[0].children;for(var m=0;m<f.length;m++){var k=f[m].children[0].children[0];if(k.getAttribute("styletype")=="DUMMY"){k=k.children[0]}var d=k.getAttribute("outlookid");if(e==d){k.style.display="block";var t=u.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;expandMultiSectionMenu(k,v,f.length);u.children[1].children[0].innerText=e}else{k.style.display="none"}}return}function updateSelectedScreen(d,a){var b=getElementByBizAPPId("SelectedScreen"+d);if(b!=null){b.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;"+a}}function expandMultiSectionMenu(e,b,a){e.style.display="block";var d=new Array();if(e.getAttribute("expanded")!="true"){d[0]="GetSection";d[1]=b;var f=getWidth(e.parentNode)+","+getHeight(e);d[2]=f;d[3]=""+a;callMultiSection(d,false)}d[0]="GetDefaultView";d[1]=b;callMultiSection(d,false)}function callMultiSection(b,a){debug("View: calling "+b[0],"info");ajaxAsyncCall("MultiSectionEx",b,a,true)}var dragObject;var initialPos;function toggleOutlook(b){var a;if(isIE()){a=b.parentElement.parentElement.childNodes[0].childNodes[0].childNodes[0]}else{a=b.parentNode.parentNode.parentNode.childNodes[1].childNodes[0].childNodes[1]}if(a.style.display!="none"){b.className="MiddleSectionTable";a.style.display="none"}else{b.className="MiddleSectionTableCollapse";a.style.display="block"}document.onmouseup=null}function dragStart(b,a){dragObject=b.parentElement.parentElement.childNodes[0].childNodes[0].childNodes[0];initialPos=a.x;document.onmouseup=dragEnd}function dragEnd(b){if(!b){b=event}if(!dragObject){return}if(initialPos==b.x){return}var a=dragObject.style.width.split("px")[0];if(!a){a=parseInt(dragObject.clientWidth)}else{a=parseInt(a)}a=a+b.x-initialPos;if(a<0){a=0}dragObject.style.width=a;dragObject=null;document.onmouseup=null}function toggleDivision(b,e){var d=document.getElementById(e);var a=document.getElementById(b);if(d.style.display=="block"){d.style.display="none";a.className="collapseicon"}else{if(d.style.display=="none"){d.style.display="block";a.className="expandicon"}}document.onmouseup=null}function callApplyStyle(){var e=window.parent.document.documentElement;var h=e.getElementsByTagName("link");for(var d=0;d<h.length;d++){var f=document.createElement("link");f.href=h[d].href;f.rel=h[d].rel;f.type=h[d].type;try{document.appendChild(f)}catch(k){var b=document.getElementById("form1");if(b){b.appendChild(f)}}}}function LoadPage(src,srcType,args){BizAPP.UI.PrefetchResources();if(!g_customAjax){var obj=null;try{obj=eval(src)}catch(Error){setTimeout("LoadPage( '"+src+"', '"+srcType+"', '"+args+"');",100)}}if(obj||g_customAjax){g_callBacks.push(initSystemTray);ajaxAsyncCall(srcType,["LoadPage",args,callGetCurrentTimeZoneName1(),navigator.userAgent],!g_customAjax,true)}}function callApplyTheme(d,e,a,b){callPersonalize(["ApplyTheme",d,e,a,b])}function callPersonalize(a){ajaxAsyncCall("PersonalizationEx",a,true,true)}function callParameterizedQuery(a,e,d){if(isIE()){var f=showDialog(e,"450px","650px",false);if(f){callSerializedView(d)}}else{var b="callNavigateToView( '"+d+"')";pushEvent(b)}}function callParameterizedQueryRun(a){callParameterizedQueryClose(a)}function callParameterizedQueryClose(a){closeWindow(a)}function callGenerateReport(d,b){var a=getElementByBizAPPId(d);a.src=b}function callGenerateReportBasedOnFormat(a,e){var b=getElementByBizAPPId(e,"select");var d=new Array();d[0]="GenerateReportBasedOnFormat";d[1]=a;if(b){d[2]=b.value}else{d[2]=e}ajaxAsyncCall("ReportEx",d,false,true)}var replaceHolderId="replaceholder";var maximized=false;function resizeIFrame(b){var a=getElementByBizAPPId(b);if(!a){return}a.style.height=a.parentNode.clientHeight;if(parseInt(a.style.width)<=a.parentNode.clientWidth){a.style.width="100%"}}function callOnResize(){setResize(true,enterprise);callResize(enterprise)}function setResize(a,b){setSessionValue("resize",a)}function getResize(){return getSessionValue("resize")}function callResize(b,t,q){if(getResize()==false){return}if(!b){b=enterprise}var k=window.status;var u=getClientHeight();var d=getClientWidth();d=d-(isDialog()?0:10);var h=new Array();h[0]="SetClientResolution";h[1]=""+u;h[2]=""+d;setSessionValue("CH",u);setSessionValue("CW",d);var e=new Date();var n=getElementByBizAPPId(b);var f=0;if(n!=null){if(b==enterprise&&getHeight(n)==u&&getWidth(n)==d&&!q){return}if(u>0&&(t||b==enterprise)){setHeight(n,u)}if(d>10&&(t||b==enterprise)){setWidth(n,d)}displayStatus("Fetching resiable content");var o=getResizableObjects(b);f=o.length;displayStatus("Resiable Objects collected, Resizing");if(isIE()){for(var m=0;m<f;m++){if(o[m].BizAPPid){displayStatus("Resizing "+o[m].BizAPPid)}if(isIE6()){resizeIE6(o[m])}else{if(isIE7()){resizeIE6(o[m])}}}}else{for(var m=0;m<o.length;m++){resize(o[m])}}}else{debug("Auto resizing unavialable",debug)}var p=new Date();setResize(false);var a=(p.getTime()-e.getTime())/1000;displayStatus(a+" Second(s) Elapsed Re-Aligning "+f+" objects")}function getParentHeight(d){var b=d.parentNode;while(b){var a=getHeight(b);if(a){return a}b=b.parentNode}}function getParentWidth(d){var b=d.parentNode;while(b){var a=getWidth(b);if(a){return a}b=b.parentNode}}function resizeIE6(d){var a=getParentHeight(d);var b=getParentWidth(d);if(!a||!b){return}fitSize(d,a,b)}function resizeIE7(e){var d=getValidSizedIE7Parent(e);if(d!=null){var a=d.style.height.split("px")[0];var b=d.style.width.split("px")[0];if(isNaN(a)){a=d.style.pixelHeight}if(isNaN(b)){b=d.style.pixelWidth}fitSize(e,a,b)}}function resize(d){var a=getParentHeight(d);var b=getParentWidth(d);fitSize(d,a,b)}function fitSize(obj,height,width){var appbid=obj.getAttribute("BizAPPid");if(height&&isNaN(height)){height=height.split("px")[0]}if(width&&isNaN(width)){width=width.split("px")[0]}var rh=obj.getAttribute("rh");if(height&&rh!=null&&height!=""){var absHeight=eval(rh);if(absHeight!=null&&!isNaN(absHeight)){setHeight(obj,Math.max(0,Math.floor(absHeight)))}}var rw=obj.getAttribute("rw");if(width&&rw!=null&&width!=""){var absWidth=eval(rw);if(absWidth!=null&&!isNaN(absWidth)){setWidth(obj,Math.max(0,Math.floor(absWidth)))}}}function getValidSizedIE6Parent(a){while(a.parentNode!=null){if(a.parentNode.style.height!=""){return a.parentNode}a=a.parentNode;return a}return null}function getValidSizedIE7Parent(a){while(a.parentNode!=null){if(a.parentNode.style.height!=""){return a.parentNode}a=a.parentNode;return a}return null}function getResizablechildNodes(d,f){for(var b=0;b<d.childNodes.length;b++){var e=d.childNodes[b];if(e.tagName=="TBODY"){getResizablechildNodes(e,f)}var a=e.getAttribute("resizable");if(a!=null){f[f.length]=e;getResizablechildNodes(e,f)}}}function getResizableObjects(a){var h=new Array();var e=0;var m=getAllElements();var n=true;if(a){n=false}for(e=0;e<m.length;e++){var d=m[e];if(d.tagName&&d.tagName!="IFRAME"&&d.getAttribute&&d.getAttribute("resizable")!=null){if(!n&&d.getAttribute("BizAPPid")==a){n=true}if(n){h[h.length]=d}}}return h;var b=new Array();var f=new Array();var k=document.getElementsByTagName("FORM")[0];for(e=0;e<k.childNodes.length;e++){var d=k.childNodes[e];if(d.getAttribute("resizable")!=null){b[b.length]=d}getResizablechildNodes(d,b)}return b}function resolveScreenSize(){var m=getClientHeight();var b=getClientWidth();if(getSessionValue("CH")==m&&getSessionValue("CW")==b||location.href.split("?").length>1){return}var k="?";var e=new Array();if(location.href.split("?").count>1){var h=location.href.split("&");for(var d=0;d<h.count;d++){e[h[d].split("=")[0]]=h[d].split("=")[1]}}setSessionValue("CH",m);setSessionValue("CW",b);e.CH=m;e.CW=b;var a=location.href.split("?")[0];var f=true;for(var n in e){if(n!="clear"&&n!="addRange"){if(f){a=a+"?"+n+"="+e[n];f=false}else{a=a+"&"+n+"="+e[n]}}}location.href=a}function callCheckResizability(){var d=new Array();for(var a=0;a<document.all.length;a++){var b=document.all[a];if(b.getAttribute("resizable")!=null){if(b.parentNode.getAttribute("resizable")==null){if(b.parentNode.tagName!="TBODY"){d[d.length]=b}}}}return d}function getClientHeight(){if(isIE6()){if(isDialog()){return document.documentElement.offsetHeight}return document.documentElement.offsetHeight-20}return document.documentElement.clientHeight}function getClientWidth(){if(isIE6()){if(isDialog()){return document.documentElement.offsetWidth}return document.documentElement.offsetWidth-20}return document.documentElement.clientWidth-2}function callMaximize(a,f){var e=getElementByBizAPPId(a);if(maximized&&f){return}if(maximized==true){maximized=false;var b=getElementByBizAPPId("maximized");b.parentElement.innerHTML=e.outerHTML;var d=getElementByBizAPPId("enterpriseshell");d.style.display="";e.parentElement.innerHTML=""}else{maximized=true;var b=getElementByBizAPPId(replaceHolderId);if(b!=null&&e.parentElement!=b){b.innerHTML=e.outerHTML;if(e.parentElement!=null){e.parentElement.innerHTML="<div BizAPPid='maximized' id='maximized' height='"+getHeight(e)+"' width='"+getWidth(e)+"'> <div>"}var d=getElementByBizAPPId("enterpriseshell");d.style.display="none"}}}function callScreenControl(a){ajaxAsyncCall("ScreenEx",a,false,true)}function callChangeScreen(a,f,b){var h=getElementByBizAPPId(f,"select",false);var e="";if(h){e=h.value}var d=new Array();d[0]="ChangeScreen";d[1]=a;d[2]=b;d[3]=e;ajaxSyncCall("ScreenEx",d)}function callMSChartDrilldown(b,a){var d=new Array();d[0]="MSChartDrilldown";d[1]=b;d[2]=a;ajaxSyncCall("MSChartEx",d)}function Fire(b,d,a){fire(b,d,a)}function fire(b,e,a){var d=eventManager[e];fireEvent(b,eventManager[e],a);fireEvent(b,eventManager["*"],a)}function fireEvent(d,f,b){if(f!=null){var a=f[d];for(var h in a){if(h!="clear"&&h!="addRange"){var e=a[h];debug("Firing Event "+d);updateControl(e,b,d)}}}}function register(d,f,m,a,b){debug("Register( "+d+", "+f+", "+m+" )","info");var e=eventManager[f];if(e==null){e=eventManager[f]=new Array()}var k=e[d];if(k==null){k=e[d]=new Array()}var h=new Array();h.controltype=m;h.context=b;k[a]=h}function checkSessionExpiry(b){var a=new Array();a[0]="CheckSessionExpiry";a[1]=b;ajaxAsyncCall("HelperEx",a,true,true)}function alertSessionExpiry(e,d){var a=showDialog(e,"300px","400px",false);if(a){var b=new Array();b[0]="RenewSession";b[1]=d;ajaxAsyncCall("HelperEx",b,true,true)}else{var b=new Array();b[0]="Logout";ajaxAsyncCall("HelperEx",b,true,true)}}function customLogout(){var a=new Array();a[0]="Logout";ajaxSyncCallAndNoResponseHandler("HelperEx",a,true,true)}function getTab(a){if(a){return getParent(getParent(getParent(a)))}}function ResetTabPages(d){if(d){for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b];if(a.className&&a.className.indexOf("selected")>-1){a.className=a.className.substr(8)}ResetTabPages(a)}}}function SelectTabPage(a){if(a){for(var d=0;d<a.childNodes.length;d++){var b=a.childNodes[d];if(b.className&&b.className.indexOf("selected")<0){b.className="selected"+b.className}SelectTabPage(b)}}}function callApplyTheme(a){callPersonalize(["ApplyTheme",a])}function applyStyleSheets(k){var f=k.split(";");var d=document.getElementsByTagName("link");for(var a=0;a<d.length;a++){try{var b=d[a].parentElement;parentElement.removeChild(d[a])}catch(h){}}for(var a=0;a<f.length;a++){var e=document.createElement("link");e.href=f[a];e.rel="stylesheet";e.type="text/css";document.appendChild(e)}}var intervalKey="__INTERVAL__";var timerKey="__TIMER__";function setCustomInterval(a,b,e){var d=getIntervalMap();if(d[a]!=null){clearInterval(d[a])}d[a]=setInterval(b,e);setIntervalMap(d)}function setIntervalMap(a){setSessionValue(intervalKey,a)}function getIntervalMap(){var a=getSessionValue(intervalKey);if(!timers){a=new Array()}return a}function setCustomTimeout(a,b,e){var d=getTimerMap();if(d[a]!=null){clearTimeout(d[a])}d[a]=setTimeout(b,e);setTimerMap(d)}function getTimerMap(){var a=getSessionValue(timerKey);if(!a){a=new Array()}return a}function setTimerMap(a){setSessionValue(timerKey,a)}function callToolbar(a){if(a!=null){ajaxAsyncCall("ToolbarEx",a,true,true)}}function callReloadMetaData(){var a=new Array();a[0]="ReloadMetaData";ajaxAsyncCall("HelperEx",a,false,true)}function callChangedReload(a){var b=new Array();b[0]="Reload";b[1]=a;callView(b)}function callReload(a){callChangedReload(a)}function CallApplyNewType(b){var a=document.getElementById(b);closeWindow(a.value)}function callApplyTemplate(a){var b=document.getElementById(a);closeWindow(b.value)}function callTemplate(viewId,templatePage,serializedContext){var selectedObjects=showDialogWithOptions(templatePage,"250px","380px","yes","no");if(selectedObjects!=null){if(isIE()){callRenderTemplateView(viewId,serializedContext,selectedObjects)}else{var eve="callRenderTemplateView( '"+viewId+"', '"+serializedContext+"', '"+selectedObjects+"')";try{eval(eve)}catch(Error){}}}}function callCloseTemplate(d,a){var b=document.getElementById(a);if(b.value){closeWindow(b)}}function callRenderTemplateView(a,d,b){var e=new Array();e[0]="RenderTemplateView";e[1]=d;e[2]=b;e[3]=bza_getSize(a);ajaxSyncCall("ViewEx",e)}function callPreView(b,d){var e=d;result=showDialog(b,"400px","600px");if(result!=null){var a=result;callNavigateToView(a)}}function callPreViewRun(a){ajaxAsyncCall("HelperEx",["PreView",a],true,true)}function callNavigateToViewByRuntimeView(a,b){callView(["RenderViewByRuntimeView",a,b,bza_getSize(a)])}function callNavigateToViewByRuntimeViewWithArgs(a,d,b){callView(["RenderViewByRuntimeView",a,d,bza_getSize(a),b])}function callNavigateToViewByRuntimeViewRuntimeObjectShowCaption(b,e,a,d){callView(["RenderViewByRuntimeViewRuntimeObjectShowCaption",b,e,a,d,bza_getSize(b)])}function callNavigateToViewByRuntimeViewRuntimeObject(b,d,a){callView(["RenderViewByRuntimeViewRuntimeObject",b,d,a,bza_getSize(b)])}function callNavigateToView(b,a,d){callView(["RenderView",b,a,d,bza_getSize(controlName)])}function callNavigateToLastView(a){callView(["RenderLastView",a,bza_getSize(controlName)])}function callView(a){ajaxAsyncCall("ViewEx",a,false,true)}function callViewSyncCall(a){ajaxSyncCall("ViewEx",a)}function callNavigateToNextView(a,b){callNavigateView(["RenderNextView",b,bza_getSize(a)])}function callNavigateToPreviousView(a,b){callNavigateView(["RenderPreviousView",b,bza_getSize(a)])}function callNavigateToCurrentView(a,b){callNavigateView(["RenderCurrentView",b,bza_getSize(a)])}function callNavigateToViewUsingViewNavigationException(a){ajaxSyncCall("HelperEx",["ViewNavigationException",a])}function callNavigateToViewByRuntimeFieldWithArgs(b,a,k,e,d){CloseAllPopups();var f;if(!e){f="false"}else{f="true"}var h=["RenderViewByRuntimeField",b,a,k,bza_getSize(b),f,e,"false",d];callView(h)}function realCallNV(b,a,h,d,e){var f=["RenderViewByRuntimeField",b,a,h,bza_getSize(b),"true",d,"false"];callView(f)}function nvByRF(b,a,d){CloseAllPopups();realCallNV(b,a,d,"","false")}function nvByDV(b,a,e,d){realCallNV(b,a,e,d,"true")}function callNavigateToViewByDrilldownViewPopup(b,a,e,d){nvByDV(b,a,e,d)}function callNavigateView(a){debug("ViewNavigation: calling "+a[0],"info");ajaxAsyncCall("ViewNavigationEx",a,false,true)}function callViewCollection(a){debug("ViewNavigation: calling "+a[0],"info");ajaxAsyncCall("ViewCollectionEx",a,false,true)}function callRecentViewCollection(a){debug("RecentViewCollection: calling "+a[0],"info");ajaxAsyncCall("RecentEx",a,true,true)}function callListNavigateToView(a,b,e,d){var h=getElementByBizAPPId(b,"select");if(h!=null&&h.value){var f=new Array();f[0]="RenderViewByRuntimeObject";f[1]=a;f[2]=e;f[3]=h.value;f[4]=bza_getSize(e);f[5]=d;callView(f)}}function callListBoxAttachmentDownload(a){var d=getElementByBizAPPId(a);if(d!=null&&d.value){var b=new Array();b[0]="RenderListBoxAttachmentDownload";b[1]=d.value;ajaxAsyncCall("ViewEx",b,false,true)}}function callSerializedView(b){var a=new Array();a[0]="RenderSerializedView";a[1]=b;ajaxSyncCall("ViewEx",a)}function callViewInitialize(a){setResize(true,a);callResize(null,false,true)}function embedView(a,e){var b=getElementByBizAPPId(a);var d=new Array();d[0]="RenderViewByDisplayName";d[1]=a;d[2]=e;d[3]=bza_getSize(a);callView(d)}function callStartView(a,d,b){var e=new Array();e[0]="RenderViewByViewableUIObject";e[1]=d;e[2]=a;e[3]=bza_getSize(d);e[4]=b;callView(e)}function callTree(a){ajaxAsyncCall("TreeEx",a,true,true)}function callHighlightNavigation(a){if(a.className.indexOf("highlight")==-1){a.className="highlight"+a.className}}function callNormalizeNavigation(a){if(a.className.indexOf("highlight")==0){a.className=a.className.substring(9)}}function callQuickCreateObject(b,f,e){var a=getElementByBizAPPId(f);var d=new Array();d[0]="QuickCreateObject";d[1]=b;d[2]=a.value;d[3]=e;ajaxAsyncCall("QuickCreateEx",d,false,true)}function callSubmitToSearch(f,b,e,a,d){if(f==null){f=window.event}if(f.keyCode=="13"){callSearch(b,e,a,d)}}function callSearch(h,e,k,n){var p=getElementByBizAPPId(e,"select",false);var b;if(p!=null){b=p.value}var a=getElementByBizAPPId(k,"select",false);var o;if(a!=null){o=a.value}var m=getElementByBizAPPId(n,"input",false);var d;if(m!=null){d=m.value}var f=new Array();f[0]="Search";f[1]=h;f[2]=b;f[3]=o;f[4]=d;callSearchControl(f)}function callSearchObjectTypeChanged(b,e){var d=getElementByBizAPPId(e);var a;if(d!=null){a=d.value}ajaxAsyncCall("SearchEx",["SearchObjectTypeChanged",serializeArgs,a],false,true)}var g_schedulerchc;function scheduler_init(b,a){g_schedulerchc=b;if(a){$(document.body).find('[uie="APPTAREA"]').css({overflow:"","overflow-x":""})}}function scheduler_dblClick(q,v,b){v.cancel=true;if(g_schedulerchc){var t=q._selectedAppt;if(t&&!t.elem){t=null}else{if(q._selectedApp){t=q._selectedApp}}var n="";if(t){n=t.key}else{if(q._selectedAD){n=q._selectedAD.getAttribute("key")}}if(n){}else{var k="";var h=new Date();if(q._id=="WebMonthView"){var d=ig_getWebScheduleInfoById("WebScheduleInfo");if(d){h=d.getActiveDay()}}else{var m=b.getAttribute("date"),p;if(m!=null){p=m.split(",")}else{if($(b).attr("day")){h=new Date(q._days[$(b).attr("day")].time)}else{p=q._props[3].split("-")}var o=(q._getUieFromElem(b).replace("SLOT","")/2);h.setHours(o,o%1?30:0)}if(p!=null){var f=parseInt(p[0]);var e=parseInt(p[1]);var u=parseInt(p[2]);h.setFullYear(f,e,u)}}if(m!=null){k=h.toDateString()}else{k=h.toDateString()+" "+h.getHours()+":"+h.getMinutes()}}window.parent.ajaxAsyncCall("SchedulerEx",["Drilldown",g_schedulerchc,n,k],false,true);return cancelBubble(v)}}function callNavigateToScheduler(a,b,d){ajaxAsyncCall("SchedulerCalendarEx",["RenderSchedulerView",serializeArgs,b,d,bza_getSize(b)],true,true)}function callSchedulerCalendarPopUp(f,b,d){if(f==null){f=window.event}var a,e;if((document.documentElement.offsetWidth-f.clientX)<200){e=document.documentElement.offsetWidth-230+"px"}else{e=f.clientX.toString()+"px"}if((document.documentElement.offsetHeight-f.clientY)<230){a=document.documentElement.offsetHeight-230+"px"}else{a=f.clientY.toString()+"px"}ajaxAsyncCall("SchedulerCalendarEx",["SchedulerCalendarPopUp",b,d,a,e],false,true)}function callSchedulerCalendarDisplay(b){var a=getElementByBizAPPId(b,"div");if(a){a.style.display="none";a.style.position="absolute"}}var popupId;function isChartMode(){return"false"}function callSchedulerUserType(a,b){ajaxAsyncCall("SchedulerEx",["SchedulerChangeUserType",a,b,isChartMode()],false,true)}function callSchedulerSelectedUser(a,f,d){var b="";var e=getElementByBizAPPId(f);if(e){b=e.value}ajaxAsyncCall("SchedulerEx",["SchedulerSelectedUser",a,b,d,isChartMode()],false,true)}function callSchedulerDayView(a){ajaxAsyncCall("SchedulerEx",["SchedulerDayView",a,isChartMode()],false,true)}function callSchedulerWeekView(a){ajaxAsyncCall("SchedulerEx",["SchedulerWeekView",a,isChartMode()],false,true)}function callSchedulerMonthView(a){ajaxAsyncCall("SchedulerEx",["SchedulerMonthView",a,isChartMode()],false,true)}function callSchedulerGantChartView(a){ajaxAsyncCall("SchedulerEx",["SchedulerGantChartView",a],false,true)}function callSchedulerNavigateToNext(a){ajaxAsyncCall("SchedulerEx",["SchedulerNavigateToNext",a,isChartMode()],false,true)}function callSchedulerNavigateToPrevious(a){ajaxAsyncCall("SchedulerEx",["SchedulerNavigateToPrevious",serializeArgs,isChartMode()],false,true)}function callSchedulerToday(a){ajaxAsyncCall("SchedulerEx",["SchedulerToday",a,isChartMode()],false,true)}function callSchedulerStateSelector(a,e){var d="";var b=getElementByBizAPPId(e);if(b){d=b.value}ajaxAsyncCall("SchedulerEx",["SchedulerStateSelector",serializeArgs,,isChartMode()],false,true)}function callSchedulerThumbnailStateSelector(a,b){ajaxAsyncCall("SchedulerEx",["SchedulerStateSelector",a,b,isChartMode()],false,true)}function callSchedulerDayViewDrilldown(a,b){ajaxAsyncCall("SchedulerEx",["SchedulerDayViewDrilldown",a,b,isChartMode()],false,true)}function callSchedulerWeekViewDrilldown(b,a,d){ajaxAsyncCall("SchedulerEx",["SchedulerWeekViewDrilldown",serializeArgs,a,d],false,true)}function callApplySchedulerSelectedQuery(d,a){var b=new Array();b[0]="SchedulerSelectedQuery";b[1]=a;b[2]=isChartMode();if(d!=null){b[3]=d.value}ajaxAsyncCall("SchedulerEx",b,false,true)}function callSchedulerUsersPopupOnMouseClick(a,d){var b=getElementByBizAPPId(d,"div");if(b){b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.height="25px";b.style.width="200px";b.style.display="inline"}}function callSchedulerDetailsPopupOnMouseOver(a,d){if(popupId){callSchedulerDetailsPopupOnMouseOut(a,popupId)}popupId=d;var b=getElementByBizAPPId(d,"div");if(b){b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.height="200px";b.style.width="300px";b.style.display="block"}}function callSchedulerDetailsPopupOnMouseOut(a,d){var b=getElementByBizAPPId(d,"div");if(b){b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.height="0px";b.style.width="0px";b.style.display="none"}}function callSchedulerDetailsPopupOnMouseClick(a,f,b,m,o,h){if(a==null){a=window.event}var e=new Array();e[0]="SchedulerPopUp";e[1]=f;e[2]=b;e[3]=m;e[4]=a.y.toString()+"px";e[5]=a.x.toString()+"px";e[6]=h;var k=getElementByBizAPPId(o,"div");if(k){var n=k.offsetWidth-a.x;var d=k.offsetHeight-a.y;if(d<220){e[4]=(k.offsetHeight-220)+"px"}if(n<300){e[5]=(k.offsetWidth-300)+"px"}}ajaxAsyncCall("SchedulerEx",e,false,true)}function callSchedulerGanttDetailsPopUpOnMouseClick(a,h,b,n,p,k,e){if(a==null){a=window.event}var f=new Array();f[0]="SchedulerPopUp";f[1]=h;f[2]=b;f[3]=n;f[4]=a.y.toString()+"px";f[5]=a.x.toString()+"px";f[6]=k;var m=getElementByBizAPPId(p,"div");if(m){if(e==true||e=="true"||e=="True"){var d=m.offsetHeight-a.y;if(d<220){f[4]=(m.offsetHeight-220)+"px"}}var o=m.offsetWidth-a.x;if(o<300){f[5]=(m.offsetWidth-300)+"px"}}ajaxAsyncCall("SchedulerEx",f,false,true)}function transactionListHandler(b,a){var d=getSourceElement(b);var f=$(d).attr("mode");if(f=="save"){ajaxSyncCall("HelperEx",["CloseTransactionsPageAndLogout","Save"])}else{if(f=="dontsave"){signOutWithNoDirtyTransactionsCheck()}else{if(f=="view"){var e=getElementByBizAPPId("TransactionsList");if(e.value){ajaxSyncCall("HelperEx",["NavigateToPendingTransaction",a,e.value])}}}}}function callCloseTransactionsPage(d,a){var e=new Array();e[0]="CloseTransactionsPageAndLogout";e[1]=d;if(d=="Save"){ajaxSyncCall("HelperEx",e)}else{if(d=="DontSave"){closeWindow("signOutWithNoDirtyTransactionsCheck")}else{if(d=="Cancel"){closeWindow(false)}else{if(d=="View"){var f=getElementByBizAPPId("TransactionsList");if(f.value){var b="View,"+f.value+","+a;closeWindow(b)}}}}}}function callTransactionListPage(h,b){var a="271px";var e="370px";var d=showDialog(h,a,e,"no");if(d==true||d=="true"){signOut(b)}else{if(d=="signOutWithNoDirtyTransactionsCheck"){signOutWithNoDirtyTransactionsCheck()}else{if(d!=null&&d!="undefined"&&d!=false&&d.split(",")[0]=="View"){var f=new Array();f[0]="NavigateToPendingTransaction";f[1]=d.split(",")[2];f[2]=d.split(",")[1];ajaxSyncCall("HelperEx",f)}}}}function callRenderSteps(a,e,b){var d=new Array();d[0]="RenderSteps";d[1]=a;d[2]=e;ajaxSyncCall("HelperEx",d)}function callConfigureRuntimeObject(b,d,e){var f=new Array();f[0]="ConfigureRuntimeObject";f[1]=b;f[2]=d;var a;var h;if(e){a=e.clientX;h=e.clientY+10;if(a){a=a.toString()+"px"}if(h){h=h.toString()+"px"}f[3]=h;f[4]=a;ajaxAsyncCall("HelperEx",f,false,true)}}function callDelegationPopup(d,e,b,h,f){var k=new Array();k[0]="DelegationPopup";k[1]=d;k[2]=e;var a;var m;if(f){a=f.clientX;m=f.clientY;if(a){a=a.toString()+"px"}if(b){a=b}if(m){m=m.toString()+"px"}if(h){m=h}k[3]=m;k[4]=a;ajaxAsyncCall("HelperEx",k,false,true)}}function callDelegationItemOnClick(a,b,d){var e=new Array();e[0]="DelegationItemClick";e[1]=a;e[2]=b;ajaxAsyncCall("HelperEx",e,false,true)}function callUnDelegationItemOnClick(a,b,d){var e=new Array();e[0]="UnDelegationItemClick";e[1]=a;e[2]=b;ajaxAsyncCall("HelperEx",e,false,true)}function callShowBusinessObjectForm(b){var d=getElementByBizAPPId("businessobjectformpopupcontainer","div");d.style.display="block";var a=document.documentElement.offsetWidth/4;var f=document.documentElement.offsetHeight/2-150;d.style.left=a+"px";d.style.top=f+"px";var e=new Array();e[0]="ShowBusinessObjectForm";e[1]=b;ajaxAsyncCall("HelperEx",e,false,true)}function callShowPendingJobsInfo(b){var d=getElementByBizAPPId("pendingjobsinfopopupcontainer","div");d.style.diplay="block";var a=document.documentElement.offsetWidth/4;var e=document.documentElement.offsetHeight/2-150;d.style.left=a+"px";d.style.top=e+"px";ajaxAsyncCall("HelperEx",["ShowPendingJobsInfo",b,e+"px",a+"px"],false,true)}function bizapp_evalDefaultActionLink(d,f,a){var e=getSourceElement(d);var b=$(e).closest("li").attr("type");ajaxAsyncCall("HelperEx",["ExecuteDefaultActionLink",f,a,b],false,true)}var messageId;var newMessage;var persistAlertPopupPosition=false;var persistStickyNotePopupPosition=false;function callAlertDetailsPopup(f,b,e){messageId="";if(f==null){f=window.event}var h=new Array();h[0]="AlertPopUp";h[1]=b;h[2]=e;var a;var k;if(!isIE()){persistAlertPopupPosition=false}if(!persistAlertPopupPosition){persistAlertPopupPosition=true;if(f){a=Math.min(f.clientX,document.documentElement.offsetWidth-420);k=f.clientY}else{a=document.documentElement.offsetWidth/2-195;k=document.documentElement.offsetHeight/2-144}if(a){a=a.toString()+"px"}if(k){k=k.toString()+"px"}}else{var d=getElementByBizAPPId("alertpopup","div");if(d){a=d.style.left;k=d.style.top;a=a.toString();k=k.toString()}}h[3]=k;h[4]=a;ajaxAsyncCall("AlertEx",h,false,true)}function callRefreshAlertControl(a){var b=new Array();b[0]="RefreshAlertControl";b[1]=a;ajaxAsyncCall("AlertEx",b,false,false)}function callStickyNoteDetailsPopup(f,b,e){if(f==null){f=window.event}messageId="";var h=new Array();h[0]="StickyNotePopUp";h[1]=b;h[2]=e;var a;var k;if(!isIE()){persistStickyNotePopupPosition=false}if(!persistStickyNotePopupPosition){persistStickyNotePopupPosition=true;if(f){a=Math.min(f.clientX,document.documentElement.offsetWidth-450);k=f.clientY}else{a=document.documentElement.offsetWidth/2-195;k=document.documentElement.offsetHeight/2-144}if(a){a=a.toString()+"px"}if(k){k=k.toString()+"px"}}else{var d=getElementByBizAPPId("stickynotepopup","div");if(d){a=d.style.left;k=d.style.top;a=a.toString();k=k.toString()}}h[3]=k;h[4]=a;ajaxAsyncCall("AlertEx",h,false,true)}function callStickyNoteConfigure(d,e,b,h,f){if(f==null){f=window.event}var k=new Array();k[0]="ConfigureStickyNotes";k[1]=d;k[2]=e;var a;var m;if(f){a=Math.min(f.clientX,document.documentElement.offsetWidth-50);m=f.clientY;if(a){a=a.toString()+"px"}if(b){a=b}if(m){m=m.toString()+"px"}if(h){m=h}k[3]=m;k[4]=a;ajaxAsyncCall("AlertEx",k,false,true)}}function callApplyConfiguration(b,d,k,f){if(f==null){f=window.event}var h=new Array();h[0]="ApplyConfiguration";h[1]=b;var a=getElementByBizAPPId(k);var e=a.childNodes[0].checked;h[2]=e.toString();callClosePopUp(d);ajaxAsyncCall("AlertEx",h,false,true)}function callClosePopUp(a){var b=getElementByBizAPPId(a,"div");closeCalendar();if(b){b.style.display="none"}}function callDeleteMessage(f,d,b,e,a,k){messageId="";if(!isIE()){if(f==null){f=window.event}if(f){x=a;y=e}else{x=document.documentElement.offsetWidth/2-195;y=document.documentElement.offsetHeight/2-144}if(x){a=x.toString()}if(y){e=y.toString()}}else{if(k=="Alert"){popupControl=getElementByBizAPPId("alertpopup","div")}else{popupControl=getElementByBizAPPId("stickynotepopup","div")}if(popupControl){e=popupControl.style.top;a=popupControl.style.left}}var h=new Array();h[0]="DeleteMessage";h[1]=d;h[2]=b;h[3]=e;h[4]=a;h[5]=k;ajaxAsyncCall("AlertEx",h,false,true)}function callShowAllMessages(f,b,e,a,k){messageId="";var d;if(!isIE()){if(f==null){f=window.event}if(f){x=a;y=e}else{x=document.documentElement.offsetWidth/2-195;y=document.documentElement.offsetHeight/2-144}if(x){a=x.toString()}if(y){e=y.toString()}}else{if(k=="Alert"){d=getElementByBizAPPId("alertpopup","div")}else{d=getElementByBizAPPId("stickynotepopup","div")}if(d){e=d.style.top;a=d.style.left}}var h=new Array();h[0]="ShowAllMessages";h[1]=b;h[2]=e;h[3]=a;h[4]=k;ajaxAsyncCall("AlertEx",h,false,true)}function callPageNavigation(h,d,f,a,m,e,b){messageId="";if(!isIE()){if(h==null){h=window.event}if(h){x=a;y=f}else{x=document.documentElement.offsetWidth/2-195;y=document.documentElement.offsetHeight/2-144}if(x){a=x.toString()}if(y){f=y.toString()}}else{if(m=="Alert"){popupControl=getElementByBizAPPId("alertpopup","div")}else{popupControl=getElementByBizAPPId("stickynotepopup","div")}if(popupControl){f=popupControl.style.top;a=popupControl.style.left}}var k=new Array();k[0]="PageNavigation";k[1]=d;k[2]=f;k[3]=a;k[4]=m;k[5]=e;ajaxAsyncCall("AlertEx",k,false,false)}function callShowHideMessage(h,e){if(!messageId){messageId=h.split(";")[0]}var a=getElementByBizAPPId(messageId,"div");callSetContainerToNormal(messageId,"true");callSetContainerToNormal(e,"true");if(a){a.style.display="none"}if(newMessage){var b=getElementByBizAPPId(newMessage,"div");if(b){b.style.display="none"}}var d=h.split(";")[1];if(d!=null){messageId=d}callRezizeContainer(messageId,"false","false");var f=getElementByBizAPPId(h.split(";")[1]);if(f){f.style.display="block"}}function callRezizeContainer(h,e,a){var d="td_"+h;var f=getElementByBizAPPId(d,"TD");if(f){var b=f.getAttribute("reply");if(e=="true"){f.style.height="400px";f.style.width="100%";f.setAttribute("reply","alive")}else{if(b=="alive"){f.style.height="400px";f.style.width="100%"}}}if(a=="true"){callSetContainerToNormal(messageId,"true")}}function callSetContainerToNormal(e,b){var a="td_"+e;var d=getElementByBizAPPId(a,"TD");if(d){if(b=="true"){d.style.height="100%";d.style.width="100%"}}}function callCreateMessage(a,b,e,d){callShowHideMessage(e,"");if(messageId!=null){callRezizeContainer(messageId,"","true")}newMessage=d;ajaxAsyncCall("AlertEx",["CreateNewMessage",a,b],false,false)}function callEditMessage(a,b,f,e,d){callShowHideMessage(f,d);newMessage=e;ajaxAsyncCall("AlertEx",["EditMessage",a,b,e],false,false)}function callMarkAsRead(a,d,b){ajaxAsyncCall("AlertEx",["MarkAsRead",a,d,b],false,false)}function callMarkAllAsRead(f,b,e,a,h){messageId="";var d;if(h=="Alert"){d=getElementByBizAPPId("alertpopup","div");callClosePopUp("alertpopup")}else{d=getElementByBizAPPId("stickynotepopup","div");callClosePopUp("stickynotepopup")}if(!isIE()){if(f==null){f=window.event}if(f){x=a;y=e}else{x=document.documentElement.offsetWidth/2-195;y=document.documentElement.offsetHeight/2-144}if(x){a=x.toString()}if(y){e=y.toString()}}else{if(d){e=d.style.top;a=d.style.left}}ajaxAsyncCall("AlertEx",["MarkAllAsRead",b,e,a,h],false,true)}function callRefreshCounter(a,b){ajaxAsyncCall("AlertEx",["RefreshCounter",a,b],false,false)}function callViewCollectionPopup(h,f,d,e){if(h==null){h=window.event}var k=new Array();k[0]="ViewCollectionPopup";k[1]=f;k[2]=d;k[3]=e;var b;var m;if(h){b=h.clientX;m=h.clientY;var a=getElementPosition(getSourceElement(h));if(a){m=a[1]}if((document.documentElement.offsetWidth-h.clientX)<100){b=document.documentElement.offsetWidth-100}if((document.documentElement.offsetHeight-m)<230){m=document.documentElement.offsetHeight-230}}else{b=document.documentElement.offsetWidth/2-195;m=document.documentElement.offsetHeight/2-144}k[4]="";if(!isIE()){k[4]=m.toString()}k[5]=b.toString();ajaxAsyncCall("ViewCollectionEx",k,false,true)}function callChangeViewCollectionMenuItemAppearnce(d,a){var b=getElementByBizAPPId(d,"td");if(b){b.className=a}}function callExecuteJob(b){var d=getElementByBizAPPId("jobcontrolpopupcontainer","div");var a;var e;if(d){a=document.documentElement.offsetWidth/5;e=document.documentElement.offsetHeight/2-150;d.style.left=a+"px";d.style.top=e+"px"}ajaxAsyncCall("JobControlEx",["ExecuteJob",b,e+"px",a+"px"],false,false)}function callExecuteReportViewJob(a){ajaxAsyncCall("JobControlEx",["ExecuteJob",a,"",""],false,false)}function callRefreshJobControl(a,d){var e=true;var b=getElementByBizAPPId("jobcontrolpopupcontainer","div");if(b){if(b.style.display!="block"){e=false}}if(e){ajaxAsyncCall("JobControlEx",["RefreshJobControl",a],false,false)}}function callRefreshJobReportViewControl(a,d){var b=getElementByBizAPPId(d);if(b){ajaxAsyncCall("JobControlEx",["RefreshJobControl",a],false,false)}}function showPendingJobsContainer(a){var b=getElementByBizAPPId("jobcontrolpopupcontainer","div");if(b){if(a.toLowerCase()=="true"){b.style.diplay="block"}else{b.style.diplay="none"}}}function callRefreshReportViewer(a,e,b){var f=new Array();f[0]="RefreshReportViewer";f[1]=a;var d=getElementByBizAPPId(e);if(d){f[2]=d.value}else{f[2]=""}var h=getElementByBizAPPId(b);if(h){f[3]=h.value}else{f[3]=""}ajaxAsyncCall("ReportViewerEx",f,false,true)}function callEvaluateLink(a,d,b){if(commitEditableGrids()!=true){return}ajaxAsyncCall("AdvancedListEx",["ExecuteLink",a,d,b],false,true)}function callDisplayItems(b){var a=getElementByBizAPPId(b,"DIV");if(a){$(a).toggle()}}function callHighLightItem(d,a,f,b){var e=getSourceElement(d);if(e){e=$(e).closest("div")[0];if(a=="onmouseover"){e.className=b}else{e.className=f}}}function callChangeFilterToAddText(a,b,h,k){var o=getElementByBizAPPId(b,"DIV");if(o){var d=o.getAttribute(k);if(h=="onclick"){var f=d+"Filter";f=f.replace(" ","");var m="callChangeFilterToAddText( event, '"+f+"','onkeydown', 'itemname' );";o.innerHTML='<input class="formtextbox" itemname="'+d+'" id="'+f+'" parentId="'+b+'" style="width: 100%" onkeydown="'+m+'" onclick="if( event )event.cancelBubble=true;" title="'+d+'"/>';setFocus(f)}else{if(h=="onkeydown"){if(a.keyCode=="9"){var n=o.getAttribute("parentId");var e=getElementByBizAPPId(n,"DIV");if(o.value&&o.value!=""&&o.value!=undefined){e.innerHTML=d+"["+o.value+"]"}else{e.innerHTML=d}}}}}}function getAdvancedGridCheckBoxSelection(){return igtbl_selectColumn_BizAPP("UltraWebGrid","UltraWebGrid_c_0_0","UltraWebGrid_c_0_1","UltraWebGrid_c_0_2","UltraWebGrid_c_0_3")}function advancedGridRefresh(a){ajaxAsyncCall("HelperEx",["AdvancedGridRefresh",serializeArgs],false,true)}function callChangeViewByObjectPicker(b,a,d){if(a&&a!=""&&a!=NaN&&a!=undefined){if(isIE()){if(event&&(event.shiftKey||event.ctrlKey)){if(a.split(":")[2]==-1){showWindow("TestView.aspx?html.args=runtimeobjectid[NVS]"+a)}else{showWindow("TestView.aspx?html.args=runtimeisversion[NVS]True[PMS]runtimeobjectid[NVS]"+a)}return}if(document.activeElement.className=="formtextbox"&&document.activeElement.disabled==false){return}}callViewSyncCall(["RenderViewByRuntimeField",b,a,d,bza_getSize(b),"false"])}}function callSearchFilteredValue(searchPage,outlineArgs,args){searchPage=searchPage+"?html.args="+args;var selectedObjects;if(isIE6()){selectedObjects=showDialogWithOptions(searchPage,"480px","600px","yes","no")}else{selectedObjects=showDialogWithOptions(searchPage,"450px","600px","yes","no")}if(selectedObjects!=null){if(!isIE()){var eve="showObject( '"+selectedObjects+"', '"+args+"' )";eval(eve)}else{showObject(selectedObjects,args)}}}function callSearchControl(a){ajaxAsyncCall("SearchEx",a,false,true)}function showObject(a,b){callSearchControl(["ShowObjects",a,b])}var g_custSearchInit;var g_searchCHC;function callCustomSearchDialog(b,a){g_custSearchInit=a;g_searchCHC=b;ajaxAsyncCall("HelperEx",["ShowCustomSearchGrid",g_searchCHC],false,true)}function callCustAdvSrhDlg(b,a){g_custSearchInit=a;g_searchCHC=b;ajaxAsyncCall("HelperEx",["ShowCustomAdvSearch",g_searchCHC],false,true)}function showAdvSearchDialog(b,a){showDialogDQ("",b,550,800,false,a)}function custSearchCompleteHandler(a){zoomout();if(g_searchCHC){a=g_searchCHC;g_searchCHC=""}callOutline(["GetDependentFieldsInfo",a]);if(g_custSearchInit){try{g_custSearchInit="";var b=getElementByBizAPPId(g_custSearchInit,"input");if(b){b.focus()}}catch(d){logError("",d)}}}function verbTypeSearchCompleteHandler(a){zoomout();if(g_searchCHC){a=g_searchCHC;g_searchCHC=""}BizAPP.UI.LoadControlUsingContext(a)}function callObjectPickerCallBack(a,b){if(b&&b!=""&&b!=NaN&&b!=undefined){ajaxSyncCall("ObjectPickerEx",["ObjectPickerCallBack",a,b])}}function getObjectPickerValueForScheduler(a,b){callObjectPicker(["ObjectPickerValueForScheduler",a,getObjectPickerValue(b)])}function callViewPicker(a){callObjectPicker(["ShowSearchGrid",a])}function refreshViewPicker(a,b){zoomout();if(b){callObjectPicker(["AddToObjectPicker",a,b])}}function callDeleteOnObjectPicker(b,a){var d=getObjectPickerValue(a);if(d){callObjectPicker(["DeleteSelectedValue",b,d])}}function getObjectPickerValue(a){return getElementByBizAPPId(a,"select").value}function callObjectPicker(a){ajaxAsyncCall("ObjectPickerEx",a,false,true)}function callSearchUsersForImpersonation(){ajaxAsyncCall("ImpersonationControlEx",["ShowSearchGrid"],false,true)}function showImpDialog(b,a){showDialogDQ("",b,500,800,true,a)}function showDialogDQ(h,e,a,f,d,b){e=e.replace(/\[BSQ]/g,"'");e=e.replace(/\[BDQ]/g,'"');showPopup(h,e,a,f,true,false,d,b)}function bizapp_showDlg(h,b,k,f,d,m,a){if(h){h=h.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"').replace(/\[BSRQ]/g,"\r").replace(/\[BSNQ]/g,"\n").replace(/\[BSTQ]/g,"\t")}if(d){d=d.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"')}if(m){m=m.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"')}var e=getTinyBoxOptions(h,b,k,"",f,a);if(d){e.closejs=function(){};e.strclosejs=d}if(m){e.openjs=function(){};e.stropenjs=m}showTinyBoxWithOptions(e)}function refreshImpersonationControl(a,b){zoomout();if(b){ajaxAsyncCall("ImpersonationControlEx",["AddToObjectPicker",a,b],false,true)}}function callImpersonate(b){var a=getImpersonationControlValue(b);if(a){ajaxAsyncCall("ImpersonationControlEx",["Impersonate",a],false,true)}}function getImpersonationControlValue(a){return getElementByBizAPPId(a,"select").value}function callDeleteOnImpersonationControl(d,b){var a=getImpersonationControlValue(b);if(a){ajaxAsyncCall("ImpersonationControlEx",["DeleteSelectedValue",d,a],false,true)}}function callImpPrev(a){ajaxAsyncCall("ImpersonationControlEx",["SwitchToImpersonatingUser",a],false,true)}var g_hasSysAdminResp=false,g_hasAppAdminResp=false;function bza_BaseClickHandler(d){if(!d){d=window.event}closeCalendar(d);var e=getSourceElement(d);if(!e){return}e=$(e);if(e.hasClass("bza-pivot")){var f=e.attr("bza-pivotqid");if(f){BizAPP.UI.PivotTable.ShowPivotOptions(f)}}if(e.attr("bza-userid")&&!e.is("[readonly]")){position="bottom pright";if((window.innerWidth-d.target.getBoundingClientRect().left)<350){position="bottom pleft"}var a=$(d.target);BizAPP.UI.LoadView({url:"uiview.asmx?html.args=runtimeviewenterpriseid[NVS]ESystemaf9ec[PMS]runtimeobjectid[NVS]"+a.attr("bza-userid")+"&html.jar=true",selector:$("dummydiv"),menuPopupSelector:d.target,position:position})}var b=e.closest("tr").attr("rowid");if(b){BizAPP.UI.LoadView({url:"uiview.asmx?html.jar=true&html.args=runtimeobjectid[NVS]"+b,inlinePopup:true,showprocessing:true,callback:null})}}function bza_BaseDblClickHandler(a){if(!g_hasSysAdminResp){return}if(!a){a=window.event}var b=getSourceElement(a);if(!b){return}b=$(b);var d=b.attr("bizappresid");if(d){ajaxAsyncCall("HelperEx",["ObjectDrilldownCallback","","resource",d]);return}d=b.attr("bizapproid");if(d){ajaxAsyncCall("HelperEx",["ObjectDrilldownCallback","","",d,"displayName"]);return}if(g_enableLog&&!b.is("input, select")){BizAPP.UI.ShowDebugDetails(b)}}function callRefreshTree(a){ajaxAsyncCall("TreeEx",["RefreshTree",a],false,true)}function callApplyCSS(d,b,a){if(!d){d=getElementByBizAPPId(b)}if(d){d.className=a}}var elementId;function callMouseDown(b,a){elementId=getElementByBizAPPId(a,"div");if(b==null){b=window.event}if(elementId.style.left==""){pleft="0"}else{pleft=elementId.style.left}if(elementId.style.top==""){ptop="0"}else{ptop=elementId.style.top}pleft=parseInt(pleft);ptop=parseInt(ptop);xcoor=b.clientX;ycoor=b.clientY;document.onmousemove=callMouseMove;return false}function callMouseMove(a){if(a==null){a=window.event}elementId.style.left=pleft+a.clientX-xcoor+"px";elementId.style.top=ptop+a.clientY-ycoor+"px";return false}function callMouseUp(a){elementId=null;document.onmousemove=null}var popupElement;function callMouseDownOnPopup(b,a){popupElement=getElementByBizAPPId(b,"div");if(popupElement.style.display=="block"){popupElement.className=a;clicked=true}else{popupElement=null}}function callMouseUpOnpopup(a){if(clicked==true&&popupElement!=null){popupElement.className=a;clicked=false;popupElement=null}}function callMouseUpOnEnterprise(b,a){if(clicked==true&&popupElement!=null){popupElement.className=a;popupElement.style.left=b.clientX+"px";popupElement.style.top=b.clientY+"px";clicked=false;popupElement=null}}var resizeclick=false;var popupElementResize;function callMouseDownOnPopupResizing(a){popupElementResize=document.getElementById(a);if(popupElementResize.style.display=="block"){resizeclick=true}else{popupElement=null}}function callMouseUpOnpopupResizing(){if(resizeclick==true&&popupElementResize!=null){resizeclick=false;popupElementResize=null}}function callMouseUpOnEnterprisePopupResizing(b){if(resizeclick==true&&popupElementResize!=null){var a=getElementByBizAPPId("exceptionspopup","div");popupElementResize.style.width=b.clientX+"px";a.style.width=b.clientX-3+"px";resizeclick=false;popupElementResize=null}}function getLastResponse(a){var b=new Array();b[0]="GetLastResponse";b[1]=a;callOutlineWithProcessing(b)}function ResizeFileUploadControl(f,e,a){var d=document.getElementById(f);if(d){var b=document.getElementById(e);if(b){var h=b.getClientRects()[0];d.size=(a-((h.right-h.left)))/7.5;d.style.height="100%"}}}var g_SLFileUpload;function resizeSLAttachment(a){g_SLFileUpload=a}function callDerivedTemplate(viewId,templatePage,serializedContext){var height="300px";if(isIE6()){height="350px"}var selectedObjects=showDialogWithOptions(templatePage,height,"380px","no","no");if(selectedObjects!=null){if(isIE()){callRenderDerivedTemplateView(viewId,serializedContext,selectedObjects)}else{var eve="callRenderDerivedTemplateView( '"+viewId+"', '"+serializedContext+"', '"+selectedObjects+"')";try{eval(eve)}catch(Error){}}}}function callRenderDerivedTemplateView(a,d,b){var e=new Array();e[0]="RenderDerivedTemplateView";e[1]=d;e[2]=b;e[3]=bza_getSize(a);ajaxSyncCall("ViewEx",e)}function callDerivedObjectTemplates(a,e){var b=getDropdownListValue(e);var d=new Array();d[0]="DerivedObjectTemplates";d[1]=a;d[2]=b;ajaxAsyncCall("HelperEx",d,false,true)}function getDropdownListValue(a){var b=getElementByBizAPPId(a,"select");return b.value}function callApplyDerivedTemplate(e,a){var d=document.getElementById(a);var b=e+";"+d.value;closeWindow(b)}function callInvokeEOCCView(a){ajaxAsyncCall("ExtendedObjectControlEx",["EOCCView",a],false,true)}function callTimeSetFieldValue(a,b){ajaxAsyncCall("TimeControlEx",["TimeSetFieldValue",a,b,getDropdownListValue(b)],false,true)}function addNewObjectIdentifier(a){var b=getElementByBizAPPId("newobjectidentifier");if(b){b.innerHtml=a}}function nonAjaxCall(a,b,m,e){var d=window.parent.getElementByBizAPPId("postbackframe");var n=new Array();n[0]=a;n[1]=b;n[2]=m;n[3]=e;n[4]=getEnterpriseName();n[5]=getSessionId();nonAjaxRequests[nonAjaxRequests.length]=n;if(d!=null){if(enterpriseBody==null){enterpriseBody=getElementByBizAPPId("nonajaxform")}for(var h=0;h<nonAjaxRequests.length;h++){var f=new Array();f=nonAjaxRequests[h];var o="Responder.aspx?html.args="+f[0]+"[PMS]"+f[4]+"[PMS]"+f[5]+"[PMS]"+f[1]+"[PMS]"+serializeArgs(f[2]);createIframe(o,f[1])}if(nonAjaxRequests!=null&&nonAjaxRequests.length>0){try{nonAjaxRequests.clear()}catch(k){}}return d}}function serializeArgs(b){var a;for(var d=0;d<b.length;d++){if(a==null){a=(b[d]+"[PMS]")}else{a+=(b[d]+"[PMS]")}}return a}function createIframe(a,d){ifrm=document.createElement("IFRAME");ifrm.id=ifrm.bizappid="nonajaxmode_"+d;ifrm.setAttribute("src",a);ifrm.style.width=1+"px";ifrm.style.height=1+"px";ifrm.style.display="none";if(enterpriseBody==null){enterpriseBody=window.parent.getElementByBizAPPId("nonajaxform")}try{enterpriseBody.appendChild(ifrm)}catch(b){}}function removeIFrame(d){try{var b=window.parent.getElementByBizAPPId(d);if(enterpriseBody==null){enterpriseBody=window.parent.getElementByBizAPPId("nonajaxform")}enterpriseBody.removeChild(b)}catch(a){}}function responseCompleteHandler(){var a=new Array();a[0]=getElementByBizAPPId("status").innerHTML;a[1]=getElementByBizAPPId("html").innerHTML;a[2]=getElementByBizAPPId("events").innerHTML;a[3]=getElementByBizAPPId("exceptions").innerHTML;a[4]=getElementByBizAPPId("debugs").innerHTML;window.parent.responseHandlerForValue(a);removeIFrame(getElementByBizAPPId("status").parentNode.bizappid)}function responseHandlerForValue(o){ProcessingStatus(false,true);var n=0;var b=(new Date()).getTime();var h=o[0];var k=o[1];var p=o[2];var d=o[3];var q=o[4];var f=o[5];var a=true;if(!requestCancelled(f)){displayStatus(h);replaceHTML(k,a,function(){displayExceptions(d,q);fireEvents(p);displayDebugs(q)});if(k!=null){n=Math.floor(k.length/1024)}}IncrementRequestCount(-1);if(getActiveRequests()<=0){var e=getTotalRequestTime("__TR__");var m=(new Date()).getTime()-b;if(n>1){displayStatus("Server Response Time: "+e+" Seconds, Client Response Time : "+m/1000+" Seconds, Bytes Received: "+n+" KB")}else{displayStatus("Server Response Time: "+e+" Seconds, Client Response Time : "+m/1000+" Seconds")}}}function keepAlive(b,e){var d=getElementByBizAPPId("keepalive");if(d==null){d=document.createElement("IFRAME");d.setAttribute("BizAPPid","keepalive");d.style.height="0";d.style.width="0";d.style.display="none";var a=getElementByBizAPPId("ProcessingImage");if(a){a.appendChild(d)}}d.src=b;setTimeout("keepAlive ( '"+b+"', "+e+" );",e)}function ResizeImportControl(d,a){var b=document.getElementById(d);if(b){b.size=a/6.5;b.style.height="100%"}}function closeAllPopups(){for(var a=0;a<popUpControls.length;a++){var b=getElementByBizAPPId(popUpControls[a],"div");if(b){b.style.display="none"}}}function showpopup(f,b,a,e){closeAllPopups();b.cancelBubble=true;var d=getElementByBizAPPId(f,"div");if(d){if(d.style.display=="none"){d.style.display="Block"}else{d.style.display="none"}d.style.left=Math.min(b.clientX,document.documentElement.offsetWidth-a);d.style.top=e}}var menuarray=new Array();var openMenu;function showMenu(f,k,d,b,a){if(openMenu){var h=getElementByBizAPPId(openMenu);if(h){h.style.display="none"}}var e=getElementByBizAPPId(k);if(e){e.style.display="Block"}openMenu=k}var newImg;function zoomin(a,d,b){if(newImg){newImg.src=""}else{newImg=new Image()}newImg.src=a.getAttribute("src");if(isWebkit()){setTimeout('zoominHelper("'+b+'");',200)}else{zoominHelper(b)}}function zoominHelper(a){showTinyBox("",null,null,$(newImg).attr("src"))}function zoomout(){var a=BizAPP.UI.InlinePopup.getActivePopup(false);if(a){a.hide(null,true)}HandleCallbacks()}function HandleCallbacks(){if(popupCallBackElementId!=null&&popupCallBackElementId!=""){if(isPopupCalledBySilverlight){var b=document.getElementById(popupCallBackElementId);var a=b.children[0];popupCallBackElementId="";a.Content.CallBackHandler.HandleResponse("closed",popupCallBackElementDetails)}}}function getElementPosition(a){var b=curtop=0;if(a.offsetParent){do{if(a.style.overflow=="auto"&&a.scrollHeight>a.clientHeight){curtop-=a.scrollTop}b+=a.offsetLeft;curtop+=a.offsetTop}while(a=a.offsetParent)}return[b,curtop]}function filltime(f,t,z,e,d,a){if(!e&&e=="0"){return}var h=document.getElementById(f);e=parseInt(e);t=t=="true";z=z=="true";h.setAttribute("currentDate",d);var b=new Date();b.setHours(0,0,0,0);var m;var q;var v;var w="AM";var p="";var o=false;if(a=="00:00 AM"){addTimeEntry(h,p,true);o=true}while(b.getDate()==new Date().getDate()){m=b.getHours();q=b.getMinutes();v=b.getSeconds();var k,n,u;if(t&&m>12){m-=12;w="PM"}n=q<=9?"0"+q:q.toString();u=v<=9?"0"+v:v.toString();k=m<10?"0"+m:m.toString();if(t){if(m==12){w="PM"}v+=" "+w}if(z){p=k+":"+n+":"+u}else{p=k+":"+n+" "+w}if(!o){o=p==a;addTimeEntry(h,p,true)}else{addTimeEntry(h,p,false)}b.setMinutes(b.getMinutes()+e,0,0)}if(!o){addTimeEntry(h,a,true)}}function addTimeEntry(a,h,d,b){var e=document.createElement("OPTION");e.text=h;e.value=h;if(d==true){e.setAttribute("selected","selected")}try{a.add(e,b)}catch(f){a.appendChild(e)}}function callMapBizAPPFieldToActiveXProperty(b,o,k){var n=document.getElementById(o);if(n){var h="";var e=k.split(",");for(var d=0;d<e.length;d++){var f=e[d].split(":")[1];if(f){var m=e[d].split(":")[0]+":"+n[f];if(d!=e.length-1){m+=","}h+=m}}var a=new Array();a[0]="MapBizAPPFieldToActiveXProperty";a[1]=b;a[2]=h;ajaxAsyncCall("ActiveXControlEx",a,false,true)}}function callMapActiveXPropertyToBizAPPField(h,e){var a=document.getElementById(h);if(a){var d=e.split(",");for(var b=0;b<d.length;b++){var f=d[b].split(":")[1];if(f){a[f]=d[b].split(":")[0]}}}}function loadActiveXObject(b,f,e,d){var a=document.getElementById(b);if(a){a.innerHTML="";a.innerHTML=e;if(d){callMapActiveXPropertyToBizAPPField(f,d)}}}function initializeScrolling(a,f){if(!f){f="up"}var e=getElementByBizAPPId(a,"div");if(e){var b=e.clientHeight;var d=e.clientWidth;if(b==0){b=e.parentNode.clientHeight}if(d==0){d=e.parentNode.clientWidth}if(isIE()){e.outerHTML="<marquee behavior='scroll' width=\""+d+'px" height="'+b+"px\" direction='"+f+"' scrollamount='1' scrolldelay='50' onmouseover='this.stop()' onmouseout='this.start()'>"+e.outerHTML+"</marquee>"}else{e.parentNode.innerHTML="<marquee behavior='scroll' width=\""+d+'px" height="'+b+"px\" direction='"+f+"' scrollamount='1' scrolldelay='20' onmouseover='this.stop()' onmouseout='this.start()'>"+e.parentNode.innerHTML+"</marquee>"}var e=getElementByBizAPPId(a,"div");if(!isIE()){e.parentNode.start()}}}function setupSlider(b,a){setupPaging(b,a);showElement(0,b,a)}function showElement(d,b,a){$(b).hide();if(!$(b)[d]){d=0}$($(b)[d]).show("slow");$(a).children("ol").children("li").removeClass("current");$(a).children("ol").children('li[index="'+d+'"]').addClass("current");setTimeout("showElement("+(d+1)+',"'+b+'","'+a+'");',5000)}function setupPaging(d,b){var a=$(d).length;var f=document.createElement("ol");$(f).addClass("controls").appendTo($(b));for(var e=0;e<a;e++){$(document.createElement("li")).attr("index",e).html("<a>"+(e+1)+"</a>").click(function(){showElement($(this).attr("index"),d,b)}).appendTo($(f))}}var contextMenuObj;var MSIE=navigator.userAgent.indexOf("MSIE")?true:false;var navigatorVersion=navigator.appVersion.replace(/.*?MSIE (\d\.\d).*/g,"$1")/1;var activeContextMenuItem=false;function highlightContextMenuItem(){this.className="contextMenuHighlighted"}function deHighlightContextMenuItem(){this.className=""}function showContextMenu(b,d){contextMenuObj=d.parentNode.parentNode.parentNode.getElementsByTagName("UL")[0];contextMenuSource=this;if(activeContextMenuItem){activeContextMenuItem.className=""}if(!b){b=window.event}initContextMenu(d,b);var e=b.clientX;if(e+contextMenuObj.offsetWidth>(document.documentElement.offsetWidth-20)){e=e+(document.documentElement.offsetWidth-(e+contextMenuObj.offsetWidth))-20}var a=b.clientY;if(window.document.body.scrollTop>0){a=b.clientY+window.document.body.scrollTop-20}else{if(window.pageYOffset){a=(window.pageYOffset>0)?b.clientY+window.pageYOffset-20:b.clientY-20}else{a=b.clientY-20}}contextMenuObj.style.left=e+"px";contextMenuObj.style.top=a+"px";contextMenuObj.style.display="block";cancelBubble(b);return false}function hideContextMenu(a){if(contextMenuObj){if(document.all){a=event}if(a){if(a.button==0&&!MSIE){}else{contextMenuObj.style.display="none"}}else{contextMenuObj.style.display="none"}}document.oncontextmenu=""}function initContextMenu(f,b){contextMenuObj=f.parentNode.parentNode.parentNode.getElementsByTagName("UL")[0];contextMenuObj.setAttribute("roid",getAttributeValue(f,"roid"));contextMenuObj.style.display="block";var d=contextMenuObj.getElementsByTagName("LI");for(var n=0;n<d.length;n++){d[n].onmouseover=highlightContextMenuItem;d[n].onmouseout=deHighlightContextMenuItem;var k=d[n].getElementsByTagName("SPAN")[0];var h=d[n].getElementsByTagName("IMG")[0];if(h){var a=document.createElement("DIV");a.className="imageBox";a.appendChild(h);if(MSIE&&navigatorVersion<6){k.style.paddingLeft="0px"}var e=document.createElement("DIV");e.className="itemTxt";e.innerHTML=k.innerHTML;k.innerHTML="";k.appendChild(a);k.appendChild(e);if(MSIE&&navigatorVersion<6){a.style.position="absolute";a.style.left="2px";e.style.paddingLeft="15px"}if(!document.all){var m=document.createElement("DIV");m.style.clear="both";k.appendChild(m)}}else{if(MSIE&&navigatorVersion<6){k.style.paddingLeft="15px"}else{k.style.paddingLeft="30px"}}}contextMenuObj.style.display="none";document.documentElement.onclick=hideContextMenu}var g;function InitGanttChart(a,d,b){g=new JSGantt.GanttChart("g",getElementByBizAPPId(d),"week");try{JSGantt.XMLParse(g,a)}catch(e){}g.Draw();g.DrawDependencies();if(b){fireEvents(b)}}function changeGanttFormat(a){if(g){g.setFormat(a.value);g.DrawDependencies()}else{displayMessage("Chart undefined")}}function handleEnterpriseToolBar(b,a){callEnterpriseToolBar(["HandleEnterpriseToolbar",b,a])}function handleEnterpriseLinkCollection(d,a,b){callEnterpriseToolBar(["HandleEnterpriseToolbar",d,a,b])}function callEnterpriseToolBar(a){ajaxAsyncCall("EnterpriseToolBarEx",a,false,true)}function CloseAllPopups(){callClosePopUp("viewgrouppopup");callClosePopUp("viewpopup")}function positionContainer(d,h){if(d==null){d=window.event}var e=document.getElementById(h);if(e){var b;var f;if(d){b=d.clientX;f=d.clientY;var a=getElementPosition(getSourceElement(d));if(a){f=a[1]}if((document.documentElement.offsetWidth-d.clientX)<100){b=document.documentElement.offsetWidth-100}if((document.documentElement.offsetHeight-f)<230){f=document.documentElement.offsetHeight-230}}else{b=document.documentElement.offsetWidth/2-195;f=document.documentElement.offsetHeight/2-144}e.style.top=f+"px"}}function callOpenPopUp(a){var b=getElementByBizAPPId(a,"div");if(b){b.style.display="block"}}function checkIfTouchScreen(){return false}var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return(isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows())}};function CheckSilverlightVersion(){var f=navigator.plugins["Silverlight Plug-In"];if(f){return f.description}else{try{var d=new ActiveXObject("AgControl.AgControl");var a=Array(1,0,0,0);loopMatch(d,a,0,1);loopMatch(d,a,1,1);loopMatch(d,a,2,10000);loopMatch(d,a,2,1000);loopMatch(d,a,2,100);loopMatch(d,a,2,10);loopMatch(d,a,2,1);loopMatch(d,a,3,1);return a[0]+"."+a[1]+"."+a[2]+"."+a[3]}catch(b){}}}function loopMatch(e,b,a,d){while(IsSupported(e,b)){b[a]+=d}b[a]-=d}function IsSupported(b,a){return b.isVersionSupported(a[0]+"."+a[1]+"."+a[2]+"."+a[3])}function evalJS(func){eval(func)}function fireScreenChange(e,d){var b=getElementByBizAPPId(e,"DIV",false);if(b){var a=b.getElementsByTagName("SELECT")[0];if(a){a.value=d;a.onchange()}}}function fireViewCollectionChange(m,k){var d=getElementByBizAPPId(m);var f=getFirstElementByAttributeValue(d,"TABLE","class","screentable");if(f){var b=f.getElementsByTagName("TD");var h=b.length;for(var e=0;e<h;e++){var a=b[e];if(getAttributeValue(a,"onclick").toString().indexOf(k)>0){sltTab(a);break}}}}function callPivotTable(h,f,m){var k=getSourceElement(f);if(k.tagName.toLowerCase()=="td"){if(k.cellIndex===0){return}var e=k.parentNode.cells[0].innerHTML;var d=k.parentNode.parentNode.parentNode.rows[0].cells[k.cellIndex].innerHTML;ajaxAsyncCall("PivotTableEx",["PivotTableClickHandler",m,e,d],false,true)}}function initializeMenu(n,f){var b=document.getElementById(n);if(b){var d=getBizAppElementsByClassName(b,"DIV","m-c");if(d.length>0){$(b).addClass("m-dummy")}if((isIE()&&b.currentStyle)||f){if(!f&&d.length==0){b.style.position="relative"}var e=b.getElementsByTagName("LI");var m=e.length;for(i=0;i<m;i++){try{var h=e[i];if(h.lastChild.tagName=="UL"){if(f){h.onclick=showHideMenu}else{h.onmouseover=menuMouseOver;h.onmouseout=menuMouseOut}}}catch(k){}}}}}var g_activeMenu;function showHideMenu(b){if(!b){b=window.event||arguments[0]}if(g_activeMenu&&$(g_activeMenu.lastChild).is(":visible")){var a=isIE()?this.uniqueID!=g_activeMenu.uniqueID:this!=g_activeMenu;if(a){$(g_activeMenu.lastChild).hide();g_activeMenu=null}}if(this&&this.lastChild&&this.lastChild.tagName=="UL"&&!$(this.lastChild).is(":visible")){g_activeMenu=this;$(g_activeMenu.lastChild).show();cancelBubble(b);return false}}function menuMouseOver(){this.lastChild.style.display="block"}function menuMouseOut(){this.lastChild.style.display="none"}var g_editableGrids=new Dictionary();function commitEditableGrids(){var b=true;for(var h=0;h<g_editableGrids.Keys.length&&b!=false;h++){var f=g_editableGrids.Keys[h];var a=g_editableGrids.Lookup(f);var e=getElementByBizAPPId(a);if(e&&getBizAppElementsByClassName(e,"DIV","gCancel").length>0){if(isIE()){var d=getBizAppElementsByClassName(e,"DIV","gCommit")[0].onclick.toString().split("'")[1]}else{d=getBizAppElementsByClassName(e,"DIV","gCommit")[0].onclick.toString().split(",")[1];if(d.indexOf('"')!=-1){d=d.split('"')[1]}else{d=d.split("'")[1]}}if(callCommitRefresh(null,d,a,false)!=true){b=false}}}return b}function checkifEditable(){for(var e=0;e<g_editableGrids.Keys.length;e++){var d=g_editableGrids.Keys[e];var b=getElementByBizAPPId(g_editableGrids.Lookup(d));var a=new Array();if(b&&getBizAppElementsByClassName(b,"DIV","gCancel").length>0){a.push(d)}}return a}function Lookup(a){return(this[a])}function clear(){this.Keys=new Array()}function Delete(){for(c=0;c<Delete.arguments.length;c++){this[Delete.arguments[c]]=null}var b=new Array();for(var a=0;a<this.Keys.length;a++){if(this[this.Keys[a]]!=null){b[b.length]=this.Keys[a]}}this.Keys=b}function Add(){for(c=0;c<Add.arguments.length;c+=2){this[Add.arguments[c]]=Add.arguments[c+1];this.Keys[this.Keys.length]=Add.arguments[c]}}function Dictionary(){this.clear=clear;this.Add=Add;this.Lookup=Lookup;this.Delete=Delete;this.Keys=new Array()}function bza_frmProps(k,d,h){var f;if(d){f=$(getElementByBizAPPId(k));var b=f.find("input:visible,select:visible").not("[readonly]");if(b.length>0){b[0].select()}}if(h){if(!f){f=$(getElementByBizAPPId(k))}var e=f.find("formgroupbox");e.each(function(){if(!this.hasAttribute("tabprocessed")){var a=$(this).find("textarea:visible,input:visible,select:visible");a.sort(function(o,n){var p=parseInt($(o).css("top")),m=parseInt($(n).css("top"));if(p==m){p=parseInt($(o).css("left")),m=parseInt($(n).css("left"));return p-m}else{return p-m}});a.detach().appendTo($(this));$(this).attr("tabprocessed","true")}})}}function handleRemoveTabbedDocument(a){callTabbedDoc(["HandleRemoveTabbedDocument",a])}function handleRemoveAllTabbedDocuments(a){callTabbedDoc(["HandleRemoveAllTabbedDocuments",a])}function callTabbedDoc(a){ajaxAsyncCall("TabbedDocumentEx",a,false,true)}function showImportOpts(b,a){BizAPP.UI.Grid.ShowImportExportPopup(b,a)}function showImport(b,a){showDialogDQ(b,a,400,750)}function handleInlinePopupImport(e,d,a,b){callImport(["HandleInlinePopupImport",d,a,b])}function displayImportTemplate(e,f,d,a,b){callImport(["DisplayImportTemplate",d,a,b])}function handleImportTemplate(f,k,e,b,d){var h=getSourceElement(f);var a=$(h).closest("[mode]").attr("mode");callImport(["HandleImportTemplate",e,b,d,a]);zoomout()}function callImport(a){ajaxAsyncCall("ImportEx",a,false,true)}function showColumnMapPopup(b,a){zoomout();showDialogDQ(b,a,200,700)}function mapActions(a){a.cancelBubble=true;var b=getSourceElement(a);if(b){if(b.className=="edtMap"){editMap(b)}else{if(b.className=="saveMap"){saveMap(b)}else{if(b.className=="canMap"){canMap(b)}else{if(b.className=="ignoreMap"){ignoreMap(b)}}}}}}function canMap(b){var a=$(b).parent();a.children(".headerMap").show();a.children(".edtMap").show();a.children(".ignoreMap").show();a.children(".saveMap").hide();a.children(".canMap").hide();a.children("select").hide();highLightCell(a[0],false)}function editMap(a){$("#mapTable").find("th").each(function(){canMap($(this).children(".canMap")[0])});var d=$(a).parent();highLightCell(d[0],true);d.removeAttr("ignore");d.removeClass("ignore");d.children(".headerMap").hide();d.children(".edtMap").hide();d.children(".ignoreMap").hide();d.children(".saveMap").show();d.children(".canMap").show();var k=d.closest("table").attr("fields");k=k.split("[VS]");k.unshift("");var f=d.children(".headerMap").html();if(d.children("select").length==0){var n=document.createElement("select");for(var e=0;e<k.length;e++){var h=document.createElement("option");h.value=h.text=k[e];if(f==h.value){h.selected=true}try{n.add(h,null)}catch(m){n.add(h)}}$(a).after($(n))}else{var b=d.children("select");b.val(f);b.show()}d.children("select")[0].scrollIntoView()}function saveMap(e){var a=$(e).parent();canMap(e);if(!a.attr("originalVal")){a.attr("originalVal",a.children(".headerMap").html())}var d=a.children("select").val();if(d){a.addClass("bza-col-map");a.children(".headerMap").html(a.children("select").val())}var b=a.next();if(b&&b.length>0){editMap(b.children(".edtMap")[0])}}function ignoreMap(b){var a=$(b).parent();a.attr("ignore","ignore");a.addClass("ignore");if(!a.attr("originalVal")){a.attr("originalVal",a.children(".headerMap").html())}}function getMapInfo(b){var a="",d="";$("#mapTable").find("th").each(function(){var e=$(this).attr("originalVal");if($(this).attr("ignore")){d+=e+"[VS]"}else{if(e){var f=$(this).children(".headerMap").html();if(e!=f){a+=e+"[NVS]"+f+"[PMS]"}}}});callImport(["ImportWithMapInfo",b,a,d])}function highLightCell(a,b){$("#mapTable").find("th").each(function(){$(this).removeClass("active")});if(b){$(a).addClass("active")}}function importWizardLoad(){var a=$("#hfCurrentStep").val();if(a){a--}else{a=0}$("#pnlImportWizard").smartWizard({transitionEffect:"slideleft",enableFinishButton:true,onLeaveStep:importLeaveStepCallback,onShowStep:importShowStepCallback,onFinish:importFinishCallback,selected:a});setTimeout("$('#pnlImportWizard').smartWizard('reinit', { stepNum: "+a+" });",500)}function importShowStepCallback(b){var a=b.attr("rel");$("#hfCurrentStep").val(a);if(a==2){if($("#hfMode").val()=="upload"){$("#paste").hide();$("#Load").show()}else{$("#Load").hide();$("#paste").show()}}}function importLeaveStepCallback(d){var a=d.attr("rel");var b=validateSteps(a);if(b){$("#pnlImportWizard").smartWizard("hideMessage");if(a==1){if($("#hfMode").val()=="upload"){$("#paste").hide();$("#Load").show()}else{$("#Load").hide();$("#paste").show()}}else{if(a==2){if($("#hfMode").val()!="upload"){callImport(["LoadExcelContent",getQSParamByName("html.args"),getQSParamByName("gridhashcode"),getQSParamByName("gridctrlname"),$("#excelTxt").val(),$("#tbCPDelimiter").val()])}else{$("#btnUpload").click()}}}}return b}function importFinishCallback(){if(validateAllSteps()){getMapInfo(importCopyExcelContext)}}function validateAllSteps(){return true;var a;a=validateStep1();if(a.isValid){a=validateStep2()}if(a.isValid){a=validateStep3()}if(!a.isValid){$("#pnlImportWizard").smartWizard("showMessage","Please correct the errors in the steps and continue")}return a.isValid}function validateSteps(b){var a;if(b==1){a=validateStep1()}else{if(b==2){a=validateStep2()}else{if(b==3){a=validateStep3()}}}if(!a.isValid){$("#pnlImportWizard").smartWizard("showMessage",a.msg)}$("#pnlImportWizard").smartWizard("setError",{stepnum:b,iserror:!a.isValid});return a.isValid}function validateStep1(){var a=true,b;if(!$("#hfMode").val()){a=false;b="Choose an option to continue."}return{isValid:a,msg:b}}function validateStep2(){var b=true,e;var a=$("#excelTxt").val();var d=$("#hfMode").val();if(d!="upload"&&!a&&a.length<=0){b=false;e="Copy/Paste content from an excel file."}else{if(d=="upload"&&$("#CSVFileUpoad").val().length<=0){b=false;e="Please select a file to upload."}}return{isValid:b,msg:e}}function validateStep3(){return{isValid:true,msg:""}}function callRefreshControl(m,f,n,b){try{var a=$("[type=checkbox][bizappid~="+f+"]");if(a.length>0){for(var d=0;d<a.length;d++){if(a[d].checked){return}}}}catch(k){addLog("",k)}var h=getElementByBizAPPId(f);if(h){ajaxAsyncCall("HelperEx",["RefreshControl",m,n],false,false)}}function OpenModalDialog(k,f,m,h,d,e,b){if(!window.showModalDialog){window.showModalDialog=function(){alert("Browser does not support popup's, use inline popup's instead.")}}var a;a=window.showModalDialog(k,window,GetDialogFeatures(m,f,e,b));return a}function ShowProcessConfiguration(e,h,m,d,k,f,b){var a;a=window.showModalDialog(h,window,GetDialogFeatures(k,d,true));return a}function GetDialogFeatures(e,h,a,k){var n="center:yes;dialogWidth: "+e+"px;dialogHeight: "+h+"px;status: no;unadorned: yes;scroll:"+k+";help: no;"+(a?"resizable: yes;":"");if(isFirefox()){var b=$(document).width();var m=window.screen.availHeight;var e=e.replace("px","");var h=h.replace("px","");var f=(b-e)/2;var d=(m-h)/2;n+="dialogLeft: "+f+"; ";n+="dialogTop: "+d+"; "}return n}var g_appBasePath,g_ajaxRequests=0,g_callBack,g_readOnly,g_callBacks=[],g_headers;var __readonlyajaxcalls=new Object();function customAjaxCall(f,m,h,a,e,k,d,b){if(BizAPP.UI._promptEditLoss()){BizAPP.UI.InlinePopup.Confirm({message:"You have data that has not yet been saved. Do you still want to continue?",type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}customAjaxCall1(f,m,h,a,e,k,d,b)},fnCancelCallback:function(){ProcessingStatus(false,true)}})}else{return customAjaxCall1(f,m,h,a,e,k,d,b)}}function customAjaxCall1(b,q,n,m,f,t,h,k){if(q==undefined){q=""}if(n==undefined){n=""}if(g_appBasePath&&!g_appBasePath.endsWith("/")){g_appBasePath=g_appBasePath+"/"}var p,e,u,d;if(g_useJSONForCustomAjax){p=k?"silverlightdataaccess.asmx/JSONBatchCall":"silverlightdataaccess.asmx/jsonajaxcall";if(g_appBasePath){p=g_appBasePath+p}e=JSON.stringify({type:b,enterpriseName:q,sessionId:n,args:m,id:f});if(g_enableLog){p+="?"+f}d={async:t==undefined?true:t,contentType:"application/json; charset=utf-8",type:"POST",url:p,data:e,dataType:"text",success:t?customAjaxAsyncSuccess:function(v,w,a){u=customAjaxSyncSuccess(v,w,a)},error:customAjaxFailed,context:{callback:h}}}else{p="SilverlightDataAccess.asmx/AjaxCall";if(g_appBasePath){p=g_appBasePath+p}e="type="+b+"&enterpriseName="+q+"&sessionId="+n+"&args="+m.join("[BAS]")+"&id="+f;d={async:t==undefined?true:t,type:"POST",url:p,data:e,success:t?customAjaxAsyncSuccess:function(v,w,a){u=customAjaxSyncSuccess(v,w,a)},error:customAjaxFailed,context:{callback:h}}}if(BizAPP.UI.currentApplication){if(!g_headers){g_headers="{currentApplication: '"+BizAPP.UI.currentApplication+"'}"}else{var o=JSON.parse(g_headers);o.currentApplication=BizAPP.UI.currentApplication;g_headers=JSON.stringify(o)}}d.beforeSend=function(w){if((m&&$.inArray(m[0],__readonlyajaxcalls[b])!=-1)||g_readOnly){g_readOnly=false;w.setRequestHeader("X-Bza-Type","read-only")}if(g_headers){var v=g_headers;w.setRequestHeader("Bza-Options",v);g_headers=""}};if(g_callBack){d.context.requestCallback=g_callBack;g_callBack=null}if(g_callBacks.length){d.context.requestCallBacks=g_callBacks;g_callBacks=[]}makeAjaxCall(d);return u}function makeAjaxCall(a){makeAjaxCall1(a)}function makeAjaxCall1(a){g_ajaxRequests++;$.ajax(a)}function xmlAjaxCall(a){var b;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}b.open(a.type,a.url,a.async);b.setRequestHeader("Content-type",a.contentType||"application/x-www-form-urlencoded");b.onreadystatechange=function(d){if(b.readyState==4){if(b.status==200){a.success(b.response,b.statusText,b)}else{a.error(b.response,b.statusText,b)}}};b.send(a.data)}function customAjaxFailed(b,d,a){if(g_ajaxRequests>0){g_ajaxRequests--}BizAPP.UI._handleFailedResponse(b,d,a)}function customAjaxAsyncSuccess(d,f,b){var a=customAjaxSyncSuccess(d,f,b);if((f=="success"||f=="OK")&&typeof this.callback=="undefined"&&(typeof this.context=="undefined"||typeof this.context.callback=="undefined")){responseHandler(a)}else{if(typeof this.context=="undefined"){this.callback(a,f,b)}else{this.context.callback(a,f,b)}}if(typeof(this.requestCallback)!="undefined"){try{this.requestCallback(a,f,b)}catch(e){logError("request call back failed.",e)}}BizAPP.UI.ProcessCallBacks(this.requestCallBacks,a,f,b);return false}function customAjaxSyncSuccess(f,h,d){if(g_ajaxRequests>0){g_ajaxRequests--}if(h=="success"||h=="OK"){var a;var b;var e;if(g_useJSONForCustomAjax){b=f;f=JSON.parse(f);e=f.d||f}else{b=f;if(isIE()){e=f.text.split("[BACS]")}else{e=f.childNodes[0].textContent.split("[BACS]")}}a={value:e,json:b};$.ajax.mostRecentCall=d;return a}else{customAjaxFailed(d,h,f)}}function outlineAjaxCall(a){ajaxEntryCall("OutlineEx",a,false,false)}function ajaxSyncCall(b,a){return ajaxEntryCall(b,a,true)}function ajaxSyncCallAndNoResponseHandler(b,a){return ajaxEntryCall(b,a,false,true)}function ajaxEntryCall(e,b,f,d){fireRichTextSave(true);if(enableAjax){addLog("\nSychronous Call : "+e+"  Method Name : <b>"+b[0]+"</b>");if(g_customAjax==true){var a=customAjaxCall(e,getEnterpriseName(),getSessionId(),b,getNextRequestId(),false)}else{a=BizAPP.Web.UI.View.Control.HelperEx.AjaxCall(e,getEnterpriseName(),getSessionId(),b,getNextRequestId())}if(f){responseHandler(a)}else{if(d){displayExceptions(a.value[3],a.value[4])}}return a}else{ajaxAsyncCall(e,b,false,true)}}function ajaxAsyncCall(b,a){ajaxAsyncCall(b,a,true)}function ajaxAsyncCall(d,b,e,a){if(g_forceSyncCalls){ajaxSyncCall(d,b);return}if(!e||g_customAjax){realAjaxAsyncCall(d,getNextRequestId(),b,a)}else{if(!callServer){callServer=true;sourceObj=d;ajaxArgs=b;setTimeout(ajaxCallBack,0);sourceId=getNextRequestId()}}}function ajaxCallBack(){callServer=false;realAjaxAsyncCall(sourceObj,sourceId,ajaxArgs,true)}function realAjaxAsyncCall(h,k,d,b,f,e){ProcessingStatus(true,b);fireRichTextSave(false);if(!enableAjax){nonAjaxCall(h,k,d,b)}else{IncrementRequestCount(1);addLog("\nAsychronous Call : "+h+"  Method Name : "+d[0]+", Request ID :"+k);var a=new Date();setSessionValue("__TR1__",a.getTime());if(g_customAjax==true){customAjaxCall(h,getEnterpriseName(),getSessionId(),d,getNextRequestId(),true,f,e)}else{BizAPP.Web.UI.View.Control.HelperEx.AjaxCall(h,getEnterpriseName(),getSessionId(),d,k,f)}}}var g_enableRichTextSave=true;function fireRichTextSave(b){if(g_isChatRefreshCall||!g_enableRichTextSave){return}setupReauthTimer();var a=$(".RichTextEx[chc]");if(a.length>0){g_enableRichTextSave=false;a.each(function(){if(this.className!="RichTextEx"){return}var d,h;var e=$(this).attr("bizappid");if(!e){e=$(this).attr("id");h=$("#"+e+" > tbody > tr > td > iframe")}else{h=$('[bizappid="'+e+'"] > tbody > tr > td > iframe')}if(h.attr("src").indexOf("igrt")>-1){return}d=h.contents().find("#RichText_htmlEditorArea").children().val();var k=$(this).attr("chc");var f=["SetFieldValue",k,d];if(b){ajaxSyncCall("OutlineEx",f)}else{ajaxAsyncCall("OutlineEx",f,false,false)}});g_enableRichTextSave=true}}function cleanupAppCss(){cleanupCss("appcss")}function cleanupCss(a){$("head > link."+a).remove()}function loadjscssfile(d,e){if(e=="js"){var b=$('script[src="'+d+'"]').length>0;if(!b){var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src",d)}}else{var h=document.createElement("link");h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");h.setAttribute("href",d);if(e!=="css"){h.setAttribute("class",e)}}if(typeof h!="undefined"){var a="head";if(e=="js"){a="body"}var f=document.getElementsByTagName(a)[0];f.appendChild(h)}}function insertScript(b,a){loadjscssfile(a,"js")}function showHelpClick(a){ajaxAsyncCall("ViewEx",["HandleShowHelp",a],false,true)}function showHelpContent(b,a){a='<div class="viewHelp">'+a+"</div>";showPopup(b,a,null,null,true,false)}function updateProcessStatus(a){if(a!=""){if(isIE()){a=a.replace(/\r\n/g,"<br/>")}var b=document.createElement("div");$(b).html(a);$("#AsyncStatus").append(b);b.scrollIntoView()}}function showProcessStatus(b,a){if(b==""){b="Task Name"}if(a==""){a="Processing..."}var d='<div style="width: 100%;text-align:center;"><h3>'+b+'</h3> <img id="AsyncProcessing" alt="Processing..." src="resources/images/jobprocessing.gif" style="margin:20px;"><br/><pre class="asyncStatus" style="height:'+(document.body.clientHeight-250)+'px;" id="AsyncStatus" value="'+a+'"></pre></div>';showPopup("",d,document.body.clientHeight-100,document.body.clientWidth-200,true,false)}var AsyncTaskStatus=false;function callAsyncHandler(a){if(AsyncTaskStatus==false){setTimeout("callAsyncHandler( '"+a+"' );",2000);var b=new Array();b[0]="AsyncTaskCallBack";b[1]=a;ajaxAsyncCall("OutlineEx",b,false,false)}else{$("#AsyncStatus").html($("#AsyncStatus").html()+"\r\nComplete.");$("#AsyncProcessing").replaceWith("<h4>Complete</h4>");AsyncTaskStatus=true}}function imageClick(a){var b=getAttributeValue(a,"uploader");if(b!=""&&b!=undefined&&b!=NaN){showPopup("Upload Image",b,100,350,true,true)}}function showRTE(b){var a=getWindowSize();ajaxAsyncCall("RichTextEx",["ShowRTE",b,Math.round(a.height*0.7).toString(),Math.round(a.width*0.8).toString()],true,true)}function getWindowSize(){var a=630,b=460;if(document.body&&document.body.offsetWidth){a=document.body.offsetWidth;b=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){a=document.documentElement.offsetWidth;b=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){a=window.innerWidth;b=window.innerHeight}return size={height:b,width:a}}function showConfigurationPopup(k,m,d,a,f,n,b,h,e){showPopup(k,m,d,a,f,n);isPopupCalledBySilverlight=b;popupCallBackElementId=h;popupCallBackElementDetails=e}var g_activeTINYPopup;function showTinyBoxWithOptions(a){BizAPP.UI.InlinePopup.CreateNew(a)}function showTinyBox(d,b,k,a,h,f){var e=getTinyBoxOptions(d,b,k,a,h);e.stropenjs=f;showTinyBoxWithOptions(e)}function getTinyBoxOptions(e,d,k,b,h,a){var f;if(b){f={image:$(newImg).attr("src")}}else{f={html:e,height:0,width:0};if(d){f.height=d}if(k){f.width=k}}f.hideClose=a;f.bSearch=h;return f}function showPopup(b,h,a,m,f,k,e,d){showTinyBox(h,a,m,"",e,d)}function textBoxFocus(b){if(!b){b=this}var a=$(b).attr("placeholder");if(b.value==a){b.value="";b.className="formtextbox"}}function textBoxBlur(b){if(!b){b=this}if(b.value==""){var a=$(b).attr("placeholder");b.value=a;b.className="formwatermarkedtextbox"}else{b.className="formtextbox"}}function displayPromoteTemplate(b,a){if(b==null){b=window.event}var d=new Array();d[0]="DisplayPromoteTemplate";d[1]=a;callServerPromote(b,d,"steppopupcontainer")}function handlePromote(d,a){if(d==null){d=window.event}callClosePopUp("steppopupcontainer");var f=new Array();f[0]="ApplyPromoteStep";f[1]=a;f[2]="";var e=document.getElementsByName("PromoteItemTemplate");if(e){for(var b=0;b<e.length;b++){if(e[b].checked){f[2]=e[b].id;break}}}callOutline(f)}function callServerPromote(e,f,d){var b;var k;if(e){b=e.clientX;k=e.clientY;var a=getElementPosition(getSourceElement(e));if(a){k=a[1]}if((document.documentElement.offsetWidth-e.clientX)<440){b=document.documentElement.offsetWidth-440}if((document.documentElement.offsetHeight-k)<140){k=document.documentElement.offsetHeight-140}}else{b=document.documentElement.offsetWidth/2-195;k=document.documentElement.offsetHeight/2-144}var h=getElementByBizAPPId(d,"div");if(h){h.style.display="block";h.style.left=b+"px";h.style.top=k+"px";callOutline(f)}}function callShowObjectWithTag(e,b){var a=e.value;if(a){var d=new Array();d[0]="ShowObjectWithTag";d[1]=b;d[2]=a;callOutline(d)}}function callAddRemoveTag(b,a,e){if(roid&&roid!=""&&roid!=undefined&&roid!=NaN){var d=new Array();d[0]="AddRemoveTag";d[1]=roid;d[2]=e.toString();d[3]=b.previousSibling.value;callOutline(d)}}function toggleTag(a){var b=document.getElementById(a);$(b).slideToggle("fast");if(b.style.display=="block"){b.style.display="table"}}function callRecentViewContextMenu(b,k,d,a,f){if(!isIE()){return}if(b==null){b=window.event}var n;var m;if(b){n=b.clientX;m=b.clientY;var h=getElementPosition(getSourceElement(b));if(h){m=h[1]}if((document.documentElement.offsetWidth-b.clientX)<440){n=document.documentElement.offsetWidth-440}if((document.documentElement.offsetHeight-m)<140){m=document.documentElement.offsetHeight-140}}else{n=document.documentElement.offsetWidth/2-195;m=document.documentElement.offsetHeight/2-144}var e=new Array();e[0]="RecentViewContextMenu";e[1]=k;e[2]=d;e[3]=a;e[4]=f;e[5]=m+"px";e[6]=n+"px";callRecentViewCollection(e)}function callCopyRecentViewlinkToClipBoard(b,h,d,a,f){var k=b;var n="?html.args=";var e="&html.viewcontrolname=";var m="&html.chc=";if(d&&d!=undefined&&d!=""){n+="runtimeobjectid[NVS]"+d}if(a&&a!=undefined&&a!=""){if(n!="?html.args="){n+="[PMS]"}n+="runtimeviewenterpriseid[NVS]"+a}if(h&&h!=undefined&&h!=""){e+=h}if(f&&f!=undefined&&f!=""){m+=f}k+=n;if(e!="&html.viewcontrolname="){k+=e}if(m!="&html.chc="){k+=m}callClosePopUp("recentviewpopup")}function initFavDel(a){$(".gRemovePQ[fid]").click(function(b){if(!b){b=window.event}if(b){var f=getSourceElement(b);if(f){var e=$(f).attr("fid");var d=new Array();d[0]="RemoveFavourite";d[1]=a;d[2]=e;ajaxAsyncCall("FavouriteBarControlEx",d,true,true)}}})}function callShowFavDialog(b,a,d){setForceFocus("forcefocus",b);a=a+"?html.args="+d;showDialogWithOptions(a,40+"px",180+"px","no","no")}var g_chatWindows=new Dictionary();function openChatWindow(d,a){var b=window.open(d,"",a,"");g_chatWindows.Add(d,b)}function closeAllChatWindows(){var d=g_chatWindows.Keys.length;for(var b=0;b<d;b++){var a=g_chatWindows.Keys[b];g_chatWindows[a].close()}}function refreshCallBack(a){setTimeout('refreshColl("'+a+'", true);',30000)}var g_isChatRefreshCall=false;function refreshColl(b,a){}var g_dkTitle,g_dkBody;var g_dkHtmlNotification;function RequestPermission(a){if(window.webkitNotifications){window.webkitNotifications.requestPermission(a)}}function showDesktopNotification(a,b){g_dkTitle=a;g_dkBody=b;notification()}function notification(){if(!window.webkitNotifications){return}if(window.webkitNotifications.checkPermission()>0){RequestPermission(notification)}var d="bizapp.ico";var e=g_dkTitle;var a=g_dkBody;var b=window.webkitNotifications.createNotification(d,e,a);b.show();setTimeout(function(){b.cancel()},"15000")}function HTMLnotification(){if(!g_dkHtmlNotification){return}if(!window.webkitNotifications){return}if(window.webkitNotifications.checkPermission()>0){RequestPermission(HTMLnotification)}var a=window.webkitNotifications.createHTMLNotification(g_dkHtmlNotification);a.show();setTimeout(function(){a.cancel()},"15000")}function showContacts(b){var a=["ShowContacts",b];ajaxAsyncCall("CollaborationEx",a)}function updateConversation(b){if(!b){return}var a=$("#messages");a.append(b);a[0].scrollTop=a[0].scrollHeight}function updateParticipants(f){document.title=f;var d="";var e=f.split(",");for(var b=0;b<e.length;b++){var a=e[b];if(a){if(b==0){a="<b>"+a+"</b>"}d+='<div><span class="available">'+a+"</span></div>"}}$("#participants").html(d)}function refreshConversation(a,b){if(isFirefox()){$("#messages").css("height","225px")}setTimeout('realRefreshConversation("'+a+'", "'+b+'");',5000)}function realRefreshConversation(a,d){var b=["RefreshConversation",a,d];result=ajaxSyncCall("CollaborationEx",b,false,false);refreshConversation(a,d)}function startConv(a,d){if(a&&d){var b=["StartConversation",a,d];ajaxAsyncCall("CollaborationEx",b,true,true)}}function sendMsg(a){if(!a){a=window.event}if(a.keyCode!=13){return}if(a){var b=getSourceElement(a);realSendMsg(b)}return false}function realSendMsg(b){if(b&&b.value){var a=["SendMessage",getQSParamByName("s"),getQSParamByName("c"),b.value];ajaxAsyncCall("CollaborationEx",a);b.value=""}}function saveConv(){var a=getQSParamByName("c");if(a){var d=$("#messages").html();if(d){var b=["SaveConversation",a,d];ajaxAsyncCall("CollaborationEx",b)}}}function addParticipants(){var a=["AddParticipants",getQSParamByName("s"),getQSParamByName("c")];ajaxAsyncCall("CollaborationEx",a)}function addConvParts(a,e,d){if(a&&e&&d){var b=["AddParticipantsToConversation",a,e,d];ajaxAsyncCall("CollaborationEx",b,true,true)}}function updateConvParts(a,e,d){if(a&&d){var b=["UpdateConversationParticipants",a,e,d];ajaxAsyncCall("CollaborationEx",b,true,true)}}function getQSParamByName(d,b){if(!b){b=window.location.href}d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+d+"=([^&#]*)";var f=new RegExp(a);var e=f.exec(b);if(e==null){return""}else{return decodeURIComponent(e[1].replace(/\+/g," "))}}function confirmConversationExit(){var a=["LeaveConversation",getQSParamByName("s"),getQSParamByName("c")];ajaxSyncCallAndNoResponseHandler("CollaborationEx",a);window.close()}function leaveConv(){var a=["LeaveConversation",getQSParamByName("s"),getQSParamByName("c")];ajaxSyncCall("CollaborationEx",a)}function delContacts(a,d,b){if(d&&b){var e=getCheckBoxSelection(b);if(!e){return}if(!confirm(a)){return}ajaxSyncCall("CollaborationEx",["RemoveContacts",d,e]);callRefresh(d,b)}}function customizeView(a){a='<iframe src="viewcustomizer.aspx?chc='+a+'" height="99%" width="99%"/>';showPopup("",a,document.body.clientHeight-150,document.body.clientWidth-300,true,false)}function removeCustView(b){var a;if(a){ajaxAsyncCall("ViewCustomizerEx",["RemoveCustomizedView",b,src.getAttribute("cid")],true,true)}}function changeCustView(b,a){var d=getSourceElement(a);g_currentView=d.value;ajaxAsyncCall("ViewCustomizerEx",["ChangePersonalisedView",b,g_currentView],true,true)}var g_currentView;function removeCustView(b,a){if(g_currentView){ajaxAsyncCall("ViewCustomizerEx",["RemovePersonalisedView",b,g_currentView],true,true)}}function togglemAct(d){var b=$(d).next();if(b.css("display")=="none"){b.css("display","inline-block");if(b.width()<d.clientWidth){b.width(d.clientWidth);b.children().width(d.clientWidth)}if(isIE()){b.css("background","#E3E3E3")}var a=$(d).position();b.css("left",a.left);b.css("top",a.top+$(d).height()+7)}else{b.css("display","none")}}function callSaveChart(a,b,d){ajaxAsyncCall("MSChartEx",["SaveChart",b,$(a).parent().prev().children()[0].value,d],false,true)}function loadSelectedChart(a){ajaxAsyncCall("MSChartEx",["LoadChart",$(a).val()],false,true)}function evalFunctionIfKey(event,postHandler,bCtrl,bAlt,bShift){var shouldEval=bCtrl||bAlt||bShift;if(shouldEval){var spKeyStatus=specialKeyStatus(event);var ctrlPressed=spKeyStatus.ctrlPressed,altPressed=spKeyStatus.altPressed,shiftPressed=spKeyStatus.shiftPressed;if(bCtrl){shouldEval=ctrlPressed?true:false}if(shouldEval&&bAlt){shouldEval=altPressed?true:false}if(shouldEval&&bShift){shouldEval=shiftPressed?true:false}if(shouldEval){postHandler=postHandler.replace(/\[BSQ]/g,"'");eval(postHandler)}}return true}function specialKeyStatus(e){var b=0,f=0,d=0;if(parseInt(navigator.appVersion)>3){if(navigator.appName=="Netscape"&&parseInt(navigator.appVersion)==4){var a=(e.modifiers+32).toString(2).substring(3,6);d=(a.charAt(0)=="1");b=(a.charAt(1)=="1");f=(a.charAt(2)=="1")}else{d=e.shiftKey;f=e.altKey;b=e.ctrlKey}}return{ctrlPressed:b,altPressed:f,shiftPressed:d}}function setSessionVariable(b,e,a,d){ajaxSyncCall("HelperEx",["SetSessionVariable",b,e,a.toString(),d])}function fireSubmitEvent(d,b){if(d&&d.keyCode=="13"){var a=getSourceElement(d);if(a){try{if(a.onchange){a.onchange()}else{if(a.change){a.change()}}}catch(e){}}setTimeout('fireLink("'+b+'");',100)}}function fireLink(a){var b=getElementByBizAPPId(a,"DIV");if(b){var b=$(b).children(".linkcontrol")[0];try{if(b.onclick){b.onclick()}else{if(b.click){b.click()}}}catch(d){}}}function settabs(a){$("#"+a).parent().children("LI").attr("class","inactive");$("#"+a).attr("class","active")}function showonlyones(a){$("#"+a).parent().children([name="newbox"]).hide();$("#"+a).show()}Persist=(function(){var f="0.1.0",e,k,a,h,d,b;b=(function(){var v="Thu, 01-Jan-1970 00:00:01 GMT",n=1000*60*60*24,w=["expires","path","domain"],p=escape,o=unescape,u=document,q;var z=function(){var A=new Date();A.setTime(A.getTime());return A};var m=function(E,H){var D,B,G,F=[],A=(arguments.length>2)?arguments[2]:{};F.push(p(E)+"="+p(H));for(D=0;D<w.length;D++){B=w[D];if(G=A[B]){F.push(B+"="+G)}}if(A.secure){F.push("secure")}return F.join("; ")};var t=function(){var B="__EC_TEST__",A=new Date();A=A.toGMTString();this.set(B,A);this.enabled=(this.remove(B)==A);return this.enabled};q={set:function(F,I){var E=(arguments.length>2)?arguments[2]:{},D=z(),B,A={};if(E.expires){E.expires*=n;A.expires=new Date(D.getTime()+E.expires);A.expires=A.expires.toGMTString()}var H=["path","domain","secure"];for(i=0;i<H.length;i++){if(E[H[i]]){A[H[i]]=E[H[i]]}}var G=m(F,I,A);u.cookie=G;return I},has:function(B){B=p(B);var F=u.cookie,E=F.indexOf(B+"="),A=E+B.length+1,D=F.substring(0,B.length);return((!E&&B!=D)||E<0)?false:true},get:function(D){D=p(D);var G=u.cookie,F=G.indexOf(D+"="),A=F+D.length+1,E=G.substring(0,D.length),B;if((!F&&D!=E)||F<0){return null}B=G.indexOf(";",A);if(B<0){B=G.length}return o(G.substring(A,B))},remove:function(A){var D=q.get(A),B={expires:v};u.cookie=m(A,"",B);return D},keys:function(){var F=u.cookie,E=F.split("; "),A,D,B=[];for(A=0;A<E.length;A++){D=E[A].split("=");B.push(o(D[0]))}return B},all:function(){var F=u.cookie,E=F.split("; "),A,D,B=[];for(A=0;A<E.length;A++){D=E[A].split("=");B.push([o(D[0]),o(D[1])])}return B},version:"0.2.1",enabled:false};q.enabled=t.call(q);return q}());d=function(){};a=function(m){return"PS"+m.replace(/_/g,"__").replace(/ /g,"_s")};C={search_order:["gears","localstorage","whatwg_db","globalstorage","flash","ie","cookie"],name_re:/^[a-z][a-z0-9_ -]+$/i,methods:["init","get","set","remove","load","save"],sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:true}}};k={gears:{size:-1,test:function(){return(window.google&&window.google.gears)?true:false},methods:{transaction:function(n){var m=this.db;m.execute("BEGIN").close();n.call(this,m);m.execute("COMMIT").close()},init:function(){var m;m=this.db=google.gears.factory.create("beta.database");m.open(a(this.name));m.execute(C.sql.create).close()},get:function(m,o,n){var p,q=C.sql.get;if(!o){return}this.transaction(function(u){p=u.execute(q,[m]);if(p.isValidRow()){o.call(n||this,true,p.field(0))}else{o.call(n||this,false,null)}p.close()})},set:function(n,u,p,o){var m=C.sql.remove,t=C.sql.set,q;this.transaction(function(v){v.execute(m,[n]).close();v.execute(t,[n,u]).close();if(p){p.call(o||this,true,u)}})},remove:function(m,o,n){var p=C.sql.get;sql=C.sql.remove,r,val;this.transaction(function(q){if(o){r=q.execute(p,[m]);if(r.isValidRow()){val=r.field(0);q.execute(sql,[m]).close();o.call(n||this,true,val)}else{o.call(n||this,false,null)}r.close()}else{q.execute(sql,[m]).close()}})}}},whatwg_db:{size:200*1024,test:function(){var m="PersistJS Test",n="Persistent database test.";if(!window.openDatabase){return false}if(!window.openDatabase(m,C.sql.version,n,k.whatwg_db.size)){return false}return true},methods:{transaction:function(m){if(!this.db_created){var n=C.sql.create;this.db.transaction(function(o){o.executeSql(n,[],function(){this.db_created=true})},d)}this.db.transaction(m)},init:function(){var n,m;n=this.o.about||"Persistent storage for "+this.name;m=this.o.size||k.whatwg_db.size;this.db=openDatabase(this.name,C.sql.version,n,m)},get:function(m,o,n){var p=C.sql.get;if(!o){return}n=n||this;this.transaction(function(q){q.executeSql(p,[m],function(u,v){if(v.rows.length>0){o.call(n,true,v.rows.item(0)["v"])}else{o.call(n,false,null)}})})},set:function(n,t,p,o){var m=C.sql.remove,q=C.sql.set;this.transaction(function(u){u.executeSql(m,[n],function(){u.executeSql(q,[n,t],function(v,w){if(p){p.call(o||this,true,t)}})})});return t},remove:function(m,o,n){var p=C.sql.get;sql=C.sql.remove;this.transaction(function(q){if(o){q.executeSql(p,[m],function(u,v){if(v.rows.length>0){var w=v.rows.item(0)["v"];u.executeSql(sql,[m],function(z,A){o.call(n||this,true,w)})}else{o.call(n||this,false,null)}})}else{q.executeSql(sql,[m])}})}}},globalstorage:{size:5*1024*1024,test:function(){return window.globalStorage?true:false},methods:{key:function(m){return a(this.name)+a(m)},init:function(){this.store=globalStorage[this.o.domain]},get:function(m,o,n){m=this.key(m);if(o){o.call(n||this,true,this.store.getItem(m))}},set:function(m,p,o,n){m=this.key(m);this.store.setItem(m,p);if(o){o.call(n||this,true,p)}},remove:function(m,o,n){var p;m=this.key(m);p=this.store[m];this.store.removeItem(m);if(o){o.call(n||this,(p!==null),p)}}}},localstorage:{size:-1,test:function(){return window.localStorage?true:false},methods:{key:function(m){return a(this.name)+a(m)},init:function(){this.store=localStorage},get:function(m,o,n){m=this.key(m);if(o){o.call(n||this,true,this.store.getItem(m))}},set:function(m,p,o,n){m=this.key(m);this.store.setItem(m,p);if(o){o.call(n||this,true,p)}},remove:function(m,o,n){var p;m=this.key(m);p=this.get(m);this.store.removeItem(m);if(o){o.call(n||this,(p!==null),p)}}}},ie:{prefix:"_persist_data-",size:64*1024,test:function(){return window.ActiveXObject?true:false},make_userdata:function(n){var m=document.createElement("div");m.id=n;m.style.display="none";m.addBehavior("#default#userData");document.body.appendChild(m);return m},methods:{init:function(){var m=k.ie.prefix+a(this.name);this.el=k.ie.make_userdata(m);if(this.o.defer){this.load()}},get:function(m,o,n){var p;m=a(m);if(!this.o.defer){this.load()}p=this.el.getAttribute(m);if(o){o.call(n||this,p?true:false,p)}},set:function(m,p,o,n){m=a(m);this.el.setAttribute(m,p);if(!this.o.defer){this.save()}if(o){o.call(n||this,true,p)}},load:function(){this.el.load(a(this.name))},save:function(){this.el.save(a(this.name))}}},cookie:{delim:":",size:4000,test:function(){return e.Cookie.enabled?true:false},methods:{key:function(m){return this.name+k.cookie.delim+m},get:function(m,p,o,n){m=this.key(m);p=b.get(m);if(o){o.call(n||this,p!=null,p)}},set:function(m,p,o,n){m=this.key(m);b.set(m,p,this.o);if(o){o.call(n||this,true,p)}},remove:function(m,p,o,n){var p;m=this.key(m);p=b.remove(m);if(o){o.call(n||this,p!=null,p)}}}},flash:{test:function(){if(!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil){return false}var m=deconcept.SWFObjectUtil.getPlayerVersion().major;return(m>=8)?true:false},methods:{init:function(){if(!k.flash.el){var q,n,p,m=C.flash;p=document.createElement("div");p.id=m.div_id;document.body.appendChild(p);q=new SWFObject(this.o.swf_path||m.path,m.id,m.size.w,m.size.h,"8");for(n in m.args){q.addVariable(n,m.args[n])}q.write(p);k.flash.el=document.getElementById(m.id)}this.el=k.flash.el},get:function(m,o,n){var p;m=a(m);p=this.el.get(this.name,m);if(o){o.call(n||this,p!==null,p)}},set:function(n,q,p,o){var m;n=a(n);m=this.el.set(this.name,n,q);if(p){p.call(o||this,true,q)}},remove:function(m,o,n){var p;m=a(m);p=this.el.remove(this.name,m);if(o){o.call(n||this,true,p)}}}}};var h=function(){var q,n,m,p,o=C.methods,t=C.search_order;for(q=0,n=o.length;q<n;q++){e.Store.prototype[o[q]]=d}e.type=null;e.size=-1;for(q=0,n=t.length;!e.type&&q<n;q++){m=k[t[q]];if(m.test()){e.type=t[q];e.size=m.size;for(p in m.methods){e.Store.prototype[p]=m.methods[p]}}}e._init=true};e={VERSION:f,type:null,size:0,add:function(m){k[m.id]=m;C.search_order=[m.id].concat(C.search_order);h()},remove:function(n){var m=C.search_order.indexOf(n);if(m<0){return}C.search_order.splice(m,1);delete k[n];h()},Cookie:b,Store:function(m,n){if(!C.name_re.exec(m)){throw new Error("Invalid name")}if(!e.type){throw new Error("No suitable storage found")}n=n||{};this.name=m;n.domain=n.domain||location.hostname||"192.168.2.151.localdomain";this.o=n;n.expires=n.expires||365*2;n.path=n.path||"/";this.init()}};h();return e})();function getOrCreateStore(a){return new Persist.Store("BizAPP_"+a)}function persistValue(e,a,d){a=a.replace(/:/g,"");var b=getOrCreateStore(e);b.set(a,d)}function getPersistedValue(e,a){a=a.replace(/:/g,"");var b=getOrCreateStore(e);var d;b.get(a,function(f,h){if(f){d=h}});return d}function removePersistedValue(d,a){a=a.replace(/:/g,"");var b=getOrCreateStore(d);b.remove(a,function(e,f){})}Persist.Stack={PushValue:function(a,b){var d=getPersistedValue(a,"value");if(!d){d=[]}else{d=JSON.parse(d)}d.push(b);persistValue(a,"value",JSON.stringify(d))},PopValue:function(a){var d=getPersistedValue(a,"value");if(d){d=JSON.parse(d);var b=d.pop();persistValue(a,"value",JSON.stringify(d));return b}},PeekValue:function(a){var b=getPersistedValue(a,"value");if(b){b=JSON.parse(b);return b[b.length-1]}},Clear:function(a){removePersistedValue(a,"value")}};var g_geoLocation="";function getGeoLocation(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(processPosition,function(a){logError("geolocation - something went wrong: ",a)},{timeout:(5*1000),maximumAge:(1000*60*15),enableHighAccuracy:true})}}function processPosition(a){g_geoLocation="Latitude={0};Longitude={1}".format(a.coords.latitude.toString(),a.coords.longitude.toString());addLog("GEOLOCATION (lat, long) -"+g_geoLocation)}var BizAPP=BizAPP||{};BizAPP.Session={SetTimeZone:function(a){ajaxAsyncCall("HelperEx",["SetCurrentTimeZone",a],false,true)},GetQueryResults:function(b,d){g_headers=JSON.stringify(b,BizAPP.UI._JSONreplacer);var a=["GetQueryResults",JSON.stringify(b)];realAjaxAsyncCall("HelperEx",getNextRequestId(),a,true,function(k,m,h){var f=BizAPP.UI._handleEventsAndExceptions(k,m,h);if(f[1]){var e=JSON.parse(f[1])}if(d){d(e)}})},ExecuteQuery:function(e){var a;if(!e.contexts){e.contexts=""}if(!e.pageSize||isNaN(e.pageSize)){e.pageSize=20}if(!e.pageNo||isNaN(e.pageNo)){e.pageNo=0}if(!e.identifiersOnly||isNaN(e.identifiersOnly)){e.identifiersOnly=false}g_headers=JSON.stringify(e,BizAPP.UI._JSONreplacer);var d=["ExecuteQuery",e.queryEid,e.contexts,e.pageSize.toString(),e.pageNo.toString(),e.identifiersOnly.toString()];if(e.callback){realAjaxAsyncCall("HelperEx",getNextRequestId(),d,true,function(m,n,k){var h=BizAPP.UI._handleEventsAndExceptions(m,n,k);if(h[1]){var f=JSON.parse(h[1])}e.callback(f)})}else{var b=ajaxEntryCall("HelperEx",d,false,false);a=JSON.parse(b.value[1]);if(e.handleResponse){responseHandler(b)}return a}},EvaluateExpression:function(b){if(!b.expression){return b.expression}b=b||{expression:"",compute:false,htmlFriendly:false,contexts:"",callback:function(d){return d},excpAsResp:false};if(!b.contexts){b.contexts=""}if(!b.compute){b.compute=false}if(!b.htmlFriendly){b.htmlFriendly=false}if(!b.excpAsResp){b.excpAsResp=false}if(b.expression.toLowerCase().indexOf("session.")==-1&&b.expression.toLowerCase().indexOf("this.")==-1&&b.expression.toLowerCase().indexOf("embedview:")==-1){g_readOnly=true}var a=["EvaluateExpression",b.expression,b.compute.toString(),b.htmlFriendly.toString(),b.contexts,b.excpAsResp];if(b.sync){return ajaxSyncCallAndNoResponseHandler("HelperEx",a)}else{realAjaxAsyncCall("HelperEx",getNextRequestId(),a,false,function(h,k,f){var e=BizAPP.UI._handleEventsAndExceptions(h,k,f);if(e[1]){var d=JSON.parse(e[1])}if(b.callback){b.callback(d,h)}return d})}},InvokeStaticMethod:function(a){g_callBacks.push(a.callback);ajaxAsyncCall("HelperEx",["InvokeMethodOnBO",a.type,a.method,a.args,a.passSession])},InvokeMapper:function(a){throw"not implemented."},InvokeProcess:function(a){throw"not implemented."},__dateFormat:null,__datetimeFormat:null,__lastCallTime:null,__timeoutInterval:null,__alertPopup:null,AlertTimeout:function(a){if(!(isIE()&&isIE()<9)){if(a){BizAPP.Session.__timeoutInterval=a}BizAPP.Session.__alertTimeout()}},__alertTimeout:function(){if(window.localStorage){BizAPP.Session.__lastCallTime=new Date(localStorage.getItem("BizAPP.Session.__lastCallTime"))}if(BizAPP.Session.__timeoutInterval){var a=new Date(),b=((a-BizAPP.Session.__lastCallTime)/1000)/60;b=BizAPP.Session.__timeoutInterval-b;if(0<b&&b<7){if(!(BizAPP.UI.InlinePopup.getActivePopup(false)&&$(BizAPP.UI.InlinePopup.getActivePopup(false).tinner()).find(".bza_timeout_alert").length)){BizAPP.Session.ShowAlertTimeout(b*60)}}else{if(BizAPP.UI.InlinePopup.getActivePopup(false)&&$(BizAPP.UI.InlinePopup.getActivePopup(false).tinner()).find(".bza_timeout_alert").length){BizAPP.UI.InlinePopup.getActivePopup(false).hide()}else{setTimeout(BizAPP.Session.__alertTimeout,1000*60)}}}},ShowAlertTimeout:function(b){var a={html:'<div class="bza_timeout_alert"><div class="text"><div style="line-height: 30px;"><span>Your session is about to expire!</span></div><div>You will be logged out in <span class="timeleft"></span><br/></div><div> Do you want to stay signed in?</div></div><button class="signin" onclick="g_callBacks.push(zoomout);ajaxAsyncCall(\'HelperEx\', [\'PingSession\'], false, true);">Yes, keep me signed in</button><button class="signout" onclick="ajaxAsyncCall(\'LogoutEx\', [\'LogoutWithNoDirtyTranscationsCheck\',\'true\'], true, true);">Sign out</button></div>',strclosejs:"BizAPP.Session._counter.b.resolve();clearInterval(BizAPP.Session._counter.c);setTimeout(BizAPP.Session.__alertTimeout, 1000 * 10);BizAPP.Session.__alertPopup = null;",stropenjs:'BizAPP.Session._counter=BizAPP.Session._countdown($(".bza_timeout_alert .timeleft"), 0,'+Math.round(b-120)+",signOutWithNoDirtyTransactionsCheck);",width:300};BizAPP.Session.__alertPopup=BizAPP.UI.InlinePopup.CreateNew(a)},_counter:null,_countdown:function(f,h,m,d){if(m>60){h+=Math.floor(m/60);m=m%60}var a=$.Deferred(),e=h,k=m;var b=setInterval(function(){if(k<=0){if(e<=0){a.resolve();clearInterval(b);d();return}else{e--;k=60}BizAPP.Session.__alertTimeout()}if(e>0){var n=e+(e>1?" minutes":" minute")}else{var n=""}var o=k>1?"seconds":"second";f.text(n+" "+k+" "+o);BizAPP.UI.InlinePopup._setTINYPosition(true);k--},1000);return{a:a.promise(),b:a,c:b}},_updateLastCallTime:function(){var a=BizAPP.Session.__lastCallTime=new Date();try{if(window.localStorage){localStorage.setItem("BizAPP.Session.__lastCallTime",a.toISOString())}}catch(b){}}};BizAPP.RuntimeObject={GetFieldValue:function(a){return BizAPP.Session.EvaluateExpression({expression:"%"+a.fieldName+"%",contexts:a.roid,callback:a.callback})},SetFieldValue:function(a){a.sync=a.sync||false;if(!a.refreshView){a.refreshView=false}if(typeof(a.callback)!="undefined"){g_callBacks.push(a.callback)}assignFieldValue(a.roid,a.fieldName,a.fieldValue,a.refreshView,a.addOrRemove,a.setMultiple,a.sync)},ApplyStep:function(a){applyStepOfType(a.roid,a.stepname,a.steptype)}};BizAPP.UI={SerializeContext:function(b){var a="";$.each(b,function(d,e){if(a){a+="[PMS]"}a+=d+"[NVS]"+e});return a},MobileSystemTrayView:"ESystemb13d8",JobRequestSystemTrayView:"ESystemb1688",controlMapping:{},controlDependency:{},controlSelector:{},impersonateField:"",widgetChartHeight:"",brandName:"",brandUrl:"",firstAccess:false,basePath:"",retryIndex:0,appendBasePath:false,currentApplication:null,GetBasePath:function(b){var a=new RegExp("^(?:[a-z]+:)?//","i");if(a.test(b)){return b}if(BizAPP.UI.appendBasePath){return BizAPP.UI.basePath.replace(/\/$/,"").concat("/",b)}else{if(location.href.toLowerCase().indexOf("system/diagnostics.aspx")>-1){return"../"+b}else{return b}}},PreResponseHandler:function(a){},ApplyStepCallback:function(a){},g_popupRead:false,g_initPopState:false,successHandler:function(e){if(getQSParamByName("html.skipstate")=="true"){return}if(!BizAPP.UI.g_initPopState){window.addEventListener("popstate",BizAPP.UI.NavigateBack,false);BizAPP.UI.g_initPopState=true}$('a[href="#"]').attr("href","javascript:void(0)");if(location.href.indexOf("html.popup")!=-1&&!BizAPP.UI.g_popupRead){BizAPP.UI.g_popupRead=true;var f=getQSParamByName("html.popup");BizAPP.UI.LoadView({inlinePopup:true,url:"uiview.asmx?html.jar=true&html.insertjscss=false&html.vcn=CMW&html.svs=true&html.args="+f})}if(e.indexOf("ViewControlEx")>-1){var k=BizAPP.UI.GetViewUrl();var a=window.location.pathname.split("/").pop();var b=JSON.parse(BizAPP.UI.currentApplication);var h=a+"?html.app="+(b?b.bizappcurrentapplicationeid:"")+"&html.views="+k;if(a.toLowerCase().indexOf("enterpriseview.aspx")==-1){var d=BizAPP.UI.GetViews()[0];h+="&html.args=navigationcontrol.ignoreprocess[NVS]true[PMS]runtimeviewenterpriseid[NVS]"+d.view+"[PMS]runtimeobjectid[NVS]"+d.context+""}if(history&&history.pushState){if(!history.state){history.pushState({name:"",url:k},a,h)}else{if(k==history.state.url){}else{if(k.indexOf(history.state.url)>-1){history.replaceState({name:"",url:k},a,h)}else{if(k!=history.state.url){history.pushState({name:"",url:k},a,h)}}}}}}},GetViews:function(d){var a=[];var b=d&&d.control?d.control.parents(".ViewControlEx[bizapp_eid]"):$(".ViewControlEx[bizapp_eid]");$.each(b,function(){var k=$(this);addLog({id:$(this).attr("bizapp_eid"),name:$(this).attr("bizapp_name"),vcn:$(this).attr("bizappid"),ele:this});if(k.find(".viewlet").length==0||(k.find(".ViewControlEx").length>0&&k.find(".viewlet").length<=k.find(".ViewControlEx").find(".viewlet").length)){addLog({id:$(this).attr("bizapp_eid"),name:$(this).attr("bizapp_name"),vcn:$(this).attr("bizappid"),ele:this});var h=k.attr("bizapp_context");if(h&&h.indexOf("UID_RuntimeEnterprise")>0){h=""}if(h){h=h.split(/\n/)[0]}if(h){h=h.substring(0,h.lastIndexOf(":"))+":-1"}if(!h){h=""}var m=k.attr("bizappid");if(m){var e=-1;for(var f=0;f<a.length;f++){e=a[f].id==m?f:e}if(e==-1){a.push({id:m,context:h,view:k.attr("bizapp_eid"),name:k.attr("bizapp_name")})}else{a[e].context=h;a[e].view=k.attr("bizapp_eid")}}}});return a},GetViewUrl:function(d){var b="";var h=BizAPP.UI.GetViews(d);for(var e=0;e<h.length;e++){var f=h[e];b+=f.id+","+f.view+","+f.context+";"}return b},NavigateBack:function(d){if(BizAPP.UI.InlinePopup.getActivePopup(false)){return}var b="";var p=BizAPP.UI.GetViewUrl({});var h=false;var n,o,e;if(d.state){if(p.indexOf(d.state.url)>-1){}else{var m=d.state.url.split(";");for(var k=0;k<m.length;k++){if(p.indexOf(m[k])<0||h){if(!b){var f=m[k].split(",");e=f[0];o=f[1];n=f[2]}b+=m[k]+";";h=true}}console.log("navigating -"+b);if(b){var a=getControlToReplace($(getElementByBizAPPId(e)));PQube.View.LoadView({readonly:false,shs:true,roid:n,vieweid:o,target:e,control:a,views:b})}}}else{}},_promptEditLoss:function(){var e=getSourceElement(window.event);if(e&&e instanceof HTMLElement&&$.contains(document.documentElement,e)){setForceFocus("forcefocus",window.event);var b=$(e);var k=b.closest("[bza_viewparams]");if(k.length>0){g_headers=JSON.stringify({viewparams:JSON.parse(k.attr("bza_viewparams"))})}if(b.closest(".ui-datepicker").length>0||b.closest(".ui-autocomplete").length>0||b.closest(".tbox").length>0||b.closest(".bza-alrtCont").length>0||b.attr("onclick")&&b.attr("onclick").indexOf("callAssociate")!=-1||b.attr("onclick")&&b.attr("onclick").indexOf("custSearchCompleteHandler")!=-1||b.attr("onclick")&&b.attr("onclick").indexOf("exeSqSearchCallBack")!=-1||b.parent().length==0){return false}var f=[];var d=$.grep($(".form"),function(o,a){var m=$(o);return !(m.hasClass("bza-noteditable")||m.hasClass("bza-virtual")||m.parents(".tcontent").length)});$.each(d,function(m,o){var a=$(o).closest(".ViewControlEx");if(a.length>0&&$.inArray(a.get(0),f)==-1){if(f.length>0&&$.contains(f[0],a.get(0))){return}f.push(a.get(0))}});if(f.length>0){var h=false;$.each(f,function(a,m){if(!$.contains(m,e)){h=true;return false}});return h}}},_handleFailedResponse:function(a,d,b){ProcessingStatus(false,true);logError("Ajax Call failed. : status text :"+d);logError("ready state : "+a.readyState+"status : "+a.status+"response : "+a.responseText);if(a.readyState==0&&a.status==0&&!a.responseText){addLog("Server not reachable, please try refreshing the page after some time.",true)}if(this.callback){this.callback(b,d,a)}else{if(this.context&&this.context.callback){this.context.callback(b,d,a)}}},_handleSuccessResponse:function(d,e,b,a){d=BizAPP.UI._handleEventsAndExceptions(d,e,b,a);a=a||{};a.callback=a.callback||this.callback;a.selector=a.selector||this.selector;a.popup=a.popup||this.popup;BizAPP.UI.TransformUI($(d[1]),function(f){var m="";f.each(function(o,n){if(n&&n.outerHTML){m+=n.outerHTML}});d[1]=m;if(d[1]){if(a&&a.popup){showTinyBox(d[1])}else{if(a.inlinePopup){}else{if(!this.selector&&(!a||!a.selector)){this.selector="#"+$(d[1]).attr("id").replace(/:/g,"\\:")}if(a&&a.selector){var h=false;try{if($(a.selector).attr("id")==$(d[1]).attr("id")){$(a.selector).replaceWith(d[1]);h=true}}catch(k){addLog(k.Message,true)}if(!h){if(typeof a.selector=="object"&&a.selector.length>0&&isIE()==8){a.selector[0].innerHTML=d[1]}else{$(a.selector).html(d[1])}}BizAPP.UI.TabControl.ResponsiveInit();BizAPP.UI.InlinePopup._setTINYPosition(true)}else{if(this.selector){$(this.selector).html(d[1]);BizAPP.UI.TabControl.ResponsiveInit();BizAPP.UI.InlinePopup._setTINYPosition(true)}}}}}setTimeout(function(){if(a&&a.callback){a.callback(d,e,b)}else{if(this.callback){this.callback(d,e,b)}else{if(this.context&&this.context.callback){this.context.callback(d,e,b)}}}BizAPP.UI.successHandler(d[1])},20);return d})},_handleEventsAndExceptions:function(f,h,e,b){var d=(new Date()).getTime();if(h!="success"&&h!="OK"){BizAPP.UI._handleFailedResponse(e,h,f)}else{ProcessingStatus(false,true);if(!f.value){f=JSON.parse(f)}else{f=f.value}if(f[1].indexOf("[DS]")!=-1){var a="";$.each(f[1].split("[DS]"),function(){if(a){a+="[DS]"}a+=this.toString().indexOf("[IDS]")!=-1?this.split("[IDS]")[2]:this.toString()});f[1]=a}if(f[1].indexOf("[IDS]")!=-1){f[1]=f[1].split("[IDS]")[2]}f[1]=addWindowEvent(f[1]);displayExceptions(f[3],f[4]);if(b&&(b.inlinePopup||b.menuPopupSelector)){}else{setTimeout(function(){fireEvents(f[2])},10)}processResponseTime(d,f[7],f[6],{value:f,json:JSON.stringify(f)});return f}},LoadView:function(a){if(BizAPP.UI._promptEditLoss()){BizAPP.UI.InlinePopup.Confirm({message:"You have data that has not yet been saved. Do you still want to continue?",type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}BizAPP.UI.LoadView1(a)},fnCancelCallback:function(){ProcessingStatus(false,true)}})}else{BizAPP.UI.LoadView1(a)}},LoadView1:function(d){d.inlinePopup=d.inlinePopup||false;d.menuPopupSelector=d.menuPopupSelector||false;if(!d.url){d.url="uiview.asmx?html.jar=true&html.args=";if(d.roid){d.url+="runtimeobjectid[NVS]"+d.roid+"[PMS]"}if(d.viewId){d.url+="runtimeviewenterpriseid[NVS]"+d.viewId+"[PMS]"}if(d.target){d.url+="&html.vcn="+d.target}}if(!d.inlinePopup&&!d.menuPopupSelector&&!getQSParamByName("html.vcn",d.url)){throw"value cannot be null, html.vcn"}if(d.showprocessing){ProcessingStatus(true,true)}var b;if(d.inlinePopup){b=function(f,k,e){var h=d.callback;d.callback=function(o,p,n){if(o[2]){o[2]=o[2].replace(/["]/g,'\\"').replace(/\r?\n|\r/g,"");if(window.sessionStorage){var m=getNextRequestId().toString();window.sessionStorage.setItem(m,o[2]);o[2]=m}}BizAPP.UI.InlinePopup.CreateNew($.extend(d.inlinepopupoptions,{html:o[1],stropenjs:(d.inlinepopupoptions&&d.inlinepopupoptions.stropenjs)?d.inlinepopupoptions.stropenjs+';fireEvents("'+o[2]+'");':'fireEvents("'+o[2]+'");'}));if(h){h()}};f=BizAPP.UI._handleSuccessResponse(f,k,e,d)}}else{if(d.menuPopupSelector){b=function(f,k,e){var h=d.callback;d.callback=function(n,o,m){BizAPP.MenuPopup.Create({html:n[1],autodeleteonclose:d.autodeleteonclose,selector:$(d.menuPopupSelector),mode:"open",position:d.position,callback:function(){if(event){event.stopPropagation()}setTimeout(function(){fireEvents(n[2])},10)}});if(h){h()}};f=BizAPP.UI._handleSuccessResponse(f,k,e,d)}}else{b=BizAPP.UI._handleSuccessResponse}}d.url=d.url+"&html.popup={0}".format((d.inlinePopup||d.menuPopupSelector).toString());var a={contentType:"application/json; charset=utf-8",url:d.url,dataType:"text",success:b,error:BizAPP.UI._handleFailedResponse,context:d,cache:false};a.beforeSend=function(f){if(d.readonly==false){f.setRequestHeader("X-Bza-Type","read-write")}var e=JSON.stringify(d,BizAPP.UI._JSONreplacer);if(BizAPP.UI.currentApplication){if(!e){e="{currentApplication: '"+BizAPP.UI.currentApplication+"'}"}else{var e=JSON.parse(e);e.currentApplication=BizAPP.UI.currentApplication;e=JSON.stringify(e)}}f.setRequestHeader("Bza-Options",e)};$.ajax(a)},ExecuteReportInContext:function(a){g_headers=JSON.stringify(a,BizAPP.UI._JSONreplacer);var b="runtimeobjectid[NVS]"+a.context+"[PMS]navigationcontrol.ignoreprocess[NVS]true";realAjaxAsyncCall("ViewNavigationEx",getNextRequestId(),["PreviewView",b,a.vcn,"true","","false","",a.report,"","false"],true,function(e,f,d){BizAPP.UI._handleSuccessResponse(e,f,d,a)})},ExecuteLink:function(a){setForceFocus("forcefocus",window.event);a=$.extend({viewdef:"",controlname:"",context:"",viewname:"",callback:null,processifvisible:"",formtype:""},a);g_headers=JSON.stringify(a,BizAPP.UI._JSONreplacer);realAjaxAsyncCall("HelperEx",getNextRequestId(),["ExecuteLink",a.viewdef,a.controlname,a.context,a.viewname,a.processifvisible,a.formtype],true,function(d,e,b){BizAPP.UI._handleSuccessResponse(d,e,b,a)})},LoadControl:function(a){a=a||{viewdef:"",controlname:"",context:"",viewname:"",selector:""};if(!a.controlname){throw"value cannot be null, controlname"}if(!a.viewdef){throw"value cannot be null, def"}g_headers=JSON.stringify(a,BizAPP.UI._JSONreplacer);realAjaxAsyncCall("HelperEx",getNextRequestId(),["LoadControl",a.viewdef,a.controlname,a.context,a.viewname,a.formtype],true,function(d,e,b){BizAPP.UI._handleSuccessResponse(d,e,b,a)})},LoadControlUsingContext:function(a){ajaxAsyncCall("HelperEx",["RenderControlUsingContext",a],false,false)},LoadWidget:function(a){a=a||{vieweid:"",controlname:"",context:"",vcn:"",selector:"",widget:""};g_headers=JSON.stringify(a,BizAPP.UI._JSONreplacer);realAjaxAsyncCall("HelperEx",getNextRequestId(),["LoadWidget",a.vieweid,a.context,a.vcn,a.widget],true,function(d,e,b){BizAPP.UI._handleSuccessResponse(d,e,b,a)})},LoadGlobalWidget:function(a){a=a||{vieweid:"",context:"",vcn:"",selector:""};g_headers=JSON.stringify(a,BizAPP.UI._JSONreplacer);realAjaxAsyncCall("HelperEx",getNextRequestId(),["LoadGlobalWidget",a.vieweid,a.context,a.vcn],true,function(d,e,b){BizAPP.UI._handleSuccessResponse(d,e,b,a)})},_JSONreplacer:function(a,b){if(a=="selector"||a=="callback"||a=="control"){return undefined}else{return b}},GetCharts:function(a){args=[];$.each(a,function(){var b=this;args.push(["LoadChart",b.title,b.size,b.objecttypeid,b.fieldname,b.filterqueryid,b.seriesfield,b.aggregatefunction,b.roid,b.contextfieldname,b.color,b.seriestype,b.functionfield,b.isForm,b.formId,b.ctrlName,b.container])});realAjaxAsyncCall("HelperEx",getNextRequestId(),args,true,function(d,e,b){d=BizAPP.UI._handleEventsAndExceptions(d,e,b);if(a.callback){a.callback(d)}else{BizAPP.UI.InlinePopup.CreateNew({html:d[1]})}},true)},GetChart:function(a){realAjaxAsyncCall("HelperEx",getNextRequestId(),["LoadChart",a.title,a.size,a.objecttypeid,a.fieldname,a.filterqueryid,a.seriesfield,a.aggregatefunction,a.roid,a.contextfieldname,a.color,a.seriestype,a.functionfield,a.isForm,a.formId,a.ctrlName,a.container],true,function(d,e,b){d=BizAPP.UI._handleEventsAndExceptions(d,e,b);if(a.callback){a.callback(d)}else{if(d[1]){BizAPP.UI.InlinePopup.CreateNew({html:d[1]})}}})},Prompt:function(msg,successHandler,failureHandler,event){BizAPP.UI.InlinePopup.Confirm({message:msg.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"'),type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}eval(successHandler.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"'))},fnCancelOnclick:function(){eval(failureHandler.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"'))}})},ShowDebugDetails:function(b){var a=b.parents("[bizapp_name]"),d='<table class="gridcontrol">';$.each(a,function(k,m){var o=$(m);var h={Type:o.attr("class").replace("fill",""),ControlName:o.attr("bza-ctrlid"),Name:o.attr("bizapp_name"),Id:"",Context:o.attr("bizapp_context")};var f;if(h.Type.indexOf("ViewControlEx")!=-1){f="Views";h.Type="View"}else{if(h.Type.indexOf("form")!=-1){f="Forms";h.Type="Form"}else{f="Queries"}}var e=o.attr("bizapp_eid");h.Id=e+'<br/><a style="color: blue; text-decoration: underline;cursor:pointer;" target="_blank" href="system/diagnostics.aspx?ctl=MetadataInfo&h=Metadata%20Information&Type='+f+"&Id="+e+'">More...</a>';if(h.Context){h.Context+='<br/><a style="color: blue; text-decoration: underline;cursor:pointer;" target="_blank" href="system/diagnostics.aspx?ctl=QueryWorkbench&h=Query%20Workbench&contextid='+h.Context.split("\n")[0]+'">More...</a>'}if(k==0){d+="<thead><tr>";$.each(h,function(p,n){d+="<th><b>{0}</b></th>".format(p)});d+="</tr></thead>"}d+='<tr class="gr">';$.each(h,function(p,n){d+="<td>{0}</td>".format(n||"-")});d+="</tr>"});d+="</table>";if(a.length>0){BizAPP.UI.InlinePopup.CreateNew({html:d})}},LoadThemes:function(options,i,handler){if(!i){i=0}var a=options[i++];var b=function(){if(i<options.length){BizAPP.UI.LoadThemes(options,i,handler)}else{eval(handler)}};if(!a.Key){b()}if(!$.getCss){jqExtns()}$.getCss(a.Key,b)},_loadedScripts:[],LoadScript:function(b){if(!b.version){b.version=0}var a=b.eid+b.version+"/file.asmx?mode=scriptlibrary&id="+b.eid;if(BizAPP.UI._loadedScripts.indexOf(a)!=-1){b.callback();return}jqExtns();$.cachedScript(BizAPP.UI.GetBasePath(a+"&v="+__bts_)).done(function(d,e){addLog(e);BizAPP.UI._loadedScripts.push(a);b.callback();jqExtns()})},LoadTheme:function(b){if(!b.version){b.version=0}var a=b.eid+b.version+"/file.asmx?mode=theme&id="+b.eid;jqExtns();$.getCss(BizAPP.UI.GetBasePath(a+"&v="+__bts_),function(){b.callback()})},LoadDependentFile:function(a,b){if($.inArray(a,dependentFiles)<0){switch(a){case"vue.js":$.cachedScript(BizAPP.UI.GetBasePath("https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.8/vue.min.js")).done(function(d,e){dependentFiles.push(a);b()});break;case"tablesaw.js":$.cachedScript(BizAPP.UI.GetBasePath("Resources/ResponsiveGrid/tablesaw.js?v="+__bts_)).done(function(d,e){dependentFiles.push(a);b()});break;case"zeroclipboard.js":$.cachedScript(BizAPP.UI.GetBasePath("Resources/ZeroClipboard/ZeroClipboard.js?v="+__bts_)).done(function(d,e){dependentFiles.push(a);b()});break;case"default.min.css":$.getCss(BizAPP.UI.GetBasePath("resources/texteditor/default.min.css?v="+__bts_));dependentFiles.push(a);break;case"font-awesome.min.css":$.getCss(BizAPP.UI.GetBasePath("Resources/TextEditor/font-awesome.min.css?v="+__bts_));dependentFiles.push(a);break;case"bootstrap.min.js":BizAPP.UI.TextEditor.LoadFontAwesomeCss();if(typeof $.fn.popover=="function"){dependentFiles.push(a);if(b){b()}}else{$.getCss(BizAPP.UI.GetBasePath("resources/bootstrap/css/bootstrap.min.css?v="+__bts_),function(){},'link[href*="appcss"]');$.getCss(BizAPP.UI.GetBasePath("resources/bootstrap/css/bootstrap-theme.min.css?v="+__bts_),function(){},'link[href*="appcss"]');$.cachedScript(BizAPP.UI.GetBasePath("resources/bootstrap/js/bootstrap.min.js?v="+__bts_)).done(function(){dependentFiles.push(a);if(b){b()}})}break}}else{if(b){b()}}},VisitTracker:function(a){if(!a.viewid){return}a=$.extend(a||{},{action:"set",value:"true"});ajaxAsyncCall("ViewEx",["VisitTracker",a.viewid,a.action,a.value.toString()],true,true)},ClearRecentViewItem:function(a,b){realAjaxAsyncCall("RecentEx",getNextRequestId(),["ClearRecentViewItem",a,b],false)},LoadInfragistics:function(a){if($.ig){a()}else{$.cachedScript(BizAPP.UI.GetBasePath("Resources/Javascripts/Infragistics/infragistics.core.js?v="+__bts_)).done(function(){$.cachedScript(BizAPP.UI.GetBasePath("Resources/Javascripts/Infragistics/infragistics.lob.js?v="+__bts_)).done(function(){$.getCss(BizAPP.UI.GetBasePath("Resources/CRM/Infragistics/themes/infragistics/infragistics.theme.css?v="+__bts_));$.getCss(BizAPP.UI.GetBasePath("Resources/CRM/Infragistics/structure/infragistics.css?v="+__bts_));a()})})}},LoadCollaboration:function(d,a){if(BizAPP.UI.retryIndex<8){if($.connection&&$.connection.hub.state){if(BizAPP.UI.Collaboration){BizAPP.UI.retryIndex=0;d()}else{var b;if(a){b="resources/javascripts/BizAPP.UI.Collaboration.V3.js?v="}else{b="resources/javascripts/BizAPP.UI.Collaboration.js?v="}$.cachedScript(BizAPP.UI.GetBasePath(b+__bts_)).done(function(e,f){BizAPP.UI.retryIndex=0;d()})}}else{setTimeout(function(){BizAPP.UI.retryIndex++;BizAPP.UI.LoadCollaboration(d,a)},5000)}}else{debug("Failed to initialize communication channel.","debug")}},LoadViewCustomization:function(a){if(BizAPP.ViewCustomization){a()}else{$.cachedScript(BizAPP.UI.GetBasePath("resources/javascripts/BizAPP.ViewCustomization.js?v="+__bts_)).done(function(b,d){a()})}},TransformUI:function(a,e){var b=[];for(var d in BizAPP.UI.controlSelector){b.push(d)}BizAPP.UI.SubTransformUI(b,a,e)},SubTransformUI:function(b,a,h){if(b.length){var e=b.pop();var f=BizAPP.UI.controlDependency.type;if(f){var d;switch(f){case"controlmap":if(BizAPP.UI.controlDependency[e]){d=BizAPP.UI.controlDependency[e]+"?v="+__bts_}if(d){if(a.find(BizAPP.UI.controlSelector[e]).length>0||a.is(BizAPP.UI.controlSelector[e])){$.cachedScript(BizAPP.UI.GetBasePath(d)).done(function(){BizAPP.UI.InternalTransformUI(a,e,b,h)})}else{BizAPP.UI.SubTransformUI(b,a,h)}}else{BizAPP.UI.SubTransformUI(b,a,h)}break;case"controlset":a=$("<div></div>").append(a);if(a.find(BizAPP.UI.controlSelector[e]).length>0||a.is(BizAPP.UI.controlSelector[e])){BizAPP.UI.InternalTransformUI(a.children(),e,b,h)}else{BizAPP.UI.SubTransformUI(b,a.children(),h)}break}}else{BizAPP.UI.SubTransformUI(b,a,h)}}else{if(h){h(a)}}},InternalTransformUI:function(a,d,b,e){switch(d){case"searchbutton":case"textbox":BizAPP.UI.Textbox.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"combobox":BizAPP.UI.ComboBox.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"datetimepicker":BizAPP.UI.DateTimePicker.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"stepcontrol":BizAPP.UI.StepControl.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"tabcontrol":BizAPP.UI.TabControl.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"checkbox":BizAPP.UI.CheckBox.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"radiobutton":BizAPP.UI.RadioButton.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break;case"attachmentcontrol":BizAPP.UI.AttachmentControl.Init(a,BizAPP.UI.controlSelector[d],function(f){BizAPP.UI.SubTransformUI(b,f,e)});break}},getValue:function(n,k){var f;if(k){k=k.split(" ")[0]}switch(k){case"formtimecombobox":f=getElementByBizAPPId(n,"SELECT");return f.getAttribute("currentDate")+" "+f.value;break;case"formdatetextbox":f=getElementByBizAPPId(n,"INPUT");var b=f.value,a=f.getAttribute("currentTime");try{if(BizAPP.Session.__dateFormat){var d=["dd-M-yy"];if(BizAPP.Session.__dateFormat=="dd-MMM-yyyy"||BizAPP.Session.__dateFormat=="dd/MMM/yyyy"||BizAPP.Session.__dateFormat=="dd/mm/yyyy"){d[1]="dd/m/yy"}else{if(BizAPP.Session.__dateFormat=="MMM-dd-yyyy"||BizAPP.Session.__dateFormat=="MMM/dd/yyyy"||BizAPP.Session.__dateFormat=="mm/dd/yyyy"){d[1]="m/dd/yy"}}if(d){if(b.indexOf("/")!=-1){b=$.datepicker.parseDate(d[1],"12/05/2013")}b=$.datepicker.formatDate(d[0],b)}}}catch(h){logError("failed to parse date",h);b=f.value}if(a){return b+" "+a}else{return b}break;case"formwordeditor":f=document.getElementById(n);if(f){return f.WordContentBase64}return null;break;case"formcheckbox":f=getElementByBizAPPId(n,"INPUT");return getCheckBoxValue(f);break;case"formrichtext":f=getElementByBizAPPId(n,"INPUT");if(!f){return null}return getRichTextBoxValue(f,k);break;case"formrichtextmousemove":f=getElementByBizAPPId(n,"INPUT");if(!f){return null}return getFreeTextBoxValue(f,k);break;case"forminrichtext":f=getElementByBizAPPId(n,"INPUT");if(f){return f.innerHTML}break;case"formradio":f=getElementByBizAPPId(n,"INPUT");var m=f.parentNode.getAttribute("checkedvalue");if(!m){m=f.getAttribute("checkedvalue")}return m;break;case"formtextbox":case"formwatermarkedtextbox":f=getElementByBizAPPId(n,"INPUT");return f.value;break;case"formmultilinetextbox":f=getElementByBizAPPId(n,"TEXTAREA");return f.value;break;case"formcombocolorbox":case"formcombobox":f=getElementByBizAPPId(n,"SELECT");return f.value;break;default:f=getElementByBizAPPId(n,"DIV");return f.value;case"formlistbox":f=getElementByBizAPPId(n,"SELECT");var e="";for(i=0;i<f.options.length;i++){if(f.options[i].selected==true){if(e==""){e=f.options[i].value}else{e+=";"+f.options[i].value}}}return e}return null},LoadQueryDesigner:function(b){var a="Script.asmx?csn=bizapp&cn=query&v="+__bts_;$.cachedScript(BizAPP.UI.GetBasePath(a)).done(function(){b()})},LoadWhiteboard:function(b){var a="Script.asmx?csn=bizapp&cn=whiteboard&v="+__bts_;$.cachedScript(BizAPP.UI.GetBasePath(a)).done(function(){b()})},LoadQueryFieldNames:function(a,e,b){var d=b;if(!d){d=e}if(d){realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetQueryFieldNames",d],false,function(k,m,h){var f=JSON.parse(k.value[1]);$(a).each(function(){var n=$(this);n.autocomplete({source:f,minLength:0,select:function(o,p){if(o.preventDefault){o.preventDefault()}else{o.returnValue=false}this.value=p.item.value;n.change()}});n.focus(function(){$(this).autocomplete("search")})})})}},ProcessCallBacks:function(a,b,e,d){if(typeof(a)!="undefined"&&a.length){$.each(a,function(f,h){try{if(typeof(h)!="undefined"){h(b,e,d)}}catch(k){logError("call back failed.",k)}})}},PrefetchResources:function(){var b={"systemTray.js":"Resources/SystemTray/systemTray.js","json.js":"Resources/Javascripts/JSON/JSON.js","default.min.css":"Resources/TextEditor/default.min.css","jquery-ui.js":"Resources/Javascripts/JQuery/jquery-ui.js","jquery-ui-timepicker-addon.js":"Resources/Javascripts/jquery/jquery-ui-timepicker-addon.js","jquery.signalR.js":"resources/javascripts/jquery.signalR.js","jquery.pnotify.min.js":"resources/javascripts/jquery/jquery.pnotify.min.js","boothubs.js":"resources/javascripts/boothubs.js","jquery.pnotify.default.css":"resources/javascripts/jquery/jquery.pnotify.default.css","jquery.pnotify.default.icons.css":"resources/javascripts/jquery/jquery.pnotify.default.icons.css","BizAPP.ViewCustomization.js":"resources/javascripts/BizAPP.ViewCustomization.js","jquery.reject.js":"resources/jReject/jquery.reject.js","tablesaw.js":"Resources/ResponsiveGrid/tablesaw.js","tablesaw.css":"Resources/ResponsiveGrid/tablesaw.css","zeroclipboard.js":"Resources/ZeroClipboard/ZeroClipboard.js","infragistics.core.js":"Resources/Javascripts/Infragistics/infragistics.core.js","infragistics.lob.js":"Resources/Javascripts/Infragistics/infragistics.lob.js","infragistics.theme.css":"Resources/CRM/Infragistics/themes/infragistics/infragistics.theme.css","infragistics.css":"Resources/CRM/Infragistics/structure/infragistics.css","infragistics.dv.js":"Resources/Javascripts/Infragistics/infragistics.dv.js",};var a=$("head");$.each(b,function(e,d){var f;if(BizAPP.UI.IsAbsolutePath(d)){f=d}else{f=d+"?v={0}".format(__bts_)}a.append('<link rel="prefetch" href="{0}"/>'.format(f))})},IsAbsolutePath:function(a){var b=new RegExp("^(?:[a-z]+:)?//","i");return b.test(a)}};BizAPP.UI.Toast={LoadLibrary:function(a){$.getCss("resources/javascripts/jquery/jquery.pnotify.default.css?v="+__bts_);$.getCss("resources/javascripts/jquery/jquery.pnotify.default.icons.css?v="+__bts_);$.cachedScript(BizAPP.UI.GetBasePath("resources/javascripts/jquery/jquery.pnotify.min.js?v="+__bts_)).done(function(b,d){PNotify.prototype.options.styling="brighttheme";PNotify.prototype.options.history={maxonscreen:5,history:false,menu:false,fixed:true,labels:{redisplay:"Redisplay",all:"All",last:"Last"}};a(b,d)})},Notify:function(a){if(typeof PNotify=="undefined"){BizAPP.UI.Toast.LoadLibrary(function(b,d){BizAPP.UI.Toast._notify(a)})}else{BizAPP.UI.Toast._notify(a)}},_notify:function(a){if(!a.keepPrevious){PNotify.removeAll()}addLog(JSON.stringify(a));if(!$("#chat-panel.bza-notifn").length){$("body").append($('<div id="chat-panel" class="bza-notifn" style="height: auto; width: 314px; background: transparent; display: none;"><div class="bza-notifn-window" style="right: 10px; display: block;"></div></div>'));$("#chat-panel.bza-notifn .bza-notifn-window.chat-window").css("max-height",$(window).height().toString()+"px").css("overflow","auto")}new PNotify(a);BizAPP.SystemTray.AddMenu({id:"bza-notifn-menu",html:'<i class="fa fa-bell" title="Events & Alerts"></i>',click:function(){$("#chat-panel.bza-notifn").toggle()}});$("#chat-panel.bza-notifn").show()}};BizAPP.UI.AdvList={loadMore:function(d,a){var b=getElementByBizAPPId(a,"DIV");realAjaxAsyncCall("AdvancedListEx",getNextRequestId(),["LoadMore",d],true,function(m,n,k){m=BizAPP.UI._handleEventsAndExceptions(m,n,k);var h=m[1].split("[DS]"),e=$(b),f=e.find(".al-lr").last();if($(h[0]).is("div")){e.find("[bizapp_eid]").find(".select-filters-sort-bottom").parent().before($(h[0]).html())}else{if(f.length==0){e.find("[bizapp_eid]").find("table").last().after(h[0]);e.find("[bizapp_eid]").find("table").height("auto")}else{f.closest("table").parent().closest("table").after(h[0])}}e.find(".loadmore").replaceWith(h[1])})},CreateSortUI:function(d){var b=$('[id$="'+d+'"]:eq(0)'),a=b.find(".filtertextcontainer");if(a&&!a.find(".sort-decreasing-order").length){var e='<div class="bza-sort-ext"><span class="sort-increasing-order ui-icon ui-icon-carat-1-n" controlname="'+d+'" onclick="BizAPP.UI.AdvList.Sort(this, true);"></span>                             <span class="sort-decreasing-order ui-icon ui-icon-carat-1-s" controlname="'+d+'" onclick="BizAPP.UI.AdvList.Sort(this, false);"></span></div>';a.append(addWindowEvent(e));a.find(".filtertextbox").css("width","89%");b.find('[class*="creasing-order"]').hover(function(){$(this).css("transform","scale(1.5)")},function(){$(this).css("transform","scale(1)")});$("body").on("hover",'[class*="creasing-order"][onclick="null"]',function(){$(this).css("border","initial")})}},Sort:function(e,d){var a=$(e).attr("controlname");advList=$('[id$="'+$(e).attr("controlname")+'"][bza_data]:eq(0)'),sortBy=$(e).parent().prev().attr("columnname");if(d){$(e).next().attr("onclick","BizAPP.UI.AdvList.Sort(this, false)");console.log('Sorted by "'+sortBy+'" in increasing order')}else{$(e).prev().attr("onclick","BizAPP.UI.AdvList.Sort(this, true)");console.log('Sorted by "'+sortBy+'" in decreasing order')}$(e).attr("onclick","null");var b=JSON.parse(advList.attr("bza_data"));b.sortod=d;b.sortcn=sortBy;b.filters=getFilter(a);ajaxAsyncCall("AdvancedListEx",["UpdateGridProps",JSON.stringify(b)],true,true)},Render:function(a){var b=BizAPP.UI.AdvList._render(a.template,a.data);if(!b){b=a.ert}$(getElementByBizAPPId(a.ctrlid,"DIV")).find(".bza_al_dc").first().append(b)},_render:function(b,e){var d="";var a=typeof e=="string"?JSON.parse(e):e;$.each(a,function(f,h){d+=b.replace(/\#([\w\.\s]*)\#/g,function(o,m){var n=m.split("."),k=h[n.shift()];for(f=0,l=n.length;f<l;f++){k=k[f]}return(typeof k!=="undefined"&&k!==null)?k:""}).replace(/{{([\w\.\s]*)}}/g,function(o,m){var n=m.split("."),k=h[n.shift()];for(f=0,l=n.length;f<l;f++){k=k[f]}return(typeof k!=="undefined"&&k!==null)?k:""})});return d}};BizAPP.UI.InlinePopup={ActivePopupStack:[],_template:"",_excpList:[],_alertHTML:'<div class="tmask" style="opacity: 0.7; display: block;"></div>                        <div class="bza-alrtCont" style="text-align:left;display:none;">                        <div class="bza-alrtTitle"><span class="ui-icon ui-icon-alert" style="display: inline-block;vertical-align:bottom;float:left;"></span><span style="float:left;">Error</span><div id="next_prev" style="display:inline!important;font-size:11px;"><span class="next" title="Next" style="float:right;cursor:pointer;padding-left:2px" onclick="">></span><span class="prev" title="Prev" style="float:right;cursor:pointer;" onclick=""><  <span id="status"></span></span></div></div>                        <div class="bza-alrtBody">                        <div class="bza-alrtContent" exception="0" style="max-height:300px;overflow:auto;">                        <pre style="display:block;overflow:auto;"></pre></div>                        <div class="bza-alrtFooter">                        <div class="right" onclick="$(this).closest(\'.bza-alrtCont\').prev().remove();$(this).closest(\'.bza-alrtCont\').remove();return cancelBubble(event);" style="height:27px;width:auto;background-color:#F0F0F0!important">                        <div class="bza-alrtDefaultBtn"><div></div></div>                        <div class="bza-alrtAddnBtn" onclick="zoomout();"><div></div></div></div>                        <div id="bza_td" class="bza-alrtAddnBtn" title="Technical Details" style="float: left;" onclick="$(\'.bza-alrtContent .err-tech\').toggle(\'Fade\')">                        <div style="font-weight: normal"><i class="fa fa-ellipsis-h"></i></div></div>&nbsp;						<div id="bza_cb" class="bza-alrtAddnBtn bza-cb" title="Copy" data-clipboard-target="" data-clipboard-text="" style="float: left;">                        <div style="font-weight: normal"><i class="fa fa-clipboard"></i></div></div><span class="bza-alrtMsg"></span></div></div></div><style>.err-tech{display:none; padding-top: 1rem; font-size: .8rem;}</style>',Alert:function(a){a.addnInfo=a.addnInfo||"";if($(".bza-alrtCont").length==0){BizAPP.UI.InlinePopup._excpList=[];$("body").append(BizAPP.UI.InlinePopup._alertHTML);var b=$(".bza-alrtCont");if(!a.type){a.type="Error"}b.addClass("bza-alrtCont-"+a.type.toLowerCase());b.find(".bza-alrtTitle span")[1].innerHTML=a.type;b.prev().css({width:$(document).width(),height:$(document).height()});if(a.title){$(".bza-alrtContent").prepend(a.title)}if(a.header){b.find(".bza-alrtTitle span")[1].innerHTML=a.header}if(a.errorMessage){$(".bza-alrtContent pre").append(a.errorMessage+"\r\n"+a.addnInfo);BizAPP.UI.InlinePopup._excpList.push(a.errorMessage+"\r\n"+a.addnInfo)}if(!a.btnOk){$(".bza-alrtDefaultBtn").css("display","none")}else{$(".bza-alrtDefaultBtn div").append(a.txtOk);if(a.txtOkOnclick){$(".bza-alrtDefaultBtn div").attr("onclick",a.txtOkOnclick)}else{if(a.fnOkOnclick){$(".bza-alrtDefaultBtn div").on("click",a.fnOkOnclick)}}}if(!a.btnCancel){$($(".bza-alrtAddnBtn")[0]).css("display","none")}else{$($(".bza-alrtAddnBtn div")[0]).append(a.txtCancel);if(a.txtCancelOnclick){$($(".bza-alrtAddnBtn div")[0]).attr("onclick",a.txtCancelOnclick)}else{if(a.fnCancelOnclick){$($(".bza-alrtAddnBtn div")[0]).on("click",a.fnCancelOnclick)}}}if(a.hideAddnBtns){$(".bza-alrtAddnBtn").hide()}setTimeout(function(){b.css({position:"fixed",left:($(window).width()-b.outerWidth())/2,display:"block",top:"30px"})},1000)}else{BizAPP.UI.InlinePopup._excpList.push(a.errorMessage)}if(BizAPP.UI.InlinePopup._excpList.length==1){$("#next_prev").hide()}else{$("#next_prev #status").html("1/"+BizAPP.UI.InlinePopup._excpList.length).show();$("#next_prev .next").unbind("click").click(function(){var f=$(".bza-alrtContent");var h=f.attr("exception");var d=BizAPP.UI.InlinePopup._excpList.length;if(parseInt(h)<d-1){$(".bza-alrtContent pre").html(BizAPP.UI.InlinePopup._excpList[parseInt(h)+1]);f.attr("exception",parseInt(h)+1);var e=parseInt(h)+1+1;$("#next_prev #status").html(e+"/"+d)}});$("#next_prev .prev").unbind("click").click(function(){var e=$(".bza-alrtContent");var f=e.attr("exception");if(parseInt(f)>0){$(".bza-alrtContent pre").html(BizAPP.UI.InlinePopup._excpList[parseInt(f)-1]);e.attr("exception",parseInt(f)-1);var d=parseInt(f);$("#next_prev #status").html(d+"/"+BizAPP.UI.InlinePopup._excpList.length)}});$("#next_prev").show()}jqExtns();if(!a.hideTechnicalDetails){BizAPP.UI.ClipBoard.Init($("#bza_cb"),$("#err_tech"))}else{$("#bza_td, #bza_cb").hide()}},procVisible:false,Confirm:function(d){BizAPP.UI.InlinePopup.procVisible=$("div#Processing:visible").length>0;if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(false,true)}if(!d.type){d.type="Confirm"}var b=d.okCallback;var a=d.cancelCallback;BizAPP.UI.InlinePopup.Alert({title:"",errorMessage:d.message,type:d.type,hideTechnicalDetails:true,btnOk:true,txtOk:"OK",txtOkOnclick:b,btnCancel:true,txtCancel:"Cancel",txtCancelOnclick:a,fnOkOnclick:d.fnOkOnclick,fnCancelOnclick:d.fnCancelOnclick})},getActivePopup:function(a){if(BizAPP.UI.InlinePopup.ActivePopupStack.length==0){return g_activeTINYPopup}else{if(a){return BizAPP.UI.InlinePopup.ActivePopupStack.pop()}else{return BizAPP.UI.InlinePopup.ActivePopupStack[BizAPP.UI.InlinePopup.ActivePopupStack.length-1]}}},CreateNew:function(a){if(!a.height){a.height=0}if(!a.width){a.width=0}if(a.html){a.html=a.html.replace(/\[BSQ]/g,"'").replace(/\[BDQ]/g,'"').replace(/\[BSRQ]/g,"\r").replace(/\[BSNQ]/g,"\n").replace(/\[BSTQ]/g,"\t")}BizAPP.UI.TransformUI($(a.html),function(b){var f="";b.each(function(k,h){if(h&&h.outerHTML){f+=h.outerHTML}});a.html=f;if(a.iframe&&a.iframe.toLowerCase().indexOf("uploadpage.aspx")==-1){if(!a.height){a.height=window.innerHeight-100}if(!a.width){a.width=window.innerWidth-200}}a.closejs=function(){if(a.strclosejs){execute(a.strclosejs)}a.instance.remove();delete a.instance;BizAPP.UI.InlinePopup.getActivePopup(true);var h=BizAPP.UI.InlinePopup.getActivePopup(false);if(h){$(h.tinner()).closest(".tbox").toggle()}BizAPP.UI.InlinePopup._setTINYPosition()};a.openjs=function(){BizAPP.UI.InlinePopup.ActivePopupStack.push(d);if(a.stropenjs){execute(a.stropenjs)}BizAPP.UI.TabControl.ResponsiveInit();BizAPP.UI.InlinePopup._setTINYPosition()};var e=BizAPP.UI.InlinePopup.getActivePopup(false);if(e){$(e.tinner()).closest(".tbox").toggle()}var d=TINYBOX();a.instance=d;d.show(a);return d})},_setTINYPosition:function(t){var e=BizAPP.UI.InlinePopup.getActivePopup(false);if(!e){return}var f=$(e.tinner()),p=null,q=null,h=f.find("[popupwidth]").length>0,n=$(f).find(".tcontent");var m=false,d=false,a=$.grep(n.find("*:visible"),function(u){return $(u).closest("div.grid[bizapp_eid]").length==0});$.each(a,function(){if(!m&&(this&&$(this).css("overflow")!="visible"&&this.scrollWidth>$(this).innerWidth())){m=true}if(!d&&(this&&$(this).css("overflow")!="visible"&&this.scrollHeight>$(this).innerHeight())){d=true}});a=$(a);f.find("[popupwidth]").length>0?p=f.find("[popupwidth]").attr("popupwidth"):p=Math.max.apply(null,a.map(function(){var u=$(this).width();if(m&&this!=n.children()){var v=$(this).parentsUntil(n);$.each(v,function(){if(this&&$(this).css("overflow")!="visible"&&this.scrollWidth>$(this).innerWidth()){u=0;return false}})}return u}).get());f.find("[popupheight]").length>0?q=f.find("[popupheight]").attr("popupheight"):q=Math.max.apply(null,a.map(function(){var v=$(this).outerHeight(true);if(d&&this!=n.children()){var u=$(this).parentsUntil(n);$.each(u,function(){if(this&&$(this).css("overflow")!="visible"&&this.scrollHeight>$(this).innerHeight()){v=0;return false}})}return v}).get());var b=false;var o=f.find('[bza-ctrlid="SearchControl"]').length>0;var k=f.find(".searchcaptionrow").length>0;if(h){p=parseInt(p),q=parseInt(q);f.height(q);f.width(p);b=true}else{o=k?false:o;f.height(o?q:"auto");b=true;f.width(p);b=true}if(f.innerHeight()>(window.innerHeight-40)||f.innerHeight()>(document.documentElement.clientHeight-40)||f.innerHeight()>(document.body.clientHeight-40)){f.parent(".tbox").css("position","absolute");b=true}if(f.innerWidth()>(window.innerWidth-40)||f.innerWidth()>(document.documentElement.clientWidth-40)||f.innerWidth()>(document.body.clientWidth-40)){f.parent(".tbox").css("position","absolute");b=true}if(b){e.resize()}},DisableAnimate:function(){var a=isIE();return(a>0&&a<8)},GetMarkupWithTemplate:function(d){if(!BizAPP.UI.InlinePopup._template){BizAPP.UI.InlinePopup._template='<style>.pqube_popup { min-width:500px;}	        .pqube_header {margin-bottom: 5px;padding: 10px;background: #123F76;color: white;}            .pqube_header_title {max-width:800px; text-overflow: ellipsis; overflow: hidden; white-space:nowrap; }            .pqube_popupbody { max-height:400px;overflow:auto; }            .stepcontainer { border-top:solid 2px black;margin:5px;padding-top:5px; }            .stepcenternormal{ padding:5px!important;margin:5px!important; }            .tinner { padding:0 }            .tclose { display:none }            </style><div class="pqube_popup"><table class="fill"><tr><td><div class="pqube_header"><div class="pqube_header_title"><!--headline--></div></div></td></tr><tr><td><div class="pqube_popupbody"><!--body--></div></td></tr><tr><td><div class="stepcontainer"><div class="left-footer" style="float:left"><!--leftlinks--></div><div class="right-footer" style="float:right"><table><tr><td><!--steps--></td><td><!--close--></td></tr></table></div></div></td></tr></table></div>'}d=$.extend({headline:"",body:"",steps:""},d);var b=$(BizAPP.UI.InlinePopup._template);var e=BizAPP.UI.Control._getCommentNodes(b).filter(function(){return this.nodeValue=="headline"});if(e.length){b.find(e[0]).replaceWith($(d.headline))}var f=BizAPP.UI.Control._getCommentNodes(b).filter(function(){return this.nodeValue=="body"});if(f.length){b.find(f[0]).replaceWith($(d.body))}var h=BizAPP.UI.Control._getCommentNodes(b).filter(function(){return this.nodeValue=="steps"});if(h.length){b.find(h[0]).replaceWith($(d.steps))}var a="";b.each(function(m,k){if(k&&k.outerHTML){a+=k.outerHTML}});return a},ShowConfMsg:function(a){debug(a,"exception")}};BizAPP.UI.Control={CheckParentControl:function(d,e,h){var a=e=="replaceself"?h:e,b=getElementByBizAPPId(a);if(!b){var f=d+" - parent with id '"+a+"' not found.";addLog(f,true);throw f}return b},SetAttributes:function(b,a){if(a){$.each(a,function(e,d){b.attr(e,d)})}},_getCommentNodes:function(a){return a.find("*").contents().filter(function(){return this.nodeType==8})},_getPlaceHolderCommentNodes:function(a){return BizAPP.UI.Control._getCommentNodes(a).filter(function(){return this.nodeValue!="STARTPOMIT"&&this.nodeValue!="ENDPOMIT"})}};BizAPP.UI.Label={templatetext:'<span id="{0}" tabindex="-1" class="{1}" bizappid="{0}" bza-ctrlid="{2}" style="display:inline-block;font-weight:normal;height:{4};width:{5};position:absolute;left:{7};top:{6}">{3}</span>',Create:function(b,a,h,e,o,p,d,m,f){var n=BizAPP.UI.Control.CheckParentControl("label",b,a);h="LabelEx "+h;var k=BizAPP.UI.Label.templatetext.format(a,h,e,o,p,d,m,f);if(b=="replaceself"){$(n).replaceWith(k)}else{$(n).append(k)}}};BizAPP.UI.Textbox={sltemplatetext:'<input type="text" id="{0}" class="{1}" bizappid="{0}" bza-ctrlid="{2}" style="height:{4};width:{5};position:absolute;left:{7};top:{6};" tabindex="{8}" onclick="{9}">',mltemplatetext:'<textarea rows="2" cols="20" id="{0}" class="{1}" bizappid="{0}" bza-ctrlid="{2}" style="height:{4};width:{5};position:absolute;left:{7};top:{6};" tabindex="{8}" onclick="{9}"></textarea>',Create:function(d,b,p,f,v,w,e,q,k,o,z,h,u,n){var t=BizAPP.UI.Control.CheckParentControl("textbox",d,b),m="";p="TextboxEx "+p;m=typeof h==="string"&&h==="true"?BizAPP.UI.Textbox.mltemplatetext:BizAPP.UI.Textbox.sltemplatetext;m=m.format(b,p,f,v,w,e,q,k,o,z);if(d=="replaceself"){$(t).replaceWith(m)}else{$(t).append(m)}var a=$(getElementByBizAPPId(b));a.val(u);BizAPP.UI.Control.SetAttributes(a,n)},AutoComplete:function(ctrlId){var ctrl=$(getElementByBizAPPId(ctrlId,"input"));if(!ctrl||ctrl.length==0){return}addLog("autocomplete {0} ".format(ctrlId));ctrl.autocomplete({minLength:1,open:function(){if(!$(this).attr("bza-ac")){$(this).attr("bza-ac",$(this).attr("onchange"));$(this).removeAttr("onchange")}},close:function(){setTimeout(function(){$(this).attr("onchange",$(this).attr("bza-ac"));$(this).removeAttr("bza-ac")},1000)},source:function(request,response){realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetAutoCompleteResults",ctrl.closest("[bizapp_context]").attr("bizapp_context").split("\n")[0],request.term,ctrl.closest("[bizapp_context]").attr("bizapp_eid"),ctrl.attr("bza-ctrlid")],false,function(data,textStatus,jqXHR){data=BizAPP.UI._handleEventsAndExceptions(data,textStatus,jqXHR);var a=$.map(JSON.parse(data[1]),function(item){return{value:item.value||item.Value,label:item.autocompletelabel||item.label||item.DisplayValue||item.value||item.Value}});if(ctrl.attr("bza-create")==1){a.push({value:"bza-create",label:" -- Create New -- "})}response(a);if(a.length==0){ctrl.attr("onchange",ctrl.attr("bza-ac"));ctrl.removeAttr("bza-ac")}})},select:function(event,ui){if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}if(ui.item.value=="bza-create"){var a=ctrl.attr("bizappid").slice(0,-1)+"2";a=getElementByBizAPPId(a,"SPAN");$(a).click()}else{this.value=ui.item.value;eval($(this).attr("bza-ac"))}},focus:function(event,ui){if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}$(this).val(ui.item.label)}})},setValue:function(f){var e=false,b;if(!g_locked){if(f.getText){e=true;g_locked=true;var d=f.ID.split("[sep]");var a=$('[bza-ctrlid="'+d[1]+'"]');if(a.length==1){b=$(a[0])}else{if(a.length>1){$.each(a,function(){if($(this).closest("[bizapp_name]").attr("bizapp_eid")==d[0]){b=$(this);return false}})}}}b=e?b:$(f),container=b.closest("[bizapp_name]"),view=container.hasClass("ViewControlEx")?container:b.closest("[bizapp_name].ViewControlEx"),text=e?f.getText():b.val();if(!container.length){g_locked=false;return}if(text=="<br>"){text=""}if(!_allowScriptTagInput__&&text.toLowerCase().indexOf("<script>")!=-1){debug("A potentially dangerous Request value was detected from the client.","exception");g_locked=false;return}var h=["SetAndRefreshDependentFields","",(!container.hasClass("ViewControlEx")).toString(),container.attr("bizapp_eid"),b.hasClass("hasDatepicker")?b.parent().attr("bza-ctrlid"):b.attr("bza-ctrlid"),container.attr("bizapp_context")?container.attr("bizapp_context").split("\n")[0]:"",view.attr("bizapp_eid"),view.attr("bizappid"),text];g_callBacks.push(function(){g_locked=false});callOutline(h)}},EnhanceAutoComplete:function(b){b.passValueSet=b.passValueSet||false;var d=$(b.selector);var a=b.minLength;if(a==undefined){a=1}d.autocomplete({minLength:a,source:function(k,f){var e=d.attr("bza_fields"),h;if(d.attr("bza_qid")){if(b.passValueSet){h=["GetAutoCompleteSugestions",d.attr("bza_qid"),k.term,e,b.userStatus,d.attr("bizapp_context"),BizAPP.ViewCustomization.DynamicReport.ConstructValueSet()]}else{h=["GetAutoCompleteSugestions",d.attr("bza_qid"),k.term,e,b.userStatus,d.attr("bizapp_context")]}}else{if(d.attr("bizapp_context")){h=["GetAutoCompleteResults",d.attr("bizapp_context"),k.term,"",e,d.attr("bza_basefield"),d.attr("bza_typeid")]}else{displayMessage("query or context is mandatory");return}}realAjaxAsyncCall("HelperEx",getNextRequestId(),h,false,function(o,p,n){o=BizAPP.UI._handleEventsAndExceptions(o,p,n);e=e.split(",");var m=null;if(d.attr("bza_qid")){m=$.map(JSON.parse(o[1]),function(q){var t="";if(e.length==1){t=q[e[0]]}else{if(b.format){if(!t){t=b.format}$.each(e,function(u){t=t.replace("{"+u.toString()+"}","{0}");t=t.format(q[e[u]])})}else{$.each(e,function(){if(t){t+=", "}t+=this+" : "+q[this]})}}if(b.userStatus=="true"){t=(q.Status=="1"?"?":"?")+" - "+t}return{value:b.value?q[b.value]:q.uniqueid,label:t,status:q.Status,identifier:q.uniqueid+":"+q.objecttype+":-1",addnData:q}})}else{m=$.map(JSON.parse(o[1]),function(q){return{value:q.label||q.value||q.Value,label:q.autocompletelabel||q.label||q.value||q.Value,identifier:q.value||q.Value}})}f(m)})},position:{collision:"flip"},select:function(e,f){console.log(f.item);b.selectCallback(e,f);if(b.passValueSet){e.stopPropagation()}if(b.userStatus=="true"){d.val("");return false}}})},StaticEnhanceAutoComplete:function(a){if(typeof a.selectionValues!="undefined"||a.consumeSearchTerm){BizAPP.UI.Textbox.InnerStaticEnhanceAutoComplete(a);a.callback();return}BizAPP.UI.Textbox.FetchAutoCompleteResult(a,"",function(b){var e=typeof b[1]!="string"?JSON.stringify(b[1]):b[1];a.selectionValues=e;BizAPP.UI.Textbox.InnerStaticEnhanceAutoComplete(a);if(a.callback){a.callback(b[1])}})},FetchAutoCompleteResult:function(e,b,h){e.passValueSet=e.passValueSet||false;var f=$(e.selector);var a=f.attr("bza_fields"),d;if(f.attr("bza_qid")){if(e.passValueSet){d=["GetAutoCompleteSugestions",f.attr("bza_qid"),b,a,e.userStatus,f.attr("bizapp_context"),BizAPP.ViewCustomization.DynamicReport.ConstructValueSet()]}else{d=["GetAutoCompleteSugestions",f.attr("bza_qid"),b,a,e.userStatus,f.attr("bizapp_context")]}}else{if(f.attr("bizapp_context")){d=["GetAutoCompleteResults",f.attr("bizapp_context"),b,"",a,f.attr("bza_basefield"),f.attr("bza_typeid")]}else{displayMessage("query or context is mandatory");return}}realAjaxAsyncCall("HelperEx",getNextRequestId(),d,false,function(m,n,k){m=BizAPP.UI._handleEventsAndExceptions(m,n,k);h(m)})},FormatAutoCompleteResponse:function(h,e){if(!h){return}var f=$(e.selector);var b=f.attr("bza_fields");var d=null;if(f.attr("bza_qid")){d=$.map(JSON.parse(h),function(a){var k="";if(b.length==1){k=a[b[0]]}else{if(e.format){if(!k){k=e.format}$.each(b,function(m){k=k.replace("{"+m.toString()+"}","{0}");k=k.format(a[b[m]])})}else{$.each(b,function(){if(k){k+=", "}k+=this+" : "+a[this]})}}if(e.userStatus=="true"){k=(a.Status=="1"?"?":"?")+" - "+k}return{value:e.value?a[e.value]:a.uniqueid,label:k,status:a.Status,identifier:a.uniqueid+":"+a.objecttype+":-1",addnData:a}})}else{d=$.map(JSON.parse(h),function(a){return{value:a.label||a.value||a.Value,label:a.autocompletelabel||a.label||a.value||a.Value,identifier:typeof a.value!="undefined"?a.value:a.Value}})}return(d)},InnerStaticEnhanceAutoComplete:function(b){b.passValueSet=b.passValueSet||false;var d=$(b.selector);var a=b.minLength;if(a==undefined){a=1}d.autocomplete({minLength:a,source:function(k,h){if(!b.consumeSearchTerm){var e=BizAPP.UI.Textbox.FormatAutoCompleteResponse(b.selectionValues,b);h(e)}else{var f=k.term.split(/,\s*/).pop();BizAPP.UI.Textbox.FetchAutoCompleteResult(b,f,function(n){var o=typeof n[1]!="string"?JSON.stringify(n[1]):n[1];var m=BizAPP.UI.Textbox.FormatAutoCompleteResponse(o,b);h(m)})}},position:{collision:"flip"},select:function(e,f){console.log(f.item);b.selectCallback(e,f);if(b.passValueSet){e.stopPropagation()}if(b.userStatus=="true"){d.val("");return false}}})},Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.DateTime={g_default:{},Init:function(id,wm,mode,interval,addnInfo){var dp=$(getElementByBizAPPId(id,"input"));if(wm){dp.attr("title",wm);dp.attr("placeholder",wm)}var options={showButtonPanel:true,changeMonth:true,changeYear:true,dateFormat:"dd-M-yy",showOn:"button",buttonImage:"resources/images/common/date.png",buttonImageOnly:true,yearRange:"1900:2100"};if(addnInfo){addnInfo=JSON.parse(addnInfo);if(addnInfo.minDate){options.minDate=addnInfo.minDate}if(addnInfo.maxDate){options.maxDate=addnInfo.maxDate}}var tzdd=dp.closest(".DateEx").find("select");if(tzdd.length>0){var parent=dp.closest(".DateEx");parent.html('<table cellspacing="0" cellpadding="0"><tr><td></td><td></td></tr></table>');$(parent.find("td").get(0)).html(dp);$(parent.find("td").get(1)).html(tzdd);tzdd.width(parent.width()/2);dp.width((parent.width()/2)-20)}if(mode=="ShowTimePicker"){options.controlType="select";options.timeFormat="hh:mm TT";options.showTime=false;options.showOn="both";options.onClose=function(dateText,inst){if(dateText!=dp.attr("oldval")){eval($(this).attr("bza-oc"))}};options.stepMinute=interval;dp.attr("bza-oc",dp.attr("onchange"));dp.removeAttr("onchange");dp.attr("oldval",dp.attr("value"));dp.datetimepicker(options);dp[0].readOnly=true;dp.on("click",function(){dp.next().click()});dp.on("keyup",function(e){if(e.keyCode==8||e.keyCode==46){$(this).val(null)}e.stopPropagation()})}else{if(mode=="MultiDatesPicker"){$.cachedScript(BizAPP.UI.GetBasePath("resources/javascripts/jquery/jquery-ui.multidatespicker.js")).done(function(script,textStatus){dp.addClass("hasDatepicker").hide();dp.parent().append($("<div></div>"));dp=dp.parent().find("div");options.altField='[bizappid="'+id+'"]';options.onSelect=function(dateText,inst){var oldval=$(dp.context).attr("oldval");if(oldval){BizAPP.UI.DateTime.g_default[id]=$($(dp.context).val().split(",")).not(oldval.split(",")).get();if(BizAPP.UI.DateTime.g_default[id]&&!BizAPP.UI.DateTime.g_default[id][0]){BizAPP.UI.DateTime.g_default[id]=$(oldval.split(",")).not($(dp.context).val().split(",")).get()}}$('[bizappid="'+id+'"]').change()};var dates=$(dp.context).val();if(dates){$(dp.context).attr("oldval",dates);options.addDates=$.map(dates.split(","),$.trim)}if(BizAPP.UI.DateTime.g_default[id]&&BizAPP.UI.DateTime.g_default[id][0]){options.defaultDate=$.datepicker.parseDate("dd-M-yy",BizAPP.UI.DateTime.g_default[id][0].trim())}dp.multiDatesPicker(options);dp.parent().find("img").hide()})}else{dp.datepicker(options)}}}};BizAPP.UI.PivotTable={headerTemplate:"<fieldset><legend>{0}</legend></fieldset>",subheaderTemplate:"    <td><strong>{0}</strong></td>",itemTemplate:'<td><select name="{0}" style="width: 300px;"> {1} </select><td>',subItemTemplate:' <option value="{0}"> {1} </option>',resultsBtn:'<td colspan="2"><input type="submit" value="Show Results" onclick="BizAPP.UI.PivotTable.ConstructPivot(\'{0}\');return false;" class="ui-state-default ui-corner-all curPointer ui-button ui-widget"/></td></tr><tr><td colspan="2"><div id="pivottable"></div></td>',formats:["Append","Sum","Average","Count"],ShowPivotOptions:function(a){realAjaxAsyncCall("PivotTableEx",getNextRequestId(),["ShowPivotOptions",a],true,function(f,d,t){f=BizAPP.UI._handleEventsAndExceptions(f,d,t);var k=JSON.parse(f[1]),h=BizAPP.UI.PivotTable.headerTemplate.format("Configuration Parameters"),p=BizAPP.UI.PivotTable.subheaderTemplate.format("X Axis : "),n=BizAPP.UI.PivotTable.subheaderTemplate.format("Y Axis : "),q=BizAPP.UI.PivotTable.subheaderTemplate.format("Value : "),o=BizAPP.UI.PivotTable.subheaderTemplate.format("Format : ");var u="",b="",m="",e="";$.each(BizAPP.UI.PivotTable.formats,function(){u+=BizAPP.UI.PivotTable.subItemTemplate.format(this,this)});$.each(k,function(z,w){b+=BizAPP.UI.PivotTable.subItemTemplate.format(z,z);m+=BizAPP.UI.PivotTable.subItemTemplate.format(z,z);e+=BizAPP.UI.PivotTable.subItemTemplate.format(z,z)});p+=BizAPP.UI.PivotTable.itemTemplate.format("xaxis",b);n+=BizAPP.UI.PivotTable.itemTemplate.format("yaxis",m);q+=BizAPP.UI.PivotTable.itemTemplate.format("value",e);o+=BizAPP.UI.PivotTable.itemTemplate.format("format",u);BizAPP.UI.InlinePopup.CreateNew({html:"<div>"+h+"<table><tr>"+p+"</tr><tr>"+n+"</tr><tr>"+q+"</tr><tr>"+o+"</tr><tr>"+BizAPP.UI.PivotTable.resultsBtn.format(a)+"</tr></table></div>"})})},ConstructPivot:function(e){var f=$("select[name=xaxis]").val();var a=$("select[name=yaxis]").val();var b=$("select[name=value]").val();var d=$("select[name=format]").val();realAjaxAsyncCall("PivotTableEx",getNextRequestId(),["ConstructPivot",e,f,a,b,d],true,function(n,o,m){n=BizAPP.UI._handleEventsAndExceptions(n,o,m);$("#pivottable").html(BizAPP.UI.PivotTable.headerTemplate.format("Results")+n[1]);var h=$(BizAPP.UI.InlinePopup.getActivePopup().tinner());h.children(".tcontent").css("min-width",h.find(".gridcontrol").width());BizAPP.UI.InlinePopup._setTINYPosition(true);if(d!==BizAPP.UI.PivotTable.formats[0]){var k=$("#pivottable td").filter(function(){var p=$(this).text().trim();if(p){if(d===BizAPP.UI.PivotTable.formats[1]||d===BizAPP.UI.PivotTable.formats[2]){if(p.indexOf(",")!=-1){return true}}else{return true}}return false});$.each(k,function(){var p=$(this).text().split(","),q="";if(d===BizAPP.UI.PivotTable.formats[1]||d===BizAPP.UI.PivotTable.formats[2]){q=0;$.each(p,function(){q+=parseInt(this)});if(d===BizAPP.UI.PivotTable.formats[2]){q=q/p.length}}else{q=p.length}$(this).html(q)})}})}};var g_reauthCHC,g_reauthinterval,g_reauthActive=false;BizAPP.UI.ReAuth={Prompt:function(a){if(!g_reauthActive){g_reauthActive=true;BizAPP.UI.ReAuth._options=a;if(a.type==8){a.html='<div style="width:300px;"><p><i class="fa fa-3x fa-key" style="float:left; padding-right:.5rem"></i><b>A code has been sent to your emailid.<br>Enter the code to continue</b></p><input id="reauthcode" style="padding:.5rem;width:90%" type="number" class="formtextbox" placeholder="Code"></input><p style="text-align:right"><span class="stepcenternormal lnkbtn" onclick="BizAPP.UI.ReAuth.SubmitVerificationCode();">Continue</span></p></div>'}BizAPP.UI.InlinePopup.CreateNew(a)}},_options:null,SubmitVerificationCode:function(){var a=BizAPP.UI.ReAuth._options;ajaxAsyncCall("HelperEx",["ReAuthenticate",a.chc,$("#reauthcode").val(),a.mode,a.type],false,true)}};function callReAuthPrompt(){callHelper("PromptForReAuthentication",g_reauthCHC);$.idleTimer("destroy")}function setUpReAuthIdleTimer(a,b){g_reauthCHC=b;g_reauthinterval=a;startReauthTimer()}function setupReauthTimer(){if(g_reauthinterval){var a=$.data(document,"idleTimerObj");if(a){if(a.idle){return}a.olddate=""}startReauthTimer()}}function startReauthTimer(){$(document).bind("idle.idleTimer",callReAuthPrompt);$.idleTimer(g_reauthinterval*1000)}function callAuthenticate(d,b){var a=$(".reauthTable").find("[type=password]").val();ajaxAsyncCall("HelperEx",["ReAuthenticate",d,a,b])}function callContinueApplyAction(d,b){var a=$("#bizappRejctReason").val();ajaxAsyncCall("OutlineEx",["ContinueApplyAction",d,a,b],false,true)}var g_reauthenticated=false;function reauthCompleteHandler(b,a){if(!g_reauthenticated){callCleanupExecutionSeq(b,a)}}function callCleanupExecutionSeq(b,a){ajaxAsyncCall("HelperEx",["CleanupExecutionSequence",b,a],false,true)}BizAPP.UI.Profiler={Process:function(a){$.each($("[bza-inittime]:not([bza-profproc])"),function(){var e=$(this).attr("bza-inittime"),b="ui-icon",d="ui-state-highlight";e=parseInt(e);if(e>100){b+=" ui-icon-alert";d="ui-state-error"}else{if(e>50){b+=" ui-icon-notice";d="ui-state-error"}else{b+=" ui-icon-info"}}$(this).attr("bza-profproc","");e=$(this).attr("bza-ctrlid")+" - "+e;$(this).prepend('<span class="{2}" style="display:inline-block;cursor:pointer"><span class="{0}" title="{1} ms"></span></span>'.format(b,e,d))})}};BizAPP.UI.Tree={_initLoader:function(a){BizAPP.UI.LoadInfragistics(a)},Drilldown:function(a){ajaxAsyncCall("TreeEx",["Drilldown",$(a).attr("bza-roid"),$(a).attr("bza-view"),$(a).attr("bza-viewname")],false,false)},Create:function(h,d,a,f,e,b){BizAPP.UI.LoadInfragistics(function(){var k=$(getElementByBizAPPId(h));k.attr("bza-baseurl",f);k.attr("bza-chc",e);if(b){$("#treegrid").igTreeGrid({dataSource:"http://localhost:52152/WebService.asmx/GetData",childDataKey:"childData",enableRemoteLoadOnDemand:true,autoGenerateColumns:false,primaryKey:"Name",responseDataKey:"Records",columns:[{headerText:"Name",key:"Name"},{headerText:"Employee ID",key:"ID"},{headerText:"Price",key:"Price"}]})}else{k.igTree({dataSourceType:"json",dataSource:[],checkboxMode:a?"triState":"off",bindings:{textKey:"Text",valueKey:"Value",imageUrlKey:"ImageUrl",childDataProperty:"Nodes"},nodeClick:function(m,o){var n=o.node.element.attr("data-value");if(!n){return}if($(o.node.element).find(">a [onclick]").length>0){return}n=n.split("[VS]");ajaxAsyncCall("TreeEx",["Drilldown",n[0],n[1],n[2]],false,false)},nodeExpanded:function(n,p){var m=p.node.element.attr("bza-populated");if(m=="true"){return}else{p.node.element.attr("bza-populated","true")}var o=p.node.element.attr("data-value");if(!o){return}o=o.split("[VS]");realAjaxAsyncCall("TreeEx",getNextRequestId(),["Expand",p.owner.element.attr("bza-chc"),o[0]],false,function(u,w,t){var v=k.closest("[bza-nodeexpanded]").attr("bza-nodeexpanded");if(v){var q=window[v];if(q){q(p.node.element)}}u=BizAPP.UI._handleEventsAndExceptions(u,w,t);p.owner.element.igTree("removeAt",p.node.path+"_0");BizAPP.UI.Tree.AddNode(h,JSON.parse(u[1]),p.node.element);p.owner.element.igTree("expand",p.node.element)})}});BizAPP.UI.Tree.AddNode(h,d)}})},AddNode:function(h,e,d){var a=$(getElementByBizAPPId(h));if(typeof e==="string"){e=JSON.parse(e)}var f=a.attr("bza-baseurl"),b=BizAPP.UI.GetBasePath("resources/images/common/loading.gif");$.each(e,function(){this.Value=this.Value+"[VS]"+$(d).attr("data-path");if(this.HasCN=="true"){this.Nodes=[{ImageUrl:b,Text:"Loading..."}]}});a.igTree("addNode",e,d);$.each(e,function(){if(this.Tristate!="true"){var k=a.igTree("nodesByValue",this.Value);k.find('span[data-role="checkbox"]').hide()}})},GetSelection:function(e){var b;if(typeof e=="string"){b=$(getElementByBizAPPId(e))}else{b=$(e)}var d=b.igTree("checkedNodes"),a="";$.each(d,function(){if(this.data.Tristate!="true"){return true}var f=this.data.Value.split("[VS]");if(a){a+=","+f[0]}else{a=f[0]}});return a}};BizAPP.UI.LinkControl={customLink:function(d,b,a,e){if(e){BizAPP.UI.InlinePopup.Confirm({message:e,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}BizAPP.UI.LinkControl.customLink1(d,b,a)}})}else{BizAPP.UI.LinkControl.customLink1(d,b,a)}},customLink1:function(h,f,b){var e;var d=false;if(f){var a=specialKeyStatus(f);if(a.ctrlPressed){d=a.ctrlPressed}}if(h){var k=BizAPP.UI.LinkControl._getParams(h);e=["CustomLink",d.toString()].concat(k)}else{e=["LinkControlCallBack",b,d.toString()]}BizAPP.UI.LinkControl._callLink(e)},sequentialLink:function(e,d,b,f,a){if(f){BizAPP.UI.InlinePopup.Confirm({message:f,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}BizAPP.UI.LinkControl.sequentialLink1(e,d,b,a)}})}else{BizAPP.UI.LinkControl.sequentialLink1(e,d,b,a)}},sequentialLink1:function(f,e,d,a){var b;if(f){var h=BizAPP.UI.LinkControl._getParams(f);h.push(a);b=["SequentialLink",null].concat(h)}else{b=["ExecuteSequence",d]}BizAPP.UI.LinkControl._callLink(b);return cancelBubble(e)},_getParams:function(d){var e=$(d).attr("bza-args").split("[VS]");e.push($(d).attr("bza-ctrlid"));var b=$(d).closest("[bizapp_name]"),a=b.hasClass("ViewControlEx")?b:$(d).closest("[bizapp_name].ViewControlEx");e.push(b.attr("bizapp_context")?b.attr("bizapp_context").split("\n")[0]:"");e.push(a.attr("bizapp_eid"));e.push(a.attr("bizappid"));return e},_callLink:function(a){setForceFocus("forcefocus",window.event);setTimeout(function(){ajaxAsyncCall("LinkControlEx",a,false,true)},600)},PromptAndContinueSequence:function(a){BizAPP.UI.InlinePopup.Confirm({message:a.msg,type:"Confirm",fnOkOnclick:function(){if(BizAPP.UI.InlinePopup.procVisible){ProcessingStatus(true,true)}ajaxAsyncCall("HelperEx",["ContinueSequence",a.chc,a.key,a.index],false,true)}})}};function callLnkExeSeq(b,a){BizAPP.UI.LinkControl.sequentialLink(null,b,a)}function exeSqSearchCallBack(d,b,a){if(!a){displayMessage(BizAPP.UI.Localization.NoRecordsSelected);return}g_callBacks.push(zoomout);ajaxAsyncCall("HelperEx",["ExecutionSequenceSearchCallBack",b,a],false,true);return cancelBubble(d)}function getRssUrl(b,a){ajaxAsyncCall("LinkControlEx",["GetRssUrl",a],false,true);return cancelBubble(b)}function handlePrintOption(e,b,h){var f=getElementByBizAPPId(h,"DIV");var k=window.open("","","left=0,top=0,width=800,height=900,toolbar=0,scrollbars=0,status=0");k.document.write(f.innerHTML);k.document.close();k.focus();k.print();return;if(e==null){e=window.event}var d;if(h){var a=getElementByBizAPPId(h,"DIV");d=a.innerHTML}if(d&&d!=undefined&&d!=NaN&&d!=""){ajaxAsyncCall("LinkControlEx",["HandlePrintOption",b,window.location.href.trim("#"),d],false,true)}}function handleContextMenuOnLinkControl(e,d){if(e==null){e=window.event}var h=getElementByBizAPPId("contextmenupopupcontainer","div");if(h){var b;var f;if(e){b=e.clientX;f=e.clientY;var a=getElementPosition(getSourceElement(e));if(a){f=a[1]}if((document.documentElement.offsetWidth-e.clientX)<390){b=document.documentElement.offsetWidth-390}if((document.documentElement.offsetHeight-f)<230){f=document.documentElement.offsetHeight-230}}else{b=document.documentElement.offsetWidth/2-195;f=document.documentElement.offsetHeight/2-144}h.style.display="block";h.style.left=b+"px";h.style.top=f+"px";ajaxAsyncCall("LinkControlEx",["HandleContextMenuOnLinkControl",d,f.toString(),b.toString()],false,true)}}function callRefreshView(a){ajaxAsyncCall("HelperEx",["RefreshView",a],false,true)}function callRefreshListView(a){ajaxAsyncCall("HelperEx",["RefreshListView",a],false,true)}function callLinkControlPostVerb(a){ajaxAsyncCall("LinkControlEx",["CallLinkControlPostVerb",a],false,true)}function lcConfirmMsg(b,a){ajaxAsyncCall("LinkControlEx",["ShowConfirmationMessage",b,a],false,true)}function callLinkControlCallBack(b,a){BizAPP.UI.LinkControl.customLink(null,b,a)}function callLinkControlPrompt(d,a,b){BizAPP.UI.LinkControl.customLink(null,d,a,b)}function isBrowserSupported(a,b){if(isMobile.any()){BizAPP.UI.LoadScript({eid:"ESystemb625e",version:"1",callback:function(){BSO.MobileBanner.Create({appname:JSON.parse(BizAPP.UI.currentApplication).bizappcurrentapplicationname,logo:"testresource.aspx?appid="+JSON.parse(BizAPP.UI.currentApplication).bizappcurrentapplicationuid+"&V="+__bts_})}})}b=b||{};var d=false;if(!a){a={chrome:26,firefox:22,msie:8,safari:6,opera:21,}}b.reject=a;$.cachedScript(BizAPP.UI.GetBasePath("resources/jReject/jquery.reject.js")).done(function(e,f){d=$.reject(b);if(d){$.getCss(BizAPP.UI.GetBasePath("resources/jReject/jquery.reject.css"))}});return !d}function addWindowEvent(a){var b=typeof isFirefox=="function"?isFirefox():isFirefox;if(a&&b){a=a.replace(/onclick="/g,'onclick="window.event=event;').replace(/onchange="/g,'onchange="window.event=event;')}return a}BizAPP.UI.TextEditor={$textArea:null,watermark:"<span class='bza-rte-watermark' style='color:#ccc;'>{0}</span>",_imageUploaderUI:'<div id="drag-and-drop-zoneupload-image" class="uploader" field="Uri" advanced="::0:false:"><div class="browser"><table><tbody><tr style="height:32px;"><td class="uploader-btn"><label><i class="fa fa-folder-open" style="color: #92AAB0;" title="Browse Files"><input type="file" id="uploader" defid="EAppPointd693f" name="files[]" bizappid="AttachmentFileUpload" fileformats="" title="Click to Add files"></i></label></td><td class="uploader-bar"><div id="demo-files"><span class="demo-note">Drop Image Here</span></div></td></td></tr></tbody></table></div></div>',_imageUploaderFound:false,_url:null,_target:null,Init:function(a){var e=BizAPP.UI.controlDependency.type;if(e&&!a.fromControlSet){var d;var b="richtextcontrol";switch(e){case"controlmap":d=BizAPP.UI.controlDependency[b];if(d){d=d+"?v="+__bts_;$.cachedScript(BizAPP.UI.GetBasePath(d)).done(function(f,h){BizAPP.UI.TextEditor.Init(a)})}else{BizAPP.UI.TextEditor.InternalInit(a)}break;case"controlset":a.fromControlSet=true;BizAPP.UI.TextEditor.Init(a);break}}else{BizAPP.UI.TextEditor.InternalInit(a)}},InternalInit:function(a){BizAPP.UI.TextEditor.LoadFontAwesomeCss();$.cachedScript(BizAPP.UI.GetBasePath("resources/texteditor/jquery.sceditor.bbcode.min.js?v="+__bts_)).done(function(d,m){a=a||{ctrlId:"",isReadOnly:false,autoSize:false,showClipboardOptions:true,showFontOptions:true,showFormatOptions:true,showAlignmentOptions:true};var k=$('.RichTextEx[bza-ctrlid="'+a.ctrlId+'"]').find('[name="bbcode_field"]');k.sceditor({readOnly:a.isReadOnly,emoticonsEnabled:false});k.attr("oldval",a.text);var f=k.sceditor("instance");if(a.text){f.setWysiwygEditorValue(a.text)}if(a.isReadOnly){$("div.sceditor-toolbar").hide()}else{f.blur(function(p){var q;var t=f.inSourceMode();if(t){q=f.getSourceEditorValue()}else{q=f.getWysiwygEditorValue()}var o=k.attr("roid");var n=k.attr("ctrlname");if(q.indexOf("bza-rte-watermark")==-1){if(k.attr("oldval")!==q){BizAPP.RuntimeObject.SetFieldValue({roid:o,fieldName:n,fieldValue:q,addOrRemove:false,callback:function(){k.attr("oldval",q)}})}}if((!a.isReadOnly)&&(q.toString().trim()=="")&&a.watermark){if(t){f.setSourceEditorValue(BizAPP.UI.TextEditor.watermark.format(a.watermark))}else{f.setWysiwygEditorValue(BizAPP.UI.TextEditor.watermark.format(a.watermark))}if(t){q=f.getSourceEditorValue()}else{q=f.getWysiwygEditorValue()}}});if(!a.showAlignmentOptions){$('[data-sceditor-command="left"]').parent().hide()}if(!a.showFontOptions){$('[data-sceditor-command="font"]').parent().hide()}if(!a.showFormatOptions){$('[data-sceditor-command="bold"]').parent().hide();$('[data-sceditor-command="bulletlist"]').parent().hide();$('[data-sceditor-command="horizontalrule"]').parent().hide();$('[data-sceditor-command="table"]').parent().hide();$('[data-sceditor-command="youtube"]').parent().hide()}if(a.allowImageInsert&&(!(isIE()&&isIE()<10))){var b=$(".sceditor-container iframe").contents().find("[contenteditable]");b.bind("paste",BizAPP.UI.TextEditor.PasteImage);b.attr("roid","").attr("field","");BizAPP.UI.Upload.RegisterDragDrop(b,function(n){var p="testresource.aspx?aid="+n;var o=$('[name="bbcode_field"]').sceditor("instance");$(o.currentBlockNode()).append($('<div><br></div><img src="'+p+'"/><div><br></div>'))})}}BizAPP.UI.TextEditor.ImportThemeCss();if(isIE()==11){var e=$(".sceditor-container iframe");e.contents().find("body,html").height("100%")}if(a.autoSize){BizAPP.UI.TextEditor.AdjustHeight()}if(!a.isReadOnly){k.sceditor("instance").focus(function(o){var n=k.sceditor("instance").getWysiwygEditorValue();if(n.indexOf("bza-rte-watermark")>0){f.setWysiwygEditorValue("")}})}var h=a.text;if((!a.isReadOnly)&&(h.toString().trim()=="")&&a.watermark){f.setWysiwygEditorValue(BizAPP.UI.TextEditor.watermark.format(a.watermark));f.setSourceEditorValue(BizAPP.UI.TextEditor.watermark.format(a.watermark))}})},AdjustHeight:function(){var b=$(".sceditor-container iframe");b.css("min-height",$('[name="bbcode_field"]').height()-78);b.height(b.contents().find("body").height()+40);var a=b.contents().find("body");a.css({overflow:"hidden"});a.keyup(function(d){b.height(a.height()+40)})},ImportThemeCss:function(){var e=$(".sceditor-container iframe");var a=e.contents().find("head");var b=$('[type="text/css"][class]').clone();a.append(b);var d=e.contents().find("body");d.css("min-height",$('[name="bbcode_field"]').height()-78)},AddCustomLinkInToolbar:function(){var b="Custom Link Clicked";var a=$(".sceditor-toolbar");a.append($('<div class="sceditor-group"><a class="sceditor-button sceditor-button-link text-icon" onclick="alert(\'Custom Link Clicked\');" unselectable="on" title="Custom Link"><div unselectable="on">Custom Link</div></a></div>'))},LoadFontAwesomeCss:function(){BizAPP.UI.LoadDependentFile("font-awesome.min.css");BizAPP.UI.LoadDependentFile("default.min.css")},ReplaceImageUploader:function(){$(".sceditor-button-image").on("click",function(a){$(".sceditor-insertimage div:eq(0)").append(BizAPP.UI.TextEditor._imageUploaderUI);BizAPP.UI.Upload.InitUploadControl("#drag-and-drop-zoneupload-image",location.href.toLowerCase().split("enterpriseview.aspx")[0]+"upload.asmx?roid=&field=&skipsave=false&mode=file&advanced=","0")})},PasteImage:function(a){var d,b;b=false;d=a.originalEvent.clipboardData;$.each(d.types,function(k,m){var h,e;if(b){return}if(d.items[k].type.indexOf("image")!==-1){h=d.items[k].getAsFile();e=new FileReader();var f=$("<img></img>");e.onload=function(o){f.attr("src",o.target.result)};e.readAsDataURL(h);var n=$('[name="bbcode_field"]').sceditor("instance");$(n.currentBlockNode()).append($("<div><br></div>")).append(f).append($("<div><br></div>"));return b=true}})}};BizAPP.UI.Tab={_switchPage:function(e,d){var b=getSourceElement(d);if(b.nodeName.toLowerCase()!="td"){b=$(b).closest("[groupid]")}b=$(b);var a=b.attr("bza-args").split("[VS]");callShowTabPage(d,$(e).attr("bza-args"),b.attr("groupid"),a[0],b[0],a[1]);sltTab(b[0])}};BizAPP.UI.Grid={_queryContainer:'<div class="sort-container sort-container-border" onclick="closeCalendar();callDisplayItems( \'{0}_multiquery\' );event.stopPropagation();"><span class="action-indicator">{1}</span><div class="sort-popup action-menu" id="{0}_multiquery" style="position: absolute;display:none">{2}</div></div>',_queryItem:"<div class=\"item-normal\" onclick=\"BizAPP.UI.Grid._changeMQValue('{2}','{0}');\" onmouseover=\"callHighLightItem( event, 'onmouseover', 'item-normal', 'item-highlighted' );\" onmouseout=\"callHighLightItem( event, 'onmouseout', 'item-normal', 'item-highlighted' );\">{1}</div>",EnhanceGrid:function(h,b,f,d,a,e){if(b){BizAPP.UI.Grid._enhanceMultiQuery(h)}if(f){BizAPP.UI.Grid._enhancePaginator(h)}if(d){BizAPP.UI.Grid._enhanceShowCount(h)}if(a){BizAPP.UI.Grid._enhanceFilter(h,e)}},CombineLinks:function(e){var b=[],f=[],d=$(e.selector+" table[ecols]");d.find("tr").last().find("[bza_lnkgrp]").each(function(){var a=$(this).attr("bza_lnkgrp");if($.inArray(a,f)==-1){f.push(a)}});$.each(f,function(k,a){var h=new Array();$.each(d.find("tr").last().find('td[onclick*="callEvaluateLink"][bza_lnkgrp="'+a+'"]'),function(m,o){h.push(o.cellIndex);$(o).attr("processed","true")});if(h.length>1){BizAPP.UI.Grid.GroupLinks(h,e.selector,a)}});$.each(d.find("tr").last().find('td[onclick*="callEvaluateLink"]:not([processed])'),function(a,h){if(!h.hasAttribute("bza_lnkgrp_exclude")){b.push(h.cellIndex)}});if(b.length>1){BizAPP.UI.Grid.GroupLinks(b,e.selector,"Menu")}},GroupLinks:function(d,b,e){var f=$(b+" table[ecols]");$.each(f.find("tr"),function(k,m){$.each(d,function(n,o){$(m.cells[o]).hide()});if(k==0){$(m).find("th:nth-child("+($(d).last()[0]+1)+")").after("<th>Action</th>")}else{if($(m).attr("roid")){var h="";$.each(d,function(n,o){h+='<div class="clearfix ms_bb1a bdr-5 ms_pb1 ms_pt1" bza-ci="{1}">{0}</div>'.format($(m.cells[o]).html(),o)});var a=$('<td class="bza-link-group">'+e+"</td>");$(m).find("td:nth-child("+($(d).last()[0]+1)+")").after(a);BizAPP.MenuPopup.Create({html:h,selector:a});$(m).find("[bza-ci]").on("click",function(n){n.stopPropagation();$(this).closest("tr")[0].cells[parseInt($(this).attr("bza-ci"))].click()})}else{$(m).find("td:nth-child("+($(d).last()[0]+1)+")").after("<td></td>")}}})},_enhanceMultiQuery:function(f){var e=$(getElementByBizAPPId(f,"div")),d=e.find('select[onchange*="callApplySelectedQuery"]'),a="";if(!d||d.length==0){return}$.each(d.find("option"),function(){a+=BizAPP.UI.Grid._queryItem.format(this.value,this.innerHTML,f)});d.hide();BizAPP.UI.Grid._getPlaceHolder(e,"multiquery").replaceWith(BizAPP.UI.Grid._queryContainer.format(f,d.find("option:selected").text(),a))},_getPlaceHolder:function(b,a){return BizAPP.UI.Control._getPlaceHolderCommentNodes(b).filter(function(){return this.nodeValue==a})},_changeMQValue:function(d,b){var a=$(getElementByBizAPPId(d,"div")).find('select[onchange*="callApplySelectedQuery"]');a.val(b).change()},_enhancePaginator:function(d){var b=$(getElementByBizAPPId(d,"div")),a=b.find(".gpr [class*=gridmovefirst]").closest("table");BizAPP.UI.Grid._getPlaceHolder(b,"paginate").replaceWith(a)},_enhanceShowCount:function(d){var b=$(getElementByBizAPPId(d,"div")),a=b.find(".gridcountresult");BizAPP.UI.Grid._getPlaceHolder(b,"showcount").replaceWith(a)},_enhanceFilter:function(d,b){var a=$(getElementByBizAPPId(d,"div"));BizAPP.UI.Grid._getPlaceHolder(a,"filter").replaceWith('<input class="formtextbox qkfilter" onkeypress="BizAPP.UI.Grid._quickFilter(event,\'{0}\');" value="{1}"/>'.format(d,b))},_quickFilter:function(h,m){if(h==null){h=window.event}if(h&&h.keyCode=="13"){var e=$(getElementByBizAPPId(m,"div")),d=e.find(".qkfilter"),f=e.find('[name="BizAPP.filter"]');var a="";f.each(function(){a+=$(this).attr("bizappid").split(",")[0]+"[SEP]"});a+="[NVS]"+$(d).val();var k=e.find(".gridFilter")[0].onclick.toString().split("callFilter('")[1].split("'")[0];ajaxAsyncCall("AdvancedListEx",["QuickFilter",k,a])}},_addnFieldsMarkupHeadLine:"<span>Additional Fields</span>",_addnFieldsMarkupBody:'<div id="bza_adnFlds_Table"><table cellspacing="0" style="width: 100%; height: 300px;">        <tr valign="top">            <td>                <table>                    <tr>                        <td>Field Name : </td>                        <td>                            <input type="textbox" id="fn" class="formtextbox"/></td>                        <td rowspan="2" style="width: 1%;" class="swmain"><i class="fa fa-angle-double-right btn btn-default" style="float: right;width:auto" onclick="BizAPP.UI.Grid._addNodesToStack();"></i></td>                    </tr>                    <tr>                        <td>Field Alias : </td>                        <td>                            <input type="textbox" id="fa" class="formtextbox"/></td>                    </tr>                </table>            </td>            <td rowspan="2" style="border-left: 1px solid gray;">                Selected Fields (uncheck to remove from list)                <div class="containerTree" style="width: 100%; height: 100%;">                    <div id="left">                        <div id="tree2">                        </div>                    </div>                </div>            </td>        </tr>        <tr valign="top">            <td style="height: 100%;">                <div class="containerTree" style="height: 100%;">                    <div id="left">                        <div id="tree">                        </div>                    </div>                </div>            </td>        </tr></table></div>',_addnFieldsMarkupSteps:'<div><table cellspacing="0" cellpadding="0" align="Left" style="border-collapse:collapse;"><tbody><tr valign="top"><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="S" class="stepcenternormal" onclick="backGroundBlocker( \'true\');BizAPP.UI.Grid._addFields();" prevstate="normal">Ok</span></div></td><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="C" class="stepcenternormal cancelstep" onclick="zoomout();">Cancel</span></div></td></tr></tbody></table></div>',initAddnFieldsPopup:function(a,b,d,e){BizAPP.UI.Tree._initLoader(function(){var h={headline:BizAPP.UI.Grid._addnFieldsMarkupHeadLine,body:BizAPP.UI.Grid._addnFieldsMarkupBody,steps:BizAPP.UI.Grid._addnFieldsMarkupSteps};var f=BizAPP.UI.InlinePopup.GetMarkupWithTemplate(h);BizAPP.UI.InlinePopup.CreateNew({html:f,stropenjs:'$("#bza_adnFlds_Table").attr("chc","'+e+'");BizAPP.UI.Grid.getFields("'+e+'","'+a+'","'+b+'",null,"'+d+'");'})})},getFields:function(a,o,k,f,h,e,b,n,d,m){b=b||"biState";n=n||false;e=e||false;if(typeof(d)=="undefined"){d=true}realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetAdditionalFieldNodes",a,o,k,h,e,d],true,function(w,z,v){var q=BizAPP.UI._handleEventsAndExceptions(w,z,v);var u=JSON.parse(q[1]);var p=u.allFields;var t=u.pqFields;if(!f){BizAPP.UI.LoadInfragistics(function(){$("#bza_adnFlds_Table #tree").igTree({dataSourceType:"json",dataSource:[],checkboxMode:b,bindings:{textKey:"Text",valueKey:"Value",childDataProperty:"Nodes"},nodeExpanded:function(B,D){var A=D.node.element.attr("bza-populated");if(A=="true"){return}else{D.node.element.attr("bza-populated","true")}BizAPP.UI.Grid.getFields(a,D.node.data.Value,D.node.data.FN,D,h,e,b,n,d,m)},nodeCheckstateChanged:function(A,B){BizAPP.UI.Grid._addNodesToStack(B)},nodeClick:function(A,B){$(A.currentTarget).attr("bza-type",B.node.data.Type)},});$("#bza_adnFlds_Table #tree2").igTree({dataSourceType:"json",dataSource:[],checkboxMode:"biState",bindings:{textKey:"Text",valueKey:"Value"},nodeCheckstateChanged:function(A,B){if(B.newState!=="on"){$("#bza_adnFlds_Table #tree2").igTree("removeAt",B.node.path)}}});BizAPP.UI.Grid._loadNodes(p,t,k,f,n,m)})}else{f.owner.element.igTree("removeAt",f.node.path+"_0");BizAPP.UI.Grid._loadNodes(p,null,k,f.node.element,n,m);f.owner.element.igTree("expand",f.node.element)}})},_loadNodes:function(b,d,e,a,f,h){$.each(b,function(k,t){var m=e?e+"."+k:k;var q=f?k:m;if(!t[1]){t[1]=""}var o={Text:f?'<span fielname="{1}" fieldtype="{2}" title="{3}">{0}</span>'.format(q+(t[2]!=null?" ({0})".format(t[2]):""),m,t[3],t[1]):(t[2]!=null?t[2]:k.replace(/([A-Z])/g," $1")),FN:m,Type:t[3],AddnData:t},p=t[0];if(p){o.Value=p;o.Nodes=[{Text:"Loading..."}]}$("#bza_adnFlds_Table #tree").igTree("addNode",o,a)});if(d){$.each(d.split("[_IS]"),function(){if(this&&this.length>0){var m=this.split("[_TVS]");var k={Text:m[1],FN:m[0]};$("#bza_adnFlds_Table #tree2").igTree("addNode",k)}});$.each($("#bza_adnFlds_Table #tree2").igTree("uncheckedNodes"),function(){$("#bza_adnFlds_Table #tree2").igTree("toggleCheckstate",this.element)})}if(a){$(a).find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}else{$("#bza_adnFlds_Table #tree").find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}if(h){h();BizAPP.UI.InlinePopup._setTINYPosition(true)}},_addNodesToStack:function(p){var u=$("#bza_adnFlds_Table #tree").igTree("checkedNodes");var m=$("#bza_adnFlds_Table #tree2").igTree("checkedNodes");for(var k=0;k<u.length;k++){if(u[k].data){var t=p.node.path,q="",n="";$.each(t.split("_"),function(a,b){if(a==t.split("_").length-1){return}if(a!=0){q+="_"}q+=b;n+=p.owner.nodeFromElement(p.owner.nodeByPath(q)).data.Text+"."});n+=u[k].data.Text;var h={FN:u[k].data.FN,Text:n.replace(/\. /g,".")};$("#bza_adnFlds_Table #tree2").igTree("addNode",h)}}var o=$("#bza_adnFlds_Table #fn").val();if(o){var e=$("#bza_adnFlds_Table #fa").val();var h={FN:o,Text:e?e:o.replace(/([A-Z])/g," $1").replace(/\. /g,".")};$("#bza_adnFlds_Table #tree2").igTree("addNode",h);$("#bza_adnFlds_Table #fn").val("");$("#bza_adnFlds_Table #fa").val("")}for(var k=0;k<u.length;k++){if(!u[k].data){continue}var d={Text:u[k].data.Text};for(var f=0;f<m.length;f++){if(m[f].data&&m[f].data.Text==d.Text){$("#bza_adnFlds_Table #tree2").igTree("removeAt",m[f].path);m=$("#bza_adnFlds_Table #tree2").igTree("checkedNodes")}}}$.each($("#bza_adnFlds_Table #tree2").igTree("uncheckedNodes"),function(){$("#bza_adnFlds_Table #tree2").igTree("toggleCheckstate",this.element)});$.each(u,function(){$("#bza_adnFlds_Table #tree").igTree("toggleCheckstate",this.element)});BizAPP.UI.InlinePopup._setTINYPosition(true)},_addFields:function(){var d=$("#bza_adnFlds_Table #tree2").igTree("checkedNodes");var b="";if(d.length>0){$.each(d,function(){if(this.data){b+=this.data.FN+"[_TVS]"+this.data.Text+"[_IS]"}})}g_callBacks.push(zoomout);ajaxAsyncCall("OptGridEx",["ApplyAdditionalFields",$("#bza_adnFlds_Table").attr("chc"),b],true,true)},_chartTemplateHeadLine:"<span>Chart</span>",_chartTemplateBody:'<div id="bza_adnFlds_Table" chc="{0}">            <table class="fill" style="table-layout: fixed;"><tr style="font-weight:bold;text-align: center;"><td style="padding-top:5px">Group By</td><td style="padding-top:5px">Series</td></tr><tr style="font-weight: bold;"><td colspan="2">Query Fields</td></tr><tr><td colspan="2"><hr style="margin-top: auto;margin-bottom: 5px;"/></td></tr><tr><td><div id="treeGroupBy" style="max-height: 100px;overflow: auto;overflow-x: hidden;"></div></td><td><div id="treeSeries" style="max-height: 100px;overflow: auto;overflow-x: hidden;"></div></td></tr><tr><td colspan="2"><hr style="margin-bottom: auto;border-top:0;display:none"/></td></tr><tr style="font-weight: bold;"><td colspan="2">All Fields</td></tr><tr><td colspan="2"><hr style="margin-top: auto;margin-bottom: 5px;"/></td></tr><tr><td><div id="tree1" style="max-height: 200px;overflow: auto;overflow-x: hidden;"></div></td><td><div id="tree2" style="max-height: 200px;overflow: auto;overflow-x: hidden;"></div></td></tr></table>        </div>',_chartTemplateSteps:'<div><table cellspacing="0" cellpadding="0" align="Left" style="border-collapse:collapse;"><tbody><tr valign="top"><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="S" class="stepcenternormal" onclick="backGroundBlocker( \'true\');BizAPP.UI.Grid._displayChart(\'{1}\',\'{2}\',\'{3}\',\'{4}\',\'{5}\',\'{6}\');" prevstate="normal">Ok</span></div></td><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="C" class="stepcenternormal cancelstep" onclick="zoomout();">Cancel</span></div></td></tr></tbody></table></div>',_chartFieldNode:null,initChartPopup:function(b,a,e,m,n,p,d){if(b==null){b=window.event}var o="";var q="";var k=$(getSourceElement(b)),t=k.closest("[bizapp_name]");var h="";if(t.length>0&&t.attr("bizapp_context")){h=t.attr("bizapp_context").split("\n")[0]}BizAPP.UI.Tree._initLoader(function(){});var u={headline:BizAPP.UI.Grid._chartTemplateHeadLine,body:BizAPP.UI.Grid._chartTemplateBody,steps:BizAPP.UI.Grid._chartTemplateSteps};var f=BizAPP.UI.InlinePopup.GetMarkupWithTemplate(u);BizAPP.UI.InlinePopup.CreateNew({html:f.format(a,k.attr("bza-typeid"),m,h,n,p,d),stropenjs:'BizAPP.UI.Grid.getChartFields("'+a+'","'+q+'","'+o+'",null,"'+m+'", true);',strclosejs:"BizAPP.UI.Grid.__chartFieldNode=null"})},getChartFields:function(h,b,d,a,f,e){e=e||false;realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetAdditionalFieldNodes",h,b,d,f,e],true,function(q,t,p){var k=BizAPP.UI._handleEventsAndExceptions(q,t,p);var o=JSON.parse(k[1]);var n=o.allFields;var m=o.pqFields;if(!a){BizAPP.UI.LoadInfragistics(function(){$("#bza_adnFlds_Table #tree1").igTree({dataSourceType:"json",dataSource:[],checkboxMode:"biState",bindings:{textKey:"Text",valueKey:"Value",childDataProperty:"Nodes"},nodeExpanded:function(v,w){var u=w.node.element.attr("bza-populated");if(u=="true"){return}else{w.node.element.attr("bza-populated","true")}BizAPP.UI.Grid.getChartFields(h,w.node.data.Value,w.node.data.FN,w,f)},nodeCheckstateChanged:function(u,w){if(w.newState=="on"){if(BizAPP.UI.Grid.__chartFieldNode&&BizAPP.UI.Grid.__chartFieldNode.node.path==w.node.path){return}BizAPP.UI.Grid.__chartFieldNode=w;var v=$("#bza_adnFlds_Table #tree1");$.each(v.igTree("checkedNodes"),function(){v.igTree("toggleCheckstate",this.element)});v.igTree("toggleCheckstate",w.node.element)}}});$("#bza_adnFlds_Table #tree2").igTree({dataSourceType:"json",dataSource:[],checkboxMode:"biState",bindings:{textKey:"Text",valueKey:"Value",childDataProperty:"Nodes"},nodeExpanded:function(v,w){var u=w.node.element.attr("bza-populated");if(u=="true"){return}else{w.node.element.attr("bza-populated","true")}BizAPP.UI.Grid.getChartFields(h,w.node.data.Value,w.node.data.FN,w,f)},});BizAPP.UI.Grid._loadNodesForChart(n,m,d,a)})}else{a.owner.element.igTree("removeAt",a.node.path+"_0");BizAPP.UI.Grid._loadNodesForChart(n,null,d,a.node.element);a.owner.element.igTree("expand",a.node.element)}realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetGridFieldNodes",h,b,d,f],true,function(B,D,A){var u=BizAPP.UI._handleEventsAndExceptions(B,D,A);var z=JSON.parse(u[1]);var w=z.allFields;var v=z.pqFields;if(!a){$("#bza_adnFlds_Table #treeGroupBy").igTree({dataSourceType:"json",dataSource:[],checkboxMode:"biState",bindings:{textKey:"Text",valueKey:"Value",childDataProperty:"Nodes"},nodeExpanded:function(F,G){var E=G.node.element.attr("bza-populated");if(E=="true"){return}else{G.node.element.attr("bza-populated","true")}BizAPP.UI.Grid.getChartFields(h,G.node.data.Value,G.node.data.FN,G,f)},nodeCheckstateChanged:function(E,G){if(G.newState=="on"){if(BizAPP.UI.Grid.__chartFieldNode&&BizAPP.UI.Grid.__chartFieldNode.node.path==G.node.path){return}BizAPP.UI.Grid.__chartFieldNode=G;var F=$("#bza_adnFlds_Table #tree1");$.each(F.igTree("checkedNodes"),function(){F.igTree("toggleCheckstate",this.element)});F.igTree("toggleCheckstate",G.node.element)}}});$("#bza_adnFlds_Table #treeSeries").igTree({dataSourceType:"json",dataSource:[],checkboxMode:"biState",bindings:{textKey:"Text",valueKey:"Value",childDataProperty:"Nodes"},nodeExpanded:function(F,G){var E=G.node.element.attr("bza-populated");if(E=="true"){return}else{G.node.element.attr("bza-populated","true")}BizAPP.UI.Grid.getChartFields(h,G.node.data.Value,G.node.data.FN,G,f)},});BizAPP.UI.Grid._loadNodesForGridFieldsChart(w,v,d,a)}else{a.owner.element.igTree("removeAt",a.node.path+"_0");BizAPP.UI.Grid._loadNodesForGridFieldsChart(w,null,d,a.node.element);a.owner.element.igTree("expand",a.node.element)}BizAPP.UI.InlinePopup._setTINYPosition(true)})})},_loadNodesForChart:function(b,d,e,a){$.each(b,function(f,o){var m=e?e+"."+f:f;var h={Text:o[2]!=null?o[2]:f.replace(/([A-Z])/g," $1"),FN:m},k=o[0];if(k){h.Value=k;h.Nodes=[{Text:"Loading..."}]}if(a){$("#bza_adnFlds_Table #tree1").igTree("addNode",h,a)}else{$("#bza_adnFlds_Table #tree1").igTree("addNode",h,a);$("#bza_adnFlds_Table #tree2").igTree("addNode",h,a)}});if(a){$(a).find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}else{$("#bza_adnFlds_Table #tree1").find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove();$("#bza_adnFlds_Table #tree2").find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}},_loadNodesForGridFieldsChart:function(b,d,e,a){$.each(b,function(f,o){var m=e?e+"."+f:f;var h={Text:o[2]!=null?o[2]:f.replace(/([A-Z])/g," $1"),FN:m},k=o[0];if(k){h.Value=k;h.Nodes=[{Text:"Loading..."}]}if(a){$("#bza_adnFlds_Table #treeGroupBy").igTree("addNode",h,a)}else{$("#bza_adnFlds_Table #treeGroupBy").igTree("addNode",h,a);$("#bza_adnFlds_Table #treeSeries").igTree("addNode",h,a)}});if(a){$(a).find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}else{$("#bza_adnFlds_Table #treeGroupBy").find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove();$("#bza_adnFlds_Table #treeSeries").find(".ui-igtree-parentnode").find('span[data-role="checkbox"]').remove()}},_displayChart:function(e,h,d,f,m,b){var k,a="";$.each($("#bza_adnFlds_Table #tree1").igTree("checkedNodes"),function(){if(this.data){k=this.data.FN}});$.each($("#bza_adnFlds_Table #treeGroupBy").igTree("checkedNodes"),function(){if(this.data){k=this.data.FN}});if(k){$.each($("#bza_adnFlds_Table #tree2").igTree("checkedNodes"),function(){if(this.data){a+=","+this.data.FN}});$.each($("#bza_adnFlds_Table #treeSeries").igTree("checkedNodes"),function(){if(this.data){a+=","+this.data.FN}});BizAPP.UI.GetChart({objecttypeid:e,fieldname:k,filterqueryid:h,seriesfield:a,roid:d,isForm:f,formId:m,ctrlName:b,container:"fromGrid"})}},Init:function(e,m,b,d,q,h,a,t,k,f){var n=BizAPP.UI.controlDependency.type;if(n&&!k){var p;var o="grid";switch(n){case"controlmap":p=BizAPP.UI.controlDependency[o];if(p){p=p+"?v="+__bts_;$.cachedScript(BizAPP.UI.GetBasePath(p)).done(function(u,v){BizAPP.UI.Grid.Init(e,m,b,d,q,h,a,t,k,f)})}else{BizAPP.UI.Grid.InternalInit(e,m,b,d,q,h,a,t,f)}break;case"controlset":BizAPP.UI.Grid.Init(e,m,b,d,q,h,a,t,true,f);break}}else{BizAPP.UI.Grid.InternalInit(e,m,b,d,q,h,a,t,f)}},InternalInit:function(h,o,d,f,p,m,b,q,k){var a=getElementByBizAPPId(h);if(o){BizAPP.UI.Grid.EnhanceGridFilter({selector:a})}if(d){BizAPP.UI.ResponsiveGrid.Init(h)}BizAPP.UI.Grid.FormatDateTimeColumns({bizappid:h,DateColumns:k});BizAPP.UI.Grid.EnhanceGrid(h,f,p,m,b,q);try{BizAPP.UI.Grid.PreProcessStub(h)}catch(n){addLog("grid pre process failed",n)}a=$(a);if(a.css("display")=="none"){a.show()}else{a.find('[id="'+h.replace(/:/g,"\\:")+'"]:hidden').show()}if(a.closest(".tinner").length){BizAPP.UI.InlinePopup._setTINYPosition(true)}},PreProcessStub:function(a){},EnhanceGridFilter:function(b){if(isIE()==8){return}var a=$(b.selector),d=a.find('[onkeypress*="callGridFilter"] [name="BizAPP.filter"]'),e=1;if(!a.find(".bza_vdg_header").length){return}a.find('[onkeypress*="callGridFilter"]').hide();BizAPP.UI.TextEditor.LoadFontAwesomeCss();$.each(d,function(){var h=$(this).parent(),f=h.closest("table").find(".bza_vdg_header").find("th:eq("+$(h).index()+")");$(f).click(function(n){if(!this.hasAttribute("filtermenu")){var m=$(this);$(".bza-dropdown").removeClass("open");BizAPP.MenuPopup.Create({html:BizAPP.UI.Grid.GetFilterNSortAsHTML(m),selector:m,position:"bottom",mode:"open",callback:function(){setTimeout(function(){m.find(".filter-textbox").focus()},50)}});BizAPP.UI.Grid.CreateFilterOperators({control:m,placeholder:".bza-operators"});BizAPP.UI.Grid.AlignFilterPopup(m);BizAPP.UI.Grid.DisplayPreSelectedFilter(m);var k=m.find(".allowed-values *").length>0;if(!k){m.find(".allowed-values").closest("tr").hide()}m.attr("filtermenu","created");n.stopPropagation();m.find(".dropdown-menu input[type=checkbox]").click(function(){var o=$(this);if(!o.is(":checked")){var p=o.closest(".dropdown-menu").find(".filter-textbox");p.val(p.val().replace(o.val(),""));p.val(p.val().replace(/^\,/g,"").replace(/\,$/g,""))}})}});BizAPP.UI.Grid.DisplayPreSelectedFilter($(f))});a.on("keyup","input.filter-textbox",function(h){if(h.keyCode==13){var f=$(this).closest(".bza-filter-block");f.find(".btn-filter,.fa-filter")[0].click()}})},AlignFilterPopup:function(a){var b=0;a.prevAll().each(function(){b+=$(this).width()});b+=a.width();if(a.find(".dropdown-menu").width()>b){a.find(".dropdown-menu.bottom,.bza-caret.bottom").addClass("pright")}},GetFilterNSortAsHTML:function(f){var e='<div style="padding: 3px 15px 3px 0px;white-space: nowrap;color: black;font-style: normal;text-align:left;">			<label onclick="event.cancelBubble = true;"  title="{0}"><input type="checkbox" class="bza-filter-checkbox" name="checkbox" value="{0}" onclick="event.cancelBubble = true;" style="height:auto!important;">{0}</label>		</div>';var d=$(f).closest("table.gridcontrol");var b="";var a=typeof(BizAPP.Bootstrap)=="undefined"?('<div class="bza-filter-block">						<table>							<tr><td style="border: none; padding: 0px!important; " td="td"><input type="text" class="filter-textbox" onclick="event.cancelBubble = true;" placeholder="Type Here..." style="float:left;width:80%"/>								<div style="float: right;">									<span class="sort-increasing-order ui-icon ui-icon-carat-1-n" onclick="BizAPP.UI.Grid.Sort(this, true, event)" title="Sort Ascending"></span>									<span class="sort-decreasing-order ui-icon ui-icon-carat-1-s" onclick="BizAPP.UI.Grid.Sort(this, false, event)"  title="Sort Descending" style="margin-left: -1px;margin-top: -6px;"></span>								</div>							</td></tr>							<tr><td style="border: solid 1px #e2e2e2;"><div class="allowed-values">'+b+'</div></td></tr>							<tr><td style="border: none;" td="td"><a class="stepcenternormal btn-filter" onclick="BizAPP.UI.Grid.InvokeFilter(this);" style="font-style: auto;">Filter</a>                            <a class="stepcenternormal btn-clear" onclick="BizAPP.UI.Grid.RemoveSelectedFilter(this);" style="font-style:auto;margin-left:3px;">Clear</a>                            </td></tr>						</table>					</div>'):('<div class="bza-filter-block" style="min-width: 250px">						<table style="width:100%">							<tr><td style="border: none;padding: 0px;">                                <select class="form-control bza-operators" onchange="BizAPP.UI.Grid.FilterOperatorOnChangeEvent(this)">								</select>							</td></tr>							<tr><td style="border: none;" td="td">                            <div class="input-group">                                <input type="text" class="form-control filter-textbox" placeholder="Search for...">								<span class="input-group-btn" style="display:none">									<button class="btn btn-default fa fa-eraser" type="button" onclick="BizAPP.UI.Grid.RemoveSelectedFilter(this);" title="Clear"></button>                                </span>								<span class="input-group-btn">									<button class="btn btn-default" type="button" onclick="BizAPP.UI.Grid.InvokeFilter(this);" title="Filter"><i class="fa fa-filter"></i></button>                                </span>								<span class="input-group-btn">									<span class="sort-increasing-order ui-icon ui-icon-carat-1-n" onclick="BizAPP.UI.Grid.Sort(this, true, event)" title="Sort Ascending"></span>									<span class="sort-decreasing-order ui-icon ui-icon-carat-1-s" onclick="BizAPP.UI.Grid.Sort(this, false, event)"  title="Sort Descending" style="margin-left: -1px;margin-top: -6px;"></span>                                </span>							</div>							</td></tr>							<tr><td style="border: solid 1px #e2e2e2;"><div class="allowed-values">'+b+"</div></td></tr>						</table>					</div>");d.find("th:eq(0)").parent().attr("onclick","null");a=addWindowEvent(a);return a},Sort:function(h,e,f){var d=$(h).closest(".grid"),k=$(h).closest(".bza-filter-block").closest("th");if(e){$(h).next().attr("onclick","BizAPP.UI.Grid.Sort(this, false, event)");k.removeClass("gridsortdescending").addClass("gridsortascending")}else{$(h).prev().attr("onclick","BizAPP.UI.Grid.Sort(this, true, event)");k.removeClass("gridsortascending").addClass("gridsortdescending")}var a=k.closest("[bza_data]").attr("id");var b=JSON.parse(k.closest("[bza_data]").attr("bza_data"));callSort(f,b.chc,a,a+"_Pages",a+"_RecordsPerPageList");$(h).attr("onclick","null")},_filteredText:"",InvokeFilter:function(e){var o=$(e).closest("table").find(".filter-textbox").val();if(!(!o||/\S/.test(o))){return}var m=BizAPP.UI.Grid._filteredText.replace(o,"");var h=m.split(",");var k=$(e).closest("table");$.each(h,function(q,p){if(p.indexOf("\\")>=0){p=p.replace(/\\/g,"\\\\")}k.find('[title="'+p+'"] input:checked').click()});var n=o.split(",");$(e).closest("table").find(".bza-filter-checkbox:input").each(function(){if(this.checked&&n.indexOf(this.value)<0){if(o){o=o+","+this.value}else{o=this.value}}});var a=$(e).closest("th");var f=a.closest("table").find("[onkeypress]").find("td:eq("+$(a).index()+")").find("input");var d=BizAPP.UI.Grid.GetOperators(a);var b=d[$(e).closest("table").find(".bza-operators").val()];if(!!o||b=="ISNULL"){o=BizAPP.UI.Grid.AttachFilterOperator({text:o,operator:b,datatype:a.attr("data-type")})}f.val(o);f.trigger(jQuery.Event("keypress",{keyCode:13}));BizAPP.UI.Grid._filteredText=o},DefaultOperators:{Contains:"Contains","Is Null":"ISNULL","Starts With":"StartsWith","Ends With":"EndsWith",Equal:"=","Not Equal":"!"},NumberOperators:{Equal:"=","Not Equal":"!","Greater Than":">","Greater Than Or Equal":">=","Less Than":"<","Less Than Or Equal":"<="},DateTimeOperators:{Equal:"=","Not Equal":"!","After Or Equal":">=","Before Or Equal":"<="},BooleanOperators:{Equal:"=","Not Equal":"!"},CreateFilterOperators:function(b){var e=$(b.control);var a=BizAPP.UI.Grid.GetOperators(e);var d="<option>{0}</option>",f="";$.each(a,function(m,h){f+=d.format(m)});e.find(b.placeholder).html("").append(f)},GetOperators:function(f){var a=BizAPP.UI.Grid.DefaultOperators;var e=$(f).attr("data-type");if(!e){e="String"}switch(e){case"Int32":case"number":a=BizAPP.UI.Grid.NumberOperators;break;case"String":case"Object":a=BizAPP.UI.Grid.DefaultOperators;break;case"Boolean":a=BizAPP.UI.Grid.BooleanOperators;break;case"DateTime":case"Date":a=BizAPP.UI.Grid.DateTimeOperators;var h=".filter-textbox";var d=$('<span class="input-group-addon" onclick="$(this).find(\'img\').click();"><span class="fa fa-calendar"></span></span>');$(f).find(h).parent().find(".input-group-addon").remove();d.insertAfter($(f).find(h));var b=$(f).attr("sortid").replace(/ /g,"");var k="id-"+b;$(f).find(h).attr("id",k);BizAPP.UI.DateTime.Init(k,"","ShowDatePicker",15,'{"maxDate":"","minDate":""}');break}return a},AttachFilterOperator:function(b){var d=b.text,a=b.operator;switch(a){case"Contains":break;case"=":case">=":case"<=":case">":case"<":case"!":d=a+d;break;case"ISNULL":d=a;break;case"StartsWith":d=d+"%";break;case"EndsWith":d="%"+d;break}return d},RemoveFilterOperators:function(n){var b=$(n.control),m=n.text,a=m,d=null;var h=new RegExp(">=|<=");var e=new RegExp(">|!|=|<");if(m.search(h)==0){a=a.substr(2);d=m.substr(0,2)}else{if(m.search(e)==0){a=a.substr(1);d=m[0]}else{if(m.endsWith("%")){var k=a.length;a=a.substr(0,k-1);d="StartsWith"}else{if(m.startsWith("%")){a=a.substr(1);d="EndsWith"}else{if(m=="ISNULL"){a="";d=m}}}}}if(d!=null){var f=BizAPP.UI.Grid.GetOperators(b);$.each(f,function(p,o){if(o==d){b.find(".bza-operators").val(p);b.find(".filter-textbox").prop("disabled",d=="ISNULL");return false}})}return a},FilterOperatorOnChangeEvent:function(a){var b=$(a).closest(".bza-filter-block");var d=b.find(".bza-operators").val()=="Is Null";b.find(".filter-textbox").prop("disabled",d);if(d){b.find(".filter-textbox").val("")}},DisplayPreSelectedFilter:function(a){var e=$(a),d=e.closest("table").find("[onkeypress]").find("td:eq("+$(e).index()+")").find("input"),f=$(a).find(".bza-filter-checkbox:input:visible");f.each(function(){if($.inArray(this.value,d.val().split(","))>-1){$(this).prop("checked",true)}});var b=BizAPP.UI.Grid.RemoveFilterOperators({control:e,text:d.val()});$(a).find(".filter-textbox").val(b);if(e.find(".bza-filter-icon").length==0&&d.val().length>0){$(e).prepend('<span class="bza-filter-icon filter-icon-visible filter-icon-fa"></span>');$(e).css("min-width","6em")}},RemoveSelectedFilter:function(b){var d=$(b).closest(".bza-filter-block");d.find(".filter-textbox").val("");d.find('[type="checkbox"]').prop("checked",false);var e=$(b).closest("th"),a=e.closest("table").find("[onkeypress]").find("td:eq("+$(e).index()+")").find("input");a.val("");a.trigger(jQuery.Event("keypress",{keyCode:13}))},RemoveNonAppliedFilter:function(){var a=$(".bza-dropdown.open").find(".filter-textbox"),d=a.closest("th").closest("table").find("[onkeypress]").find("td:eq("+a.closest("th").index()+")").find("input");if(d.val()==""){a.val("");var b=a.closest(".bza-filter-block");b.find('[type="checkbox"]').prop("checked",false)}},ExportAsJob:function(b,a){g_callBacks.push(function(d){BizAPP.UI.Toast.Notify({title:"Export To Excel",text:"Request to export document accepted. It will be processed shortly.",type:"info"})});ajaxAsyncCall("HelperEx",["ExportAsJob",b,a],true)},ImportCallback:function(){console.log("BizAPP.UI.Grid.ImportCallback called.")},ShowImportExportPopup:function(f,a){f="<span>{0}</span>".format(f);a=a.replace(/\[BSQ]/g,"'");a=a.replace(/\[BDQ]/g,'"');var b='<div><table cellspacing="0" cellpadding="0" align="Left" style="border-collapse:collapse;"><tbody><tr valign="top"><td valign="middle" style="padding:2px;"><div onmouseover="highlightstep(this);" onmouseout="normalizestep(this);" style="height:100%;width:100%;"><span accesskey="C" class="stepcenternormal cancelstep" onclick="zoomout();">Close</span></div></td></tr></tbody></table></div>';var d={headline:f,body:a,steps:b};var e=BizAPP.UI.InlinePopup.GetMarkupWithTemplate(d);BizAPP.UI.InlinePopup.CreateNew({html:e})},_stampViewParamsOnPopup:function(){var a=$(getSourceElement(window.event)).closest("[bza_viewparams]");if(a.length>0){g_callBacks.push(function(e,d,f){setTimeout(function(){var b=BizAPP.UI.InlinePopup.getActivePopup(false);if(b){$(b.tinner()).attr("bza_viewparams",a.attr("bza_viewparams"))}},1000)})}},FormatDateTimeColumns:function(e){if(!e||typeof(moment)=="undefined"){return}var d=$(getElementByBizAPPId(e.bizappid));var k=e.DateColumns.split(",");var b=[];$.each(k,function(n,m){b.push('[sortid="{0}"]'.format(m.trim()))});var h=d.find(b.join(","));var f=d.find('[data-type="DateTime"],[data-type="Date"]');var a=BizAPP.Session.__dateFormat.toLocaleUpperCase();$.each(f,function(n,m){if($.inArray($(m).attr("sortid"),k)>-1){return}var o=$(m).index();d.find("tr[roid]").each(function(){var q=$(this).find("td").eq(o);var p=q.text();if(p){p=moment(p,a+" HH:mm:ss A").format(a);if(p!="Invalid date"){q.text(p)}}})})}};BizAPP.UI.IgChart={g_igChartLoading:false,g_igChartLoaded:false,g_callbacks:[],_initLoader:function(a){if(BizAPP.UI.IgChart.g_igChartLoading&&!BizAPP.UI.IgChart.g_igChartLoaded){BizAPP.UI.IgChart.g_callbacks.push(a)}else{if(!BizAPP.UI.IgChart.g_igChartLoaded&&!BizAPP.UI.IgChart.g_igChartLoading){BizAPP.UI.IgChart.g_igChartLoading=true;$.cachedScript(BizAPP.UI.GetBasePath("Resources/Javascripts/Infragistics/infragistics.core.js?v="+__bts_)).done(function(){$.cachedScript(BizAPP.UI.GetBasePath("Resources/Javascripts/Infragistics/infragistics.dv.js?v="+__bts_)).done(function(){BizAPP.UI.IgChart.g_igChartLoaded=true;a();$.each(BizAPP.UI.IgChart.g_callbacks,function(){this()})})})}else{a()}}},Create:function(f,w,q){q=q||"column";var a,u;if(w.container=="fromGrid"){var n=[];var d={};var z=[];for(var v,e=0;v=f[e++];){var t=w.axes[0].label;var b=v[t];if(!(b in d)){d[b]=1;z.push(b)}}var o=[];var h={};for(var e=0;e<z.length;e++){v=z[e];var m=new Object();var t=w.axes[0].label;m[t]=v;$.each(f,function(D,A){if(A[t]==v){var B=A[w.series[0].name];if(typeof B=="boolean"){B=B.toString()}if(!B){B="Aggregate"}m[B]=A.Aggregate;if(!(B in h)){h[B]=1;o.push(B)}}});n.push(m)}actualSeries=[];for(var v,e=0;v=o[e++];){var m=new Object();m.showTooltip=true;m.name=v;m.type=w.series[0].type;m.title=v;m.xAxis=w.series[0].xAxis;m.yAxis=w.series[0].yAxis;m.valueMemberPath=v;m.isTransitionInEnabled=w.series[0].isTransitionInEnabled;m.isHighlightingEnabled=w.series[0].isHighlightingEnabled;actualSeries.push(m)}w.series=actualSeries;w.dataSource=n;BizAPP.UI.IgChart._createChartInPopup(w)}else{if(w.container.match("^#chartWidget")){BizAPP.UI.IgChart._createWidgetChart(f,w)}else{if(w.container=="fromWidget"){if(f){w.dataSource=f}BizAPP.UI.IgChart._createChartInPopup(w)}else{w.width="150px";w.height="100px";w.dataSource=f;w.series[0].brush=BizAPP.UI.IgChart.GetRandomColor();a=$(w.container);var k=w.container.split("=");var p=$(w.container).attr("chartname");if(!p){p=k[1].substring(1,k[1].length-2)}else{p=p.split(" ").join("")}u="chart"+p;a.html("<div id="+u+"></div>");$("#"+u).igDataChart(w)}}}},_createChartInPopup:function(a){a.width="600px";a.height="400px";a.legend={element:"lineLegend"};BizAPP.UI.IgChart.DrawChart(a.series[0].type,false,a)},_createWidgetChart:function(e,b){if(e){b.dataSource=e}$.extend(b,{height:BizAPP.UI.widgetChartHeight,width:"100%"});var h=b.container.substring(1);var f="lineLegend"+h;var a="chart"+h;$(b.container).before('<div class="selectionOptions" bza-charttype="" bza-chartdata="" >            <table class="fill"><tr><td id="{1}" class="fill chartElement"></td><td id="{0}"/></tr></table></div>'.format(f,a));$("#"+a).append($(b.container));if(!b.series[0].valueMemberPath&&b.axes[1].val){b.series[0].valueMemberPath=b.series[0].name=b.series[0].title=b.axes[1].val}var d=b.series[0].type;if(d=="pie"){b.valueMemberPath=b.series[0].valueMemberPath;b.labelMemberPath=b.axes[0].label;b.labelsPosition="outsideEnd";b.leaderLineType="arc";b.labelExtent=40;b.othersCategoryThreshold=0;b.showTooltip=true,b.tooltipTemplate="<div class='ui-chart-tooltip'><div class='bold'>${item."+b.axes[0].label+"}</div><div>Count: <label class='bold'>${item."+b.series[0].valueMemberPath+"}</label></div></div>";delete b.axes;delete b.series;delete b.title;delete b.subtitle;b.legend={element:f,type:"item"};$(b.container).igPieChart(b)}else{if(d=="doughnut"){delete b.legend;b.series[0].dataSource=b.dataSource;b.series[0].labelMemberPath=b.axes[0].label;$(b.container).igDoughnutChart(b)}else{if(d=="funnel"){delete b.legend;b.innerLabelMemberPath=b.series[0].valueMemberPath;b.innerLabelVisibility="visible";b.outerLabelMemberPath=b.axes[0].label;b.outerLabelVisibility="visible";$(b.container).igFunnelChart(b)}else{b.legend={element:f};b.axes[0].labelAngle=90;$(b.container).igDataChart(b)}}}delete b.legend;BizAPP.UI.IgChart.PersistCurrentOptions(d,JSON.stringify(b))},_internalCreate:function(b,d,a){b+='$("#seriesType").val(\''+a+"');$('.selectionOptions[bza-charttype]').attr('bza-charttype','"+a+"');$('.selectionOptions[bza-chartdata]').attr('bza-chartdata','"+d+'\');setTimeout(function() { $(".tinner").css("width", "auto");}, 10);$("#seriesType").change(function (e) {BizAPP.UI.IgChart.RedrawChart($(this).val())});';BizAPP.UI.InlinePopup.CreateNew({html:'<div class="selectionOptions" bza-charttype="" bza-chartdata="" style="padding: 20px;">                Type:                <select id="seriesType" class="selectBounds">                    <option value="area">Area</option>                    <option value="column" selected="selected">Column</option>                    <option value="line">Line</option>                    <option value="splineArea">Spline Area</option>                    <option value="spline">Spline</option>                    <option value="stepArea">Step Area</option>                    <option value="stepLine">Step Line</option>                    <option value="point">Point</option>                    <option value="pie">Pie</option>                    <option value="doughnut">Doughnut</option>                    <option value="funnel">Funnel</option>                </select>            <table><tr><td id="chart" class="chartElement"><div id="chartGrid"></div></td><td id="lineLegend"></td></tr></table></div>',stropenjs:b})},Init:function(d,a,b){BizAPP.UI.IgChart._initLoader(function(){BizAPP.UI.IgChart.Create(d,a,b)})},RedrawChart:function(d,b){var e=$(".selectionOptions[bza-charttype]").attr("bza-charttype");var f=$(".selectionOptions[bza-chartdata]").attr("bza-chartdata");var a=JSON.parse(f);if(e=="pie"){$(a.container).igPieChart("destroy")}else{if(e=="doughnut"){$(a.container).igDoughnutChart("destroy")}else{if(e=="funnel"){$(a.container).igFunnelChart("destroy")}else{$(a.container).igDataChart("destroy")}}}BizAPP.UI.IgChart.DrawChart(d,b,a)},DrawChart:function(e,b,a){var d;if(!a.series[0].valueMemberPath&&a.axes[1].val){a.series[0].valueMemberPath=a.series[0].name=a.series[0].title=a.axes[1].val}var f=JSON.stringify(a);if(e=="pie"){a.valueMemberPath=a.series[0].valueMemberPath;a.labelMemberPath=a.axes[0].label;a.labelsPosition="outsideEnd";a.leaderLineType="arc";a.labelExtent=40;a.othersCategoryThreshold=0;a.showTooltip=true,a.tooltipTemplate="<div class='ui-chart-tooltip'><div class='bold'>${item."+a.axes[0].label+"}</div><div>Count: <label class='bold'>${item."+a.series[0].valueMemberPath+"}</label></div></div>";delete a.axes;delete a.series;delete a.title;delete a.subtitle;a.legend={element:"lineLegend",type:"item"};d='$("#chartGrid").igPieChart('+JSON.stringify(a)+");"}else{if(e=="doughnut"){delete a.legend;a.series[0].dataSource=a.dataSource;a.series[0].labelMemberPath=a.axes[0].label;d='$("#chartGrid").igDoughnutChart('+JSON.stringify(a)+");"}else{if(e=="funnel"){delete a.legend;a.innerLabelMemberPath=a.series[0].valueMemberPath;a.innerLabelVisibility="visible";a.outerLabelMemberPath=a.axes[0].label;a.outerLabelVisibility="visible";d='$("#chartGrid").igFunnelChart('+JSON.stringify(a)+");"}else{a.legend={element:"lineLegend"};a.axes[0].labelAngle=90;$.each(a.series,function(h,k){k.type=e});d='$("#chartGrid").igDataChart('+JSON.stringify(a)+");"}}}if(b){a.series[0].type=e;BizAPP.UI.IgChart._createWidgetChart(null,a)}else{zoomout();BizAPP.UI.IgChart._internalCreate(d,f,e)}},PersistCurrentOptions:function(a,b){$("#seriesType").val(a);$(".selectionOptions[bza-charttype]").attr("bza-charttype",a).attr("bza-chartdata",b);$("#seriesType").change(function(d){BizAPP.UI.IgChart.RedrawChart($(this).val(),true)})},GetRandomColor:function(){var a=["#C91F37","#C93756","#763568","#22A7F0","#003171","#7A942E","#006442","#F3C13A","#F9690E","#6C7A89"];return a[Math.floor(Math.random()*(a.length)+1)]}};BizAPP.UI.ResponsiveGrid={Init:function(a){if(isIE()==8){return}BizAPP.UI.ResponsiveGrid.LoadDependency(function(){var b=$(getElementByBizAPPId(a)).find("table.gridcontrol");b.each(function(){var e=$(this);if(e.find("thead").length==0){var d=e.find("tr:eq(0)");e.prepend($("<thead></thead>"));e.find("thead").append(d)}e.find("th[sortid]").each(function(h){var f=(h+1>6)?6:h+1;$(this).attr("data-priority",f)});e.addClass("tablesaw").addClass("tablesaw-columntoggle").attr("data-mode","columntoggle").attr("data-mode-switch","").attr("data-minimap","");e.parent().trigger("enhance.tablesaw")});$(window).unbind("resize").bind("resize",function(){BizAPP.UI.ResponsiveGrid.ShowDetails()});BizAPP.UI.ResponsiveGrid.ShowDetails()})},ShowDetails:function(){$(".gridcontrol.tablesaw").each(function(){var a=$(this);var e='<tr class="row-detail" style="display: none;">						<td class="row-detail-cell" colspan="100"></td>					  </tr>',d='<div class="row-detail-item" style="display:table-row;">								<div class="row-detail-name" style="font-weight:bold;display:table-cell;">{0}</div>								<div class="row-detail-value style="display:table-cell;">&nbsp;<b>:</b>&emsp;{1}</div>							</div>';var b=a.find("tr[roid]").not("[onkeypress]");if(b){a.find(".row-detail").remove();b.each(function(){var m=$(this),f=$(m).find("td").filter(function(){return $(this).css("display")=="none"});var k=$(m).find("td.griditemtext, td.griditemtextdisable");k.find(".fa-plus,.fa-minus").remove();if(f.length){a.find(".gSel").parent().remove();a.find("thead th:first").remove();$(e).insertAfter($(m));var h=$(m).next().find("td");f.each(function(){var p=$(this);var o=p.closest("table").find("th:eq("+p.index()+")").text(),n=p.text().trim();h.append(d.format(o,n))});k.prepend('<span class="fa-plus" onclick="BizAPP.UI.ResponsiveGrid.Toggle(event);" style="font: normal normal normal 14px/1 FontAwesome;color:gray;padding:5px;"></span>');h.css("padding-left",(k.position().left-k.closest("table").position().left+25)+"px")}})}})},LoadDependency:function(a){BizAPP.UI.LoadDependentFile("tablesaw.js",function(b,d){$.getCss(BizAPP.UI.GetBasePath("Resources/ResponsiveGrid/tablesaw.css?v="+__bts_),function(){a()});BizAPP.UI.TextEditor.LoadFontAwesomeCss()})},Toggle:function(b){var a=$(b.target);if(a.hasClass("fa-plus")){a.removeClass("fa-plus").addClass("fa-minus").closest("tr").next().show()}else{a.removeClass("fa-minus").addClass("fa-plus").closest("tr").next().hide()}b.stopPropagation()}};BizAPP.UI.Upload={_imageUploaderFound:false,_url:null,_target:null,_callback:null,_validationText:"",g_ImgCrop:null,g_aspRatio:null,g_width:null,g_height:null,g_fileuploadOptions:'<td style="display:none;" onclick="BizAPP.UI.Upload.SwitchFileUploadMode(this,\'file\')"><i class="fa fa-arrow-circle-left" title="Back"></i></td><td onclick="BizAPP.UI.Upload.SwitchFileUploadMode(this,\'ref\')"><i class="fa fa-link" title="External Link"></i></td><td onclick="BizAPP.UI.Upload.ShowWebCam(event)"><i class="fa fa-camera" title="Capture"></i></td>',g_vimeoUpload:'<td onclick="BizAPP.UI.Upload.UploadToVimeo(event)"><i class="fa fa-vimeo" title="Upload to Vimeo"></i></td>',g_fileuploadExternal:'<td class="ref" style="display:none"><input class="formtextbox fill" placeholder="External Link"/></td><td class="ext-upload" style="display:none" onclick="BizAPP.UI.Upload.SaveExternalLink(event)"><i class="fa fa-upload" title="Upload"></i></td><td onclick="BizAPP.UI.Upload.ShowAdvancedOptions(event)"><i class="fa fa-ellipsis-v" title="Advanced Options"></i></td>',SwitchFileUploadMode:function(a,b){$(a).toggle();$(a).parent().children('[class*="uploader"],[class*="ref"],[class*="ext-upload"]').toggle();if(b=="ref"){$(a).prev().toggle()}else{$(a).next().toggle()}},InitUploadControl:function(b,e,a,f,d){BizAPP.UI.TextEditor.LoadFontAwesomeCss();BizAPP.UI.Upload.LoadDependency(function(){BizAPP.UI.Upload._validationText=f;var h=$(b).find('[bizappid="AttachmentFileUpload"]').attr("fileformats");if(h){h=h.replace(/,/g,";")}var k=$(b).dmUploader({url:e,maxFileSize:a,extFilter:h,onInit:function(){console.log("Uploader init successfull");$(b).find(".browser>table tr").prepend(BizAPP.UI.Upload.g_fileuploadOptions+(d.vimeo?BizAPP.UI.Upload.g_vimeoUpload:""));$(b).find(".browser>table tr").append(BizAPP.UI.Upload.g_fileuploadExternal);if(!(BizAPP.UI.Upload.HasGetUserMedia())){$(b).find(".fa-camera").closest("td").hide()}},onBeforeUpload:function(m){$.danidemo.updateFileStatus(m,"default","Uploading...");return e+"&mode=file&chc="+$(b).closest('[id^="drag-and-drop-zone"]').attr("chc")+"&advanced="+encodeURIComponent($(b).closest('[id^="drag-and-drop-zone"]').attr("advanced"))},onNewFile:function(n,m){if(CheckFileFormat("AttachmentFileUpload",a)){$.danidemo.addFile(b+" #demo-files",n,m);return true}else{return false}},onUploadProgress:function(o,n){var m=n+"%";$.danidemo.updateFileProgress(o,m)},onUploadSuccess:function(q,n){try{responseHandler({value:JSON.parse(n)})}catch(o){var m=n.split("-");if(m.length>1){if(m[0]!="Error"){var p="testresource.aspx?aid="+n;$(".sceditor-insertimage #image").val(p);$.danidemo.updateFileStatus(0,"success","Complete");$.danidemo.updateFileProgress(0,"100%")}else{$.danidemo.updateFileStatus(q,"error",m[1]);debug(m[1],"exception","");$.danidemo.updateFileProgress(q,"95%")}}}},onFileTypeError:function(m){alert("File '"+m.name+"' cannot be added: file type not allowed")},onFileSizeError:function(m){if(a/1024<1024){displayMessage("The selected file exceeds the maximum allowed size of {0}Kb.".format(a/1024))}else{displayMessage("The selected file exceeds the maximum allowed size of {0}Mb.".format(a/(1024*1000)))}},onFileExtError:function(m){displayMessage("Invalid file extension. Allowed formats are "+h+".")},onUploadError:function(n,m){$.danidemo.updateFileStatus(n,"error",m);$.danidemo.updateFileProgress(n,"95%")}})})},_uploaderLoaded:0,LoadDependency:function(a){if(BizAPP.UI.Upload._uploaderLoaded){if(a){a()}}else{$.getCss(BizAPP.UI.GetBasePath("resources/uploader/uploader.css?v="+__bts_));$.cachedScript(BizAPP.UI.GetBasePath("resources/uploader/dmuploader.js?v="+__bts_)).done(function(b,d){BizAPP.UI.Upload._uploaderLoaded=1;if(a){a()}})}},HasGetUserMedia:function(){return !!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)},RefreshControl:function(f,a){$.danidemo.updateFileStatus(0,"success","Complete");$.danidemo.updateFileProgress(0,"100%");var d=$(a).closest('[id^="drag-and-drop-zone"]');var b=d.closest("[bza-ctrlid]").attr("bza-ctrlid"),e=d.attr("roid");loadUploadControl(b,e,f,false)},ShowAdvancedOptions:function(a){var b='<div class="upload-advanced-options">		<div class="advanced-name"><div class="pq_groupbox" ><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="pq_title" style="color:black;float:left;">Name</span></td></tr></tbody></table></div>		<div class="pq_content"><div id="gbName" class="formgroupbox"><div class="fill"><input rows="2" cols="20" id="tbName" class="formtextbox form-control" onchange = "BizAPP.UI.Upload.SaveAdvacedOption(event);" style="width:350px;"></input></div></div></div></div>		<div class="pq_groupbox" processed="1"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="pq_title" style="color:black;float:left;">Description</span></td></tr></tbody></table></div>		<div class="pq_content"><div id="gbDescription" class="formgroupbox"><div class="fill" style="height:70px;width:385px;position:relative;"><textarea rows="2" cols="20" id="tbDescription" class="formmultilinetextbox form-control" onchange = "BizAPP.UI.Upload.SaveAdvacedOption(event);" style="height:70px;width:350px;"></textarea></div></div></div>		<div><table><tr><td><div class="pq_groupbox" processed="1"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="pq_title" style="color:black;float:left;">Sort Order</span></td></tr></tbody></table></div>		<div class="pq_content"><div id="gbSortOrder" class="formgroupbox" style="padding-left:15px;float:left;"><div class="fill"><input rows="2" cols="20" id="tbSortOrder" class="formtextbox form-control" onchange = "BizAPP.UI.Upload.SaveAdvacedOption(event);" style="width:50px;"></input></div></div></div></td>		<td><input type="checkbox" id="chk-viewonly" class="viewonly" onclick = "BizAPP.UI.Upload.SaveAdvacedOption(event);" name="viewonly" style="margin-left:220px;"/><span class="viewonly" style="color:black;font-weight:bold;">View Only</span></td></tr></table></div></div>';BizAPP.MenuPopup.Create({html:b,selector:a.target,mode:"open",position:"bottom",callback:function(){BizAPP.UI.Upload.InitAdvancedOptions(a)}})},InitAdvancedOptions:function(d){if($('[class="ref"]').is(":hidden")){$(".viewonly").show();$(".advanced-name").hide()}else{$(".viewonly").hide();$(".advanced-name").show()}var b=$(d.target).closest('[id^="drag-and-drop-zone"]').attr("advanced");if(b){var a=b.split("::");$(d.target).find("#tbName").val(a[0]);$(d.target).find("#tbDescription").val(a[1]);$(d.target).find("#tbSortOrder").val(a[2]);$(d.target).find("#chk-viewonly").prop("checked",(a[3]==="true"))}d.stopPropagation()},ShowWebCam:function(a){$.cachedScript(BizAPP.UI.GetBasePath("resources/uploader/getUserMedia.js?v="+__bts_)).done(function(b,e){var d='<div class="container" style="background-color:white;"><button  id="takeSnapshot">Capture</button>			<table class="bza_webcam"><tr><td><div id="webcam"></div></td><td><canvas id="canvas"  height="240" width="320" style="height:240px;width:320px;"></canvas></td></tr></table></div>';BizAPP.MenuPopup.Create({html:d,selector:a.target,mode:"open",position:"bottom"});BizAPP.UI.Webcam.init();$.danidemo.updateFileProgress(0,"0%")})},SaveAdvacedOption:function(k){var b=$(k.target).closest('[id^="drag-and-drop-zone"]');var m=b.find("#tbName"),a=b.find("#tbDescription"),f=b.find("#tbSortOrder"),d=b.find("#chk-viewonly");var h=b.find(".ref").find("input");b.attr("advanced",(m.length>0?m.val().trim():"")+"::"+(a.length>0?a.val().trim():"")+"::"+(f.length>0?f.val().trim():"")+"::"+d.is(":checked").toString()+"::"+(h.length>0?h.val().trim():""))},SaveExternalLink:function(b){BizAPP.UI.Upload.SaveAdvacedOption(b);var a=BizAPP.UI.Upload.ConstructUrl(b,"external");$.ajax({type:"POST",url:a,data:{},cache:false,success:function(d){try{BizAPP.UI.ProcessCallBacks(g_callBacks);responseHandler({value:JSON.parse(d)})}catch(f){if(d.split("-")[0]!="Error"){var h=d.split("-")[1].trim();BizAPP.UI.Upload.RefreshControl(h,f.target)}}},error:function(f,d,e){$.danidemo.updateFileStatus(0,"error",e)}})},UploadWebcamImage:function(d){var a=BizAPP.UI.Upload.ConstructUrl(d,"webcam");var b={webcamimg:BizAPP.UI.Webcam.getImageData()};$.ajax({type:"POST",url:a,data:b,cache:false,success:function(e){if(e.split("-")[0]!="Error"){customAjaxAsyncSuccess(e,"OK","","");return;var f=e.split("-")[1].trim();BizAPP.UI.Upload.RefreshControl(f,d.target)}},error:function(h,e,f){$.danidemo.updateFileStatus(0,"error",f)}})},ConstructUrl:function(k,n){var f=$(k.target).closest('[id^="drag-and-drop-zone"]');var d="",h="",b=f.attr("type"),m=f.attr("chc");if(f[0].hasAttribute("roid")){d=f.attr("roid");h=f.attr("field")}var a="Upload.asmx?roid="+d+"&field="+h+"&type="+b+"&mode="+n+"&chc="+m+"&skipsave=true&getchc=true&advanced="+encodeURIComponent(f.attr("advanced"));return a},RegisterDragDrop:function(e,f,b,a){if(!a){a={}}var d={target:e,callback:f,callback1:b,options:a};e.bind("dragenter",d,BizAPP.UI.Upload.EnableImageUploader).bind("dragover",d,BizAPP.UI.Upload.EnableImageUploader).bind("drop",d,BizAPP.UI.Upload.EnableImageUploader);$(e).triggerHandler("dragenter",d)},EnableImageUploader:function(n){if(n.data.callback1){n.data.callback1(n.originalEvent)}if(n.originalEvent){n.originalEvent.stopPropagation();n.originalEvent.preventDefault()}var d=$(n.data.target);var b="imageUploaderEnabled";var h=!(d.hasClass(b));if(!BizAPP.UI.Upload._imageUploaderFound||h){d.addClass(b);var m="",o="",f="",k=n.data.target.attr("skipsave");if(n.data.target[0].hasAttribute("roid")){m=n.data.target.attr("roid");o=n.data.target.attr("field")}else{if(n.data.target[0].hasAttribute("atype")){f=n.data.target.attr("atype")}}var a=n.data.options.url?n.data.options.url:location.href.toLowerCase();if(a.indexOf("enterpriseview.aspx")!=-1){a=a.split("enterpriseview.aspx")[0]}else{if(a.indexOf("testview.aspx")!=-1){a=a.split("testview.aspx")[0]}else{a=a.split("viewdetails.aspx")[0]}}BizAPP.UI.Upload._url=a+"upload.asmx?roid="+m+"&field="+o+"&atype="+f+"&type="+n.data.target.attr("type")+"&skipsave="+k+"&mode=file&advanced="+encodeURIComponent("::::0::false::");BizAPP.UI.Upload.LoadDependency(function(){n.data.target.dmUploader({url:BizAPP.UI.Upload._url,maxFileSize:"0",extFilter:"",onInit:function(){BizAPP.UI.Upload._imageUploaderFound=true},onBeforeUpload:function(e){ProcessingStatus(true,true);return BizAPP.UI.Upload._url},onNewFile:function(p,e){return true},onUploadSuccess:function(t,q,p){var e=q.split("-");if(!(e.length>1)){if(n.data.callback){n.data.callback(e,$(n.data.target),p)}}console.log(q);BizAPP.UI.Upload._imageUploaderFound=false;ProcessingStatus(false,true)}})})}},ImgCtrlInit:function(a,e){var f;if(e){f=$('div[bza-ctrlid="'+a+'"]').find('input[onclick*="bizapp_initDwnld"]')}else{f=$('[id*="'+a+'_frame"]').contents().find('input[onclick*="bizapp_initDwnld"]')}if(f.length!=0){var d=f.attr("onclick"),h=d.split("runtimeobjectid[NVS]")[1].split("[PMS]")[0];h=h.split("'")[0]}if(h){var b;var k;if(e){var b=$('<td><input type="submit" class="formbutton" value="Crop"></td>');k=$('div[bza-ctrlid="'+a+'"]').find('[value="Remove"]').closest("tr")}else{var b=$('<input type="button" class="formbutton" value="Crop">');b.css({border:"2px outset buttonface","border-color":"#d0cbef","border-bottom":"solid 1px #5c5d61"});k=$('[id*="'+a+'_frame"]').contents().find('body [value="Remove"]').parent().next()}k.append(b);b.find('[value="Crop"]').attr("onclick","BizAPP.UI.Upload.startCropping('"+h+"', 200, 200);")}},startCropping:function(b,d,a){BizAPP.UI.LoadScript({eid:"EAppPoint1856e7",callback:function(){BizAPP.UI.LoadTheme({eid:"EAppPoint1856db",callback:function(){var e={width:700,stropenjs:"BizAPP.UI.Upload.Init('"+b+"');",strclosejs:"BizAPP.UI.Upload.g_ImgCrop.remove();"};BizAPP.UI.Upload.g_aspRatio=(d/a)+":1";BizAPP.UI.Upload.g_width=d;BizAPP.UI.Upload.g_height=a;PQube.View.LoadView({vieweid:"EAppPoint1856eb",inlinePopup:true,inlinepopupoptions:e,target:"dummy"})}})}})},Init:function(d){if(!d){throw"Attachment Identifier not specified.";return}if(isIE()==8){var a=$(".ImgCrop #photo");a.removeAttr("width");a.attr("min-width","300px")}$(".ImgCrop #photo").attr("aid",d);$(".ImgCrop #photo").attr("src","download.asmx?aid="+d+"&bza-transmit=1");$(".ImgCrop #preview img").attr("src","download.asmx?aid="+d+"&bza-transmit=1");var b=(150*(BizAPP.UI.Upload.g_width/BizAPP.UI.Upload.g_height))+"px";$(".ImgCrop #preview img").css({height:"150px",width:b,"max-width":"none"});$(".ImgCrop #preview").css({height:"150px",width:b});$(".ImgCrop #preview").parent().css({height:"150px",width:b});BizAPP.UI.Upload.g_ImgCrop=$(".ImgCrop #photo").imgAreaSelect({handles:true,onSelectChange:BizAPP.UI.Upload._preview,instance:true});PQube.ImageCrop.g_ImgCrop=BizAPP.UI.Upload.g_ImgCrop;PQube.ImageCrop.g_aspRatio=BizAPP.UI.Upload.g_aspRatio;PQube.ImageCrop.g_width=BizAPP.UI.Upload.g_width;PQube.ImageCrop.g_height=BizAPP.UI.Upload.g_height},_preview:function(b,e){var f=BizAPP.UI.Upload.g_ImgCrop.getSelection();if(!e.width||!e.height){return}var d=(150*(BizAPP.UI.Upload.g_width/BizAPP.UI.Upload.g_height))/e.width;var a=150/e.height;$(".ImgCrop #preview img").css({width:Math.round(d*300),height:Math.round(a*b.height),marginLeft:-Math.round(d*e.x1),marginTop:-Math.round(a*e.y1)})},getCoordinates:function(){var b=BizAPP.UI.Upload.g_ImgCrop.getSelection(),e=$(".ImgCrop #photo")[0].naturalWidth/$(".ImgCrop #photo").width(),d=$(".ImgCrop #photo")[0].naturalHeight/$(".ImgCrop #photo").height();g_callBacks.push(zoomout);BizAPP.RuntimeObject.SetFieldValue({roid:$(".ImgCrop #photo").attr("aid"),fieldName:"Extras",fieldValue:Math.round(b.x1*e*100)/100+","+Math.round(b.y1*d*100)/100+","+Math.round(b.x2*e*100)/100+","+Math.round(b.y2*d*100)/100})},UploadToVimeo:function(){$(".fa-ellipsis-v").click();BizAPP.UI.LoadView({inlinePopup:true,url:"uiview.asmx?html.jar=true&html.args=runtimeviewenterpriseid[NVS]ESystemb4e69"})},GetVimeoUploadParams:function(a){realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetVimeoUploadKey"],false,function(d,e,b){d=BizAPP.UI._handleEventsAndExceptions(d,e,b);if(a){a(d)}})},CompleteVimeoUpload:function(a,b){realAjaxAsyncCall("HelperEx",getNextRequestId(),["CompleteVimeoUpload",a.complete_url,a.name,a.description],false,function(e,f,d){e=BizAPP.UI._handleEventsAndExceptions(e,f,d);if(b){b(e)}})},SaveVimeo:function(a){$(".fa-ellipsis-v").click();$(".fa-link").click();$(".ref").find("input").val(a.url);$("#tbName").val(a.name);$("#tbDescription").val(a.description);g_callBacks.push(zoomout);$(".ext-upload").click()}};BizAPP.UI.Webcam={localStream:null,init:function(){if(!!this.options){this.pos=0;this.cam=null;this.filter_on=false;this.filter_id=0;this.canvas=document.getElementById("canvas");this.ctx=this.canvas.getContext("2d");this.img=new Image();this.ctx.clearRect(0,0,this.options.width,this.options.height);this.image=this.ctx.getImageData(0,0,this.options.width,this.options.height);this.snapshotBtn=document.getElementById("takeSnapshot");getUserMedia(this.options,this.success,this.deviceError);window.webcam=this.options;this.addEvent("click",this.snapshotBtn,this.getSnapshot)}else{alert("No options were supplied to the shim!")}},addEvent:function(b,d,a){if(d.attachEvent){d["e"+b+a]=a;d[b+a]=function(){d["e"+b+a](window.event)};d.attachEvent("on"+b,d[b+a])}else{d.addEventListener(b,a,false)}},options:{audio:false,video:true,el:"webcam",extern:null,append:true,width:320,height:240,mode:"callback",swffile:"lib/dist/fallback/jscam_canvas_only.swf",quality:85,context:"",debug:function(){},onCapture:function(){window.webcam.save()},onTick:function(){},onSave:function(m){var d=m.split(";"),b=BizAPP.UI.Webcam.image,f=null,a=this.width,k=this.height;for(var e=0;e<a;e++){f=parseInt(d[e],10);b.data[BizAPP.UI.Webcam.pos+0]=(f>>16)&255;b.data[BizAPP.UI.Webcam.pos+1]=(f>>8)&255;b.data[BizAPP.UI.Webcam.pos+2]=f&255;b.data[BizAPP.UI.Webcam.pos+3]=255;BizAPP.UI.Webcam.pos+=4}if(BizAPP.UI.Webcam.pos>=4*a*k){BizAPP.UI.Webcam.ctx.putImageData(b,0,0);BizAPP.UI.Webcam.pos=0}},onLoad:function(){}},success:function(b){if(BizAPP.UI.Webcam.options.context==="webrtc"){var a=BizAPP.UI.Webcam.options.videoEl;a.srcObject=b;a.onloadedmetadata=function(d){a.play()}}else{}BizAPP.UI.Webcam.localStream=b},deviceError:function(a){alert("No camera available.");console.error("An error occurred: [CODE "+a.code+"]")},changeFilter:function(){if(this.filter_on){this.filter_id=(this.filter_id+1)&7}},getSnapshot:function(){if(BizAPP.UI.Webcam.options.context==="webrtc"){var a=document.getElementsByTagName("video")[0];BizAPP.UI.Webcam.canvas.width=a.videoWidth;BizAPP.UI.Webcam.canvas.height=a.videoHeight;BizAPP.UI.Webcam.canvas.getContext("2d").drawImage(a,0,0);BizAPP.UI.Upload.UploadWebcamImage(event)}else{if(BizAPP.UI.Webcam.options.context==="flash"){window.webcam.capture();BizAPP.UI.Webcam.changeFilter();BizAPP.UI.Upload.UploadWebcamImage(event)}else{alert("No context was supplied to getSnapshot()")}}},getImageData:function(){var a=document.getElementById("canvas");return a.toDataURL()},stop:function(){if(BizAPP.UI.Webcam.localStream!=null){BizAPP.UI.Webcam.localStream.stop()}}};BizAPP.UI.JsonEditor={json1:{height:"100%",width:"100%",dataSource:"",title:"",axes:[{title:null,type:"categoryX",label:"Status",name:"NameAxis"},{title:"",minimumValue:0,type:"numericY",name:"PopulationAxis"}],subtitle:"",series:[{xAxis:"NameAxis",yAxis:"PopulationAxis",valueMemberPath:"Aggregate",thickness:5,isTransitionInEnabled:true,type:"column",name:"Issues",title:"Issues",isHighlightingEnabled:true}],container:"fromWidget"},json:"",selector:null,_html:'<div id="json-editor"><ul class="tbar">	<li id="vctab2" page="vcpage2" class="tbn tbact" onclick="BizAPP.UI.JsonEditor.ToggleActiveTab(this.id);">Editor</li>	<li id="vctab1" page="vcpage1" class="tbn" onclick="BizAPP.UI.JsonEditor.ToggleActiveTab(this.id);">JSON</li></ul>	<div id="vcpage1" rettab="true" class="tp"><div class="editor" style=""></div></div>	<div id="vcpage2" rettab="true" class="tp"><div class="json-string" style="">	<div id="editor" class="json-editor"></div></div></div>',Init:function(a,d){BizAPP.UI.JsonEditor.selector=getElementByBizAPPId(a,"input");var b=$(getElementByBizAPPId(a,"input"));b.after(BizAPP.UI.JsonEditor._html);BizAPP.UI.JsonEditor.LoadDependency(function(){$("#vcpage1").append(b);$("#editor").css("height",b.css("height"));$("#editor").css("overflow-y","auto");BizAPP.UI.JsonEditor.ToggleActiveTab("vctab2");var h=$(BizAPP.UI.JsonEditor.selector).val();if(h){try{BizAPP.UI.JsonEditor.json=JSON.parse(h)}catch(f){alert("Error in parsing json. "+f)}}$(document).ready(function(){$("#rest > button").click(function(){var e=$("#rest-url").val();$.ajax({url:e,dataType:"jsonp",jsonp:$("#rest-callback").val(),success:function(k){BizAPP.UI.JsonEditor.json=k;$("#editor").jsonEditor(BizAPP.UI.JsonEditor.json,{change:BizAPP.UI.JsonEditor.updateJSON,propertyclick:BizAPP.UI.JsonEditor.showPath});BizAPP.UI.JsonEditor.printJSON()},error:function(){alert("Something went wrong, double-check the URL and callback parameter.")}})});$(BizAPP.UI.JsonEditor.selector).change(function(){var m=$(BizAPP.UI.JsonEditor.selector).val();if(m){try{BizAPP.UI.JsonEditor.json=JSON.parse(m)}catch(k){alert("Error in parsing json. "+k)}}else{BizAPP.UI.JsonEditor.json={}}$("#editor").jsonEditor(BizAPP.UI.JsonEditor.json,{change:BizAPP.UI.JsonEditor.updateJSON,propertyclick:BizAPP.UI.JsonEditor.showPath})});BizAPP.UI.JsonEditor.printJSON(1);$("#editor").jsonEditor(BizAPP.UI.JsonEditor.json,{change:BizAPP.UI.JsonEditor.updateJSON,propertyclick:BizAPP.UI.JsonEditor.showPath});BizAPP.UI.JsonEditor.expandAll();$(".expander").click(function(){var e=$(this);if(e.hasClass("fa-minus")){e.removeClass("fa-minus").addClass("fa-plus")}else{e.removeClass("fa-plus").addClass("fa-minus")}});if(d){d()}})})},expandAll:function(){$(".array,.object").addClass("expanded");$(".expander").closest(".expanded").each(function(){var a=$(this).find(".expander").first();a.removeClass("fa-plus").addClass("fa-minus")})},updateJSON:function(a){BizAPP.UI.JsonEditor.json=a;BizAPP.UI.JsonEditor.printJSON()},printJSON:function(d){var b=$(BizAPP.UI.JsonEditor.selector);b.val(JSON.stringify(BizAPP.UI.JsonEditor.json,null,"\t"));if(!d){b.change()}},showPath1:function(){$("#path").text(path)},ToggleActiveTab:function(d){var b=$("#json-editor").find(".tbact").attr("page");$("#json-editor").find("#"+b).hide();$("#json-editor").find(".tbact").removeClass("tbact");var a=$("#"+d).attr("page");$("#json-editor").find("#"+a).show();$("#json-editor").find("#"+d).addClass("tbact");BizAPP.UI.JsonEditor.expandAll();$(BizAPP.UI.JsonEditor.selector).css("top","30px")},LoadDependency:function(a){$.cachedScript(BizAPP.UI.GetBasePath("Resources/JsonEditor/jquery.jsoneditor.min.js")).done(function(b,d){$.getCss(BizAPP.UI.GetBasePath("Resources/JsonEditor/jsoneditor.css"));BizAPP.UI.TextEditor.LoadFontAwesomeCss();setTimeout(a,10)})}};BizAPP.UI.TagEditor={Init:function(a,b){var d=$(getElementByBizAPPId(a,"input"));d.css("display","block").removeData("options").next(".tag-editor").remove();BizAPP.UI.TagEditor.LoadDependency(function(){d.tagEditor({initialTags:[],readOnly:b,autocomplete:{minLength:0,source:function(f,e){var h=d.closest(".form").attr("bizapp_eid");if(!d||d.length==0){return}realAjaxAsyncCall("HelperEx",getNextRequestId(),["GetAutoCompleteResults",d.closest("[bizapp_context]").attr("bizapp_context").split("\n")[0],f.term,h,d.attr("bza-ctrlid")],false,function(n,o,m){n=BizAPP.UI._handleEventsAndExceptions(n,o,m);var k=$.map(JSON.parse(n[1]),function(p){return{value:p.value||p.Value,label:p.autocompletelabel||p.label||p.value||p.Value}});e(k)})},select:function(e,f){if(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}this.value=f.item.label;d.val(f.item.value);if(d[0].hasAttribute("bza-tagappend")){d.val(d.attr("bza-tagappend")+"[SEP]"+f.item.value)}g_activeCtrl=d.attr("bizappid");d.change()}},forceLowercase:false,onChange:function(m,k,f,p,n){if(n){var e=new Object();$.each(f,function(t,q){e[q]=q});d.attr("bza-tag",JSON.stringify(e));d.attr("bza-tagappend",f.join("[SEP]"));var h=d.closest("[bizapp_name]").attr("bizapp_context").split("\n")[0];var o=d.attr("bza-fieldname");assignFieldValue(h,o,n,false,false,true)}},beforeTagSave:function(n,k,h,f,o){try{k.find("div.active").closest("li").remove()}catch(m){}},beforeTagDelete:function(h,f,e,k){}});if(g_activeCtrl){$('[bizappid="'+g_activeCtrl+'"]').next().click();g_activeCtrl=null}$(".tag-editor").attr("style",d.attr("style")).show().addClass("formtextbox");if(typeof(BizAPP.Bootstrap)!="undefined"){$(".tag-editor").addClass("form-control")}$(".tag-editor").css("height",d.css("height")).css("min-width",d.css("width")).css("width","auto").css("overflow","auto")})},LoadDependency:function(a){$.cachedScript(BizAPP.UI.GetBasePath("Resources/TagEditor/jquery.tag-editor.js")).done(function(b,d){$.getCss(BizAPP.UI.GetBasePath("Resources/TagEditor/jquery.tag-editor.css"));setTimeout(a,10)})}};BizAPP.UI.Localization={NoRecordsSelected:"No records selected",NoFileTAttach:"Select a file to upload"};BizAPP.MenuPopup={_template:'<i class="bza-dropdown dropdown-toggle {1}" data-toggle="toggle">{3}                            <div class="dropdown-menu {2}" onclick="BizAPP.MenuPopup.SuppressEvent(event)">			                    {0}<div class="bza-caret {2}"><i></i></div>                            </div>                        </i>',Create:function(f){if(!f.selector){$("body").append($(BizAPP.MenuPopup._template.format(f.html,f.mode,f.position,"")));return}else{if($(f.selector).find(".bza-dropdown").length){return}}f=$.extend({position:""},f||{});if(f.autodeleteonclose){f.position+=" bza-autoclose"}var e=f.type||$(f.selector)[0].tagName.toLowerCase();switch(e){case"input":case"textarea":case"img":if($(f.selector).next().hasClass("bza-dropdown")){return}$($(BizAPP.MenuPopup._template.format(f.html,f.mode,f.position,""))).insertAfter($(f.selector));var b=BizAPP.MenuPopup._findPos($(f.selector));var d=$(f.selector).next().find(".dropdown-menu");if(f.position.indexOf("pleft")!=-1){b.left-=(d.width()-30)}d.css({left:b.left+"px",top:b.top+"px",right:"inherit",position:"fixed"});break;default:var a=$(f.selector).html();$(f.selector).text("");$(f.selector).append($(BizAPP.MenuPopup._template.format(f.html,f.mode,f.position,a)));$(f.selector).css({position:"relative"});$(f.selector).on("click",function(h){h.stopPropagation();BizAPP.UI.Grid.RemoveNonAppliedFilter();$(".bza-dropdown").removeClass("open");$(this).find(".bza-dropdown").toggleClass("open");if(typeof(f.callback)!="undefined"){f.callback()}})}if(typeof(f.callback)!="undefined"){f.callback()}},_findPos:function(a){var b=$(a).offset();b.top+=a[0].offsetHeight;return{left:b.left-Math.floor($(window).scrollLeft()),top:b.top-Math.floor($(window).scrollTop())}},HideOrRemovePopup:function(){$(".bza-dropdown").each(function(){if($(this).find(".bza-autoclose").length>0){$(this).parent().append($(this).children()[0]);$(this).remove()}});$("input ~ .bza-dropdown").remove();$("textarea ~ .bza-dropdown").remove();$(".bza-dropdown").removeClass("open")},SuppressEvent:function(a){a.stopPropagation()}};BizAPP.UI.TileManager={Init:function(a){BizAPP.UI.LoadInfragistics(function(){a=$.extend(a||{},{columnWidth:"25%",marginLeft:10,marginTop:10});$(a.selector).igTileManager(a)})}};BizAPP.UI.Image={_target:null,Init:function(d,b,e){var a=$('[bza-ctrlid="'+d+'"]');BizAPP.UI.Image._target=a.wrap('<div id="container'+d+'" roid="'+b+'" field="'+e+'"></div>').parent();BizAPP.UI.Upload.RegisterDragDrop(BizAPP.UI.Image._target,function(f){BizAPP.UI.Image._target.find("img").attr("src","testresource.aspx?aid="+f)})}};BizAPP.UI.OAuth={prefetchState:null,PreFetch:function(a,b){if(BizAPP.UI.OAuth.prefetchState=="done"){b()}BizAPP.UI.OAuth.prefetchState="started";$.get(a+"/resources/javascripts/jquery/jquery.js",function(){},"text").done(function(){$.get(a+"/oauthproviderhost.html?v="+__bts_).done(function(){BizAPP.UI.OAuth.prefetchState="done";$("#bizappoauthiframe").remove();$("body").append('<iframe style="height:1px;width:1px" id="bizappoauthiframe" src="'+a+"/oauthproviderhost.html?v="+__bts_+'"></iframe>');setTimeout(b,500)})})},StartPrefetch:function(a){BizAPP.UI.OAuth.PreFetch(a,function(){ProcessingStatus(true,true);window.addEventListener("message",function(f){if(f.data.intent=="bizappoauth"){if(f.data.success==0){ProcessingStatus(false,true);if(f.data.error=="invalid_grant"){displayExceptions("Invalid username or password","")}BizAPP.UI.ProcessCallBacks(g_callBacks);$(".loginContainer").show()}else{if(f.data.success){if(f.data.token){var d={registry:"",enterprise:"",provider:"",UserName:"",Password:"",logouturl:"",domain:"",token:f.data.token};BizAPP.UI.OAuth.Login1(d,a)}else{customAjaxAsyncSuccess(JSON.stringify(f.data.d),"OK")}}}}});var b={registry:"",enterprise:"",provider:"",UserName:"",Password:"",logouturl:"",domain:""};BizAPP.UI.OAuth.Login(a,"",b)})},Login:function(b,d,a){$("#bizappoauthiframe")[0].contentWindow.postMessage({intent:"bizappoauth",msg:d,args:a},b)},Login1:function(a,b){var d={type:"POST",url:"silverlightdataaccess.asmx/jsonajaxcall",dataType:"text",contentType:"application/json; charset=utf-8",data:JSON.stringify({type:"CredentialsEx",enterpriseName:"",sessionId:"",args:["LoginWithOauthToken",a.registry,a.enterprise,a.provider,a.token,a.logouturl],id:1})};realAjaxAsyncCall("CredentialsEx",getNextRequestId(),["LoginWithOauthToken",a.registry,a.enterprise,a.provider,a.token,a.logouturl],true,function(f,e,k){var h=BizAPP.UI._handleEventsAndExceptions(f,e,k);if(f.value[3]){BizAPP.UI.OAuth.Logout(function(){});BizAPP.UI.ProcessCallBacks(g_callBacks);$(".loginContainer").show()}else{localStorage.setItem("bizapp_oauthhost",b)}})},Logout:function(b){var a=localStorage.getItem("bizapp_oauthhost");if(!a){b();return}BizAPP.UI.OAuth.PreFetch(a,function(){$("#bizappoauthiframe")[0].contentWindow.postMessage({intent:"bizappoauth",msg:"clear"},a);b()});localStorage.removeItem("bizapp_oauthhost")}};BizAPP.UI.User={DisplayOpenAuthProviders:function(a){var b='<iframe src="container.aspx?mode=oauth&callbackurl='+encodeURIComponent(window.parent.location.href)+'" style="height:40px;width:180px;border:0;"></iframe>';BizAPP.MenuPopup.Create({html:b,selector:$(a.target).closest(".bza-lnk-map-user").closest("td"),mode:"open",position:"bottom",callback:function(){a.stopPropagation()}})},RequestOAuth:function(a,b){window.onmessage=function(d){zoomout();ProcessingStatus(true,true);if(b){realAjaxAsyncCall("CredentialsEx",getNextRequestId(),["ProcessProviderResult",d.data,BizAPP.UI.User.GetNavUrl(BizAPP.UI.User.GetLoginUrl(true))],true,function(){if(b){b()}})}else{if(loginusingbizappoauth.toLowerCase()=="true"){$(".loginContainer").hide();BizAPP.UI.OAuth.StartPrefetch(oAuthHostUrl)}else{ajaxAsyncCall("CredentialsEx",["ProcessProviderResult",d.data,BizAPP.UI.User.GetNavUrl(BizAPP.UI.User.GetLoginUrl(true))])}}};window.open(a+"&v="+new Date().getTime(),"oauth","scrollbars=yes,resizable=yes,top=50,left=450,width=500,height=600");return false},GetLoginUrl:function(a){var d=(window.location!=window.parent.location)?document.referrer:document.location.href;try{d=d.replace("html.navurl="+d.split("html.navurl=")[1].split("&")[0],"")}catch(b){}return a?encodeURIComponent(d):d},GetNavUrl:function(d){var a=window.location.search.substring(1),b="";a.split("?");if(a){a=a.split("html.navurl=");if(a.length>1){b=a[1].split("&")[0]}}if(!b&&window.localStorage){b=localStorage.getItem("html.navurl")}if(!b){b="enterpriseview.aspx?html.logout="+d}else{if(b.indexOf("html.logout")==-1){b+=(decodeURIComponent(b).indexOf("?")==-1?"?":"&")+"html.logout="+d}}return b},GetAddress:function(a){$.get("http://api.ipstack.com/check?access_key=d4598765c739e9fa09f284283dcb7d7d",function(b){console.log(b);a(b)})}};BizAPP.UI.Scheduler={OptionsHTML:'<div class="scheduler-list-options popup-container" onclick="BizAPP.UI.Scheduler.ListOptions(event);">Options <i class="fa fa-sort-desc scheduler-option-icon"></i></div>',listOptionTemplate:'<div class="scheduler-list-options"><div class="scheduler-fldiv scheduler-day-view" onclick="BizAPP.UI.Scheduler.SelectOption(\'DayView\');"><span class="fa-stack fa-1x"><i class="fa fa-calendar-o"></i><span class="fa-stack-1x calendar-text">1</span></span>Day View</div>                        <div class="scheduler-fldiv scheduler-week-view" onclick="BizAPP.UI.Scheduler.SelectOption(\'WeekView\');"><span class="fa-stack fa-1x"><i class="fa fa-calendar-o"></i><span class="fa-stack-1x calendar-text">7</span></span>Week View</div>                        <div class="scheduler-fldiv scheduler-month-view" onclick="BizAPP.UI.Scheduler.SelectOption(\'MonthView\');"><span class="fa-stack fa-1x"><i class="fa fa-calendar-o"></i><span class="fa-stack-1x calendar-text">30</span></span>Month View</div>                        <div class="flsep scheduler-flsep"></div>{0}<div class="flsep scheduler-flsep"></div><div class="scheduler-fldiv scheduler-current-user" onclick="BizAPP.UI.Scheduler.SelectOption(\'CurrentUser\');"><i class="fa fa-user scheduler-user-icon"></i>&nbsp; Current User</div>                        <div class="scheduler-fldiv scheduler-all-users" onclick="BizAPP.UI.Scheduler.SelectOption(\'AllUsers\');"><i class="fa fa-users scheduler-users-icon"></i>&nbsp; All Users</div></div>',CreateUI:function(){$(".sccontrolscontainer").closest("tr").hide();if(!$(".scsecondcontrolstablecell").length){$('<tr valign="top"><td style="height:30px;"><table class="scsecondcontrolstable" cellspacing="0" cellpadding="0" style="border-color:Black;border-width:1px;border-style:Solid;border-collapse:collapse;"><tbody><tr valign="top" class="scheduler-legend-row"><td class="scsecondcontrolstablecell"></td><td style="width:5px;"></td></tr></tbody></table></td></tr>').insertAfter($(".sccontrolscontainer").closest("tr").next())}$(".scsecondcontrolstablecell").append(BizAPP.UI.Scheduler.OptionsHTML);$("td.scsecondcontrolstablecell").closest("tr").addClass("scheduler-legend-row")},ListOptions:function(f){var d="";var b='<div class="scheduler-fldiv scheduler-qry" onclick="BizAPP.UI.Scheduler.SelectQuery(event);"><i class="fa fa-bookmark-o scheduler-qry-icon"></i>&nbsp; {0}</div>';$("#Scheduler_MultiQueryPickerId option").each(function(){if($(this).text()){d=d+b.format($(this).text())}});BizAPP.UI.Scheduler.listOptionTemplate=BizAPP.UI.Scheduler.listOptionTemplate.format(d);var a=$(f.target).closest(".scsecondcontrolstablecell").find(".scheduler-list-options.popup-container");BizAPP.MenuPopup.Create({html:BizAPP.UI.Scheduler.listOptionTemplate,selector:a,mode:"open",position:"bottom",callback:function(){if(!g_hasSysAdminResp){$(".scheduler-all-users").hide()}f.stopPropagation()}})},SelectOption:function(a){switch(a){case"CurrentUser":$(".scbtncurrentuser").click();break;case"AllUsers":$(".scbtnalluser").click();break;case"DayView":$(".scbtndayview").click();break;case"WeekView":$(".scbtnweekview").click();break;case"MonthView":$(".scbtnmonthview").click();break;default:}},SelectQuery:function(a){$('[bizappid="Scheduler_MultiQueryPickerId"] option[selected]').removeAttr("selected");$('[bizappid="Scheduler_MultiQueryPickerId"] option').filter(function(){return($(this).text()==$(a.target).text())}).attr("selected","selected");$('[bizappid="Scheduler_MultiQueryPickerId"]').change()},Init:function(a){a=JSON.parse(a);var b=$(getElementByBizAPPId(a.id,"div"));if(b.length==0){b=$('[bza-ctrlid="'+a.id+'"]')}if(b.length==0){return}$.cachedScript("https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js").done(function(d,e){$.cachedScript("http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.4.0/fullcalendar.min.js").done(function(f,h){$.getCss("http://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.4.0/fullcalendar.min.css",function(){events=[];$.each(a.data,function(){events.push({id:this.uniqueid+":"+this.objecttype+":"+this.version,title:this.Subject,start:this.PlannedStartDate,end:this.PlannedEndDate,allDay:new Date(this.PlannedStartDate).toDateString()!=new Date(this.PlannedEndDate).toDateString()})});$(b).fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},eventLimit:true,events:function(m,k,o,n){if(events){events=null;n(events)}else{}},dayClick:function(o,m,k){var n=o._d;if(k.name=="month"){selectedDate=n.toDateString()}else{selectedDate=n.toDateString()+" "+n.getHours()+":"+n.getMinutes()}ajaxAsyncCall("SchedulerEx",["Drilldown",null,selectedDate,a.isform,a.formeid,a.ctrlname,b.closest("[bizapp_name].").attr("bizappid")],false,true)},eventClick:function(n,m,k){ajaxAsyncCall("SchedulerEx",["Drilldown",n.id,null,a.isform,a.formeid,a.ctrlname,b.closest("[bizapp_name].").attr("bizappid")],false,true)}})})})})}};BizAPP.UI.ClipBoard={Init:function(a,b){BizAPP.UI.LoadDependentFile("zeroclipboard.js",function(d,f){var e=new ZeroClipboard(a);e.on("ready",function(){console.log("Flash movie loaded and ready.");this.on("copy",function(h){var k=h.clipboardData;k.setData("text/plain",b.text())});this.on("aftercopy",function(h){if(h.data["text/plain"]){$(".bza-alrtMsg").text("Copied");$(".bza-alrtMsg").delay(2000).fadeOut()}})})})}};BizAPP.UI.ComboBox={Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.DateTimePicker={Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.StepControl={Init:function(b,a,d){if(d){d(b)}},CheckApplyStep:function(k,m,d,h,f,e,b,a){a()}};BizAPP.UI.TabControl={Init:function(b,a,d){if(d){d(b)}},ResponsiveInit:function(){}};BizAPP.UI.CheckBox={Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.RadioButton={Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.AttachmentControl={Init:function(b,a,d){if(d){d(b)}}};BizAPP.UI.Chart={PopulateData:function(){var a="Script.asmx?csn=bizapp&cn=chart&v="+__bts_;$.cachedScript(BizAPP.UI.GetBasePath(a)).done(function(){console.log("Chart js downloaded.");BizAPP.UI.Chart.PopulateData()})}};BizAPP.UI.ViewPersonalization={Init:function(){console.log("BizAPP.UI.ViewPersonalization.Init called.")}};BizAPP.UI.MFA={_template:'<div class="bza-mfa-cont"><span id="lblCookiePromptMsg" class="fp-msg-text">A mail containing the login cookie(valid for 30 minutes) has been sent to the registered email id.</span>        <br>Please enter the code below to continue<br><br>        <input type="text" class="bza-mfa-token" title="" placeholder="Enter the token"></input><br>        <input type="submit" name="btnSubmitToken" value="Continue" onclick="BizAPP.UI.MFA.Validate();" id="btnSubmitToken" class="btn-submit">	    <input type="submit" name="btnFPWCanToken" value="Cancel" onclick="" id="btnFPWCanToken" class="btn-submit canBtn" formnovalidate=""></div>',_popupTemplate:'<div class="tmask" style="opacity: 0.7; display: block;"></div>                      <div class="bza-alrtCont1 bza-alrtCont-warning1">	                    <div class="bza-alrtTitle">		                    <span class="ui-icon ui-icon-alert" style="display: inline-block;vertical-align:bottom;float:left;"></span>		                    <span style="float:left;">Validation</span>	                    </div>	                    <div class="bza-alrtBody">		                    <div class="bza-mfa-alrtBody">			                </div>	                    </div>                     </div>                    </div>',Init:function(a){$(a).append(BizAPP.UI.MFA._template)},Validate:function(){var a=$(".bza-mfa-token").val().trim();ajaxAsyncCall("CredentialsEx",["ValidateCookie",a,""],false,true)},PromptTokenInPopup:function(){BizAPP.UI.InlinePopup.CreateNew({width:500,html:BizAPP.UI.MFA._popupTemplate,stropenjs:"BizAPP.UI.MFA.Init('.bza-mfa-alrtBody');"})},_impvc:null,Impersonate:function(b,a){BizAPP.UI.LoadDependentFile("vue.js",function(){if(!BizAPP.UI.MFA._impvc){BizAPP.UI.MFA._impvc=Vue.component("impersonateMFA",{template:'<div class="modal fade" tabindex="-1" role="dialog" id="impMFA">                            <div class="modal-dialog" role="document">                                <div class="modal-content">                                <div class="modal-header">                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">                                        <span aria-hidden="true">&times;</span>                                    </button>                                    <h4 class="modal-title">Impersonate</h4>                                </div>                                <div class="modal-body">                                    <div class="form-group"><label>User to impersonate</label><input :readonly="step != 1" v-model="loginId" type="text" class="formtextbox form-control"></div>                                    <button v-if="step == 1" class="btn btn-primary" v-on:click="requestCode">Request Code</button>                                    <div v-if="step != 1" class="form-group"><label>Code (sent to the user\'s primary email)</label><input v-model="code" type="text" class="formtextbox form-control"></div>                                    <span v-if="step != 1" class="btn btn-primary" v-on:click="impersonate">Impersonate</span>                                </div>                                </div>                            </div>                        </div>',data:function(){return{loginId:b,code:"",step:b?2:1}},methods:{requestCode:function(){if(!this.loginId){return}var e=this;g_callBacks.push(function(){e.step=2});ajaxAsyncCall("ImpersonationControlEx",["ImpersonateFromLoginId",e.loginId],false,true)},impersonate:function(){ajaxAsyncCall("ImpersonationControlEx",["ImpersonateFromLoginId",this.loginId,this.code],false,true)}},mounted:function(){$("#impMFA").modal({show:1})}})}if($("#impMFA").length==0){$("body").append('<div id="impMFA"></div>')}var d=new BizAPP.UI.MFA._impvc();d.loginId=b;d.$mount("#impMFA")})}};BizAPP.UI.WordEditor={Init:function(a){if(BizAPP.UI.controlMapping&&BizAPP.UI.controlMapping.wordeditor){var b=BizAPP.UI.controlDependency[BizAPP.UI.controlMapping.wordeditor];if(b){$.cachedScript(BizAPP.UI.GetBasePath(b+"?v="+__bts_)).done(function(d,e){BizAPP.UI.WordEditor.Init(a)})}else{BizAPP.UI.WordEditor.InternalInit(a)}}else{BizAPP.UI.WordEditor.InternalInit(a)}},InternalInit:function(a){BizAPP.UI.WordEditor.showToolBar(a.ctrlId,"0");BizAPP.UI.WordEditor.renewSessionForControl(a.ctrlId);BizAPP.UI.WordEditor.loadObject(a.containerId,a.obj);BizAPP.UI.WordEditor.loadDocument(a.ctrlId,a.data,a.font)},renewSessionForControl:function(a){if(getElementByBizAPPId(a,"OBJECT")!=null){ajaxAsyncCall("HelperEx",["PingSession"],false,true);setTimeout("BizAPP.UI.WordEditor.renewSessionForControl('"+a+"');",5*60*1000)}},loadDocument:function(e,d,a){var b=BizAPP.UI.WordEditor.getWordObj(e);if(b){b.WordContentBase64=d;if(a&&a!=""&&a!=NaN&&a!=undefined){b.FontName=a}}},showToolBar:function(d,b){var a=BizAPP.UI.WordEditor.getWordObj(d);if(a){a.Toolbars=b}},setReadOnly:function(a){},loadObject:function(b,d){var a=BizAPP.UI.WordEditor.getWordObj(b);if(a){a.innerHTML="";a.innerHTML=d}},getWordObj:function(b){var a=document.getElementById(b);if(!a){wordControls=getBizAppElementsByClassName(document.body,"div","WordEditorEx");for(var d=0;d<wordControls.length;d++){if(wordControls[d].id.indexOf(b)!=-1){a=wordControls[d];break}}}return a},getHTMLValue:function(d){var b=BizAPP.UI.WordEditor.getWordObj(d);if(b){for(var a=0;a<50;a++){try{return b.HTMLContent}catch(e){logError("get Word HTML value failed.",e)}}}}};BizAPP.UI.AdvancedTab={LoadDefaultTab:function(a){$('[id="{0}"]'.format(a)).find(".tabLeftSelected").click()}};BizAPP.UI.DocumentViewer={Loaded:function(a,b){console.log("viewer loaded")},PageChange:function(a,b){console.log("Viewing page "+b.pageNumber)},LoadPage:function(a){$('iframe[src*="dv.aspx"]')[0].contentWindow.BizAPP.UI.DocumentViewer.LoadPage(a)},GetTotalPageCount:function(){return $('iframe[src*="dv.aspx"]')[0].contentWindow.BizAPP.UI.DocumentViewer.GetTotalPageCount()},SearchText:function(a){return $('iframe[src*="dv.aspx"]')[0].contentWindow.BizAPP.UI.DocumentViewer.SearchText(a)},PrintStart:function(a,b){console.log("PrintStart ")},Print:function(a,b){console.log("Print")}};BizAPP.UI.Drawing={_drawings:{},Init:function(a){$.cachedScript("https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js").done(function(){var b=$(a).find("canvas");if(!b.length){$(a).html('<canvas class="fill"></canvas>');b=$(a).find("canvas")}BizAPP.UI.Drawing._drawings[a]=new SignaturePad(b[0])})},GetDrawing:function(a,b){return BizAPP.UI.Drawing._drawings[a].toDataURL(b)}};BizAPP.Facebook={_loaded:false,LoadFacebook:function(a,b){if(!a){throw"appId not specified"}if(!BizAPP.Facebook._loaded){$.cachedScript("//connect.facebook.net/en_US/sdk.js").done(function(){FB.init({appId:a,version:"v2.10"});BizAPP.Facebook._loaded=true;b()})}else{b()}},CreatePost:function(b,a,d){BizAPP.Facebook.LoadFacebook(b,function(){FB.login(function(e){if(!e.authResponse){return}FB.ui(a,function(f){if(!f||f.error_message){addLog("FB Post - Error occured: "+f.error_message)}else{addLog("FB Post ID: "+f.post_id)}d(f)})})})}};