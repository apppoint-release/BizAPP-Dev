var JSGantt;if(!JSGantt){JSGantt={}}var vTimeout=0;var vBenchTime=new Date().getTime();JSGantt.TaskItem=function(x,z,e,c,m,v,y,t,q,N,b,F,l,w,E,B){var J=x;var L=z;var n=new Date();var A=new Date();var o=m;var G=v;var K=y;var H=t;var C=q;var f=N;var a=b;var d=F;var h=l;var M=w;var p="";var I=0;var r=0;var D=1;var u,P,s,O;if(f!=1){n=JSGantt.parseDateStr(e,g.getDateInputFormat());A=JSGantt.parseDateStr(c,g.getDateInputFormat())}this.pCustomCols=E;this.rowidCols=B;this.getID=function(){return J};this.getName=function(){return L};this.getStart=function(){return n};this.getEnd=function(){return A};this.getColor=function(){return o};this.getLink=function(){return G};this.getMile=function(){return K};this.getDepend=function(){if(h){return h}else{return null}};this.getCaption=function(){if(M){return M}else{return""}};this.getResource=function(){if(H){return H}else{return"&nbsp"}};this.getCompVal=function(){if(C){return C}else{return 0}};this.getCompStr=function(){if(C){return C+"%"}else{return""}};this.getDuration=function(Q){if(K){p="-"}else{if(Q=="hour"){tmpPer=Math.ceil((this.getEnd()-this.getStart())/(60*60*1000));if(tmpPer==1){p="1 Hour"}else{p=tmpPer+" Hours"}}else{if(Q=="minute"){tmpPer=Math.ceil((this.getEnd()-this.getStart())/(60*1000));if(tmpPer==1){p="1 Minute"}else{p=tmpPer+" Minutes"}}else{tmpPer=Math.ceil((this.getEnd()-this.getStart())/(24*60*60*1000)+1);if(tmpPer==1){p="1 Day"}else{p=tmpPer+" Days"}}}}return(p)};this.getParent=function(){return a};this.getGroup=function(){return f};this.getOpen=function(){return d};this.getLevel=function(){return I};this.getNumKids=function(){return r};this.getStartX=function(){return u};this.getStartY=function(){return P};this.getEndX=function(){return s};this.getEndY=function(){return O};this.getVisible=function(){return D};this.setDepend=function(Q){h=Q};this.setStart=function(Q){n=Q};this.setEnd=function(Q){A=Q};this.setLevel=function(Q){I=Q};this.setNumKid=function(Q){r=Q};this.setCompVal=function(Q){C=Q};this.setStartX=function(Q){u=Q};this.setStartY=function(Q){P=Q};this.setEndX=function(Q){s=Q};this.setEndY=function(Q){O=Q};this.setOpen=function(Q){d=Q};this.setVisible=function(Q){D=Q}};JSGantt.GanttChart=function(q,m,f){var y=q;var d=m;var a=f;var u=1;var n=1;var t=1;var o=1;var r=1;var s="mm/dd/yyyy";var h="mm/dd/yy";var l=0;var p;var c=1;var b=new Array();var v=new Array("day","week","month","quarter");var e=new Array(1,1,1,2,2,2,3,3,3,4,4,4);var w=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var x=new Array("January","February","March","April","May","June","July","August","September","October","November","December");this.setFormatArr=function(){v=new Array();for(var z=0;z<arguments.length;z++){v[z]=arguments[z]}if(v.length>4){v.length=4}};this.setShowRes=function(z){u=z};this.setShowDur=function(z){n=z};this.setShowComp=function(z){t=z};this.setShowStartDate=function(z){o=z};this.setShowEndDate=function(z){r=z};this.setDateInputFormat=function(z){s=z};this.setDateDisplayFormat=function(z){h=z};this.setCaptionType=function(z){p=z};this.setFormat=function(z){a=z;this.Draw()};this.getShowRes=function(){return u};this.getShowDur=function(){return n};this.getShowComp=function(){return t};this.getShowStartDate=function(){return o};this.getShowEndDate=function(){return r};this.getDateInputFormat=function(){return s};this.getDateDisplayFormat=function(){return h};this.getCaptionType=function(){return p};this.CalcTaskXY=function(){var D=this.getList();var F;var C;var E,A,z,B;for(i=0;i<D.length;i++){vID=D[i].getID();F=document.getElementById("taskbar_"+vID);vBarDiv=document.getElementById("bardiv_"+vID);C=document.getElementById("childgrid_"+vID);if(vBarDiv){D[i].setStartX(vBarDiv.offsetLeft);D[i].setStartY(C.offsetTop+vBarDiv.offsetTop+6);D[i].setEndX(vBarDiv.offsetLeft+vBarDiv.offsetWidth);D[i].setEndY(C.offsetTop+vBarDiv.offsetTop+6)}}};this.AddTaskItem=function(z){b.push(z)};this.getList=function(){return b};this.clearDependencies=function(){var A=document.getElementById("rightside");var B;var z=c;for(i=1;i<z;i++){B=document.getElementById("line"+i);if(B){A.removeChild(B)}}c=1};this.sLine=function(B,D,z,C){vLeft=Math.min(B,z);vTop=Math.min(D,C);vWid=Math.abs(z-B)+1;vHgt=Math.abs(C-D)+1;vDoc=document.getElementById("rightside");var A=document.createElement("div");A.id="line"+c++;A.style.position="absolute";A.style.margin="0px";A.style.padding="0px";A.style.overflow="hidden";A.style.border="0px";A.style.zIndex=0;A.style.backgroundColor="red";A.style.left=vLeft+"px";A.style.top=vTop+"px";A.style.width=vWid+"px";A.style.height=vHgt+"px";A.style.visibility="visible";vDoc.appendChild(A)};this.dLine=function(A,E,z,D){var H=z-A;var G=D-E;var F=A;var C=E;var B=Math.max(Math.abs(H),Math.abs(G));H=H/B;G=G/B;for(i=0;i<=B;i++){vx=Math.round(F);vy=Math.round(C);this.sLine(vx,vy,vx,vy);F+=H;C+=G}};this.drawDependency=function(A,C,z,B){if(A+10<z){this.sLine(A,C,A+4,C);this.sLine(A+4,C,A+4,B);this.sLine(A+4,B,z,B);this.dLine(z,B,z-3,B-3);this.dLine(z,B,z-3,B+3);this.dLine(z-1,B,z-3,B-2);this.dLine(z-1,B,z-3,B+2)}else{this.sLine(A,C,A+4,C);this.sLine(A+4,C,A+4,B-10);this.sLine(A+4,B-10,z-8,B-10);this.sLine(z-8,B-10,z-8,B);this.sLine(z-8,B,z,B);this.dLine(z,B,z-3,B-3);this.dLine(z,B,z-3,B+3);this.dLine(z-1,B,z-3,B-2);this.dLine(z-1,B,z-3,B+2)}};this.DrawDependencies=function(){this.CalcTaskXY();this.clearDependencies();var D=this.getList();for(var C=0;C<D.length;C++){vDepend=D[C].getDepend();if(vDepend){var z=vDepend+"";var F=z.split(",");var E=F.length;for(var A=0;A<E;A++){var B=this.getArrayLocationByID(F[A]);if(D[B].getVisible()==1){this.drawDependency(D[B].getEndX(),D[B].getEndY(),D[C].getStartX()-1,D[C].getStartY())}}}}};this.getArrayLocationByID=function(A){var B=this.getList();for(var z=0;z<B.length;z++){if(B[z].getID()==A){return z}}};this.Draw=function(){var N=new Date();var W=new Date();var D=new Date();var K=new Date();var E=new Date();var O=0;var Y=0;var H=0;var R=0;var z="";var B="";var S="";var Q="";var I="";var G=0;var F=0;var U=0;var A=0;var J=0;var P="";var M=220;var L=70;var X=15+220+70+70+70+70+70;if(b.length>0){JSGantt.processRows(b,0,-1,1,1);W=JSGantt.getMinDate(b,a);N=JSGantt.getMaxDate(b,a);if(a=="day"){G=18;F=1}else{if(a=="week"){G=37;F=7}else{if(a=="month"){G=37;F=30}else{if(a=="quarter"){G=60;F=90}else{if(a=="hour"){G=18;F=1}else{if(a=="minute"){G=18;F=1}}}}}}A=(Date.parse(N)-Date.parse(W))/(24*60*60*1000);l=A/F;U=l*G+1;J=(G/F)+(1/F);z="<TABLE id=theTable cellSpacing=0 cellPadding=0 border=0><TBODY><TR><TD vAlign=top bgColor=#ffffff>";if(u!=1){M+=L}if(n!=1){M+=L}if(t!=1){M+=L}if(o!=1){M+=L}if(r!=1){M+=L}B='<DIV class=scroll id=leftside><TABLE cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 20px">  <TD style="WIDTH: 15px; HEIGHT: 17px"></TD>  <TD style="WIDTH: '+M+'px; HEIGHT: 17px"><NOBR></NOBR></TD>';if(u==1){B+='  <TD style="WIDTH: '+L+'px; HEIGHT: 17px"></TD>'}if(n==1){B+='  <TD style="WIDTH: '+L+'px; HEIGHT: 17px"></TD>'}if(t==1){B+='  <TD style="WIDTH: '+L+'px; HEIGHT: 17px"></TD>'}if(o==1){B+='  <TD style="WIDTH: '+L+'px; HEIGHT: 17px"></TD>'}if(r==1){B+='  <TD style="WIDTH: '+L+'px; HEIGHT: 17px"></TD>'}B+='<TR style="HEIGHT: 20px">  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: 15px; HEIGHT: 20px"></TD>  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: '+M+'px; HEIGHT: 20px"><NOBR></NOBR></TD>';if(u==1){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>Resource</TD>'}if(n==1){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>Duration</TD>'}if(t==1){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>% Comp.</TD>'}if(o==1){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>Start Date</TD>'}if(r==1){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>End Date</TD>'}for(var V=0;V<pCustomCols.length;V++){B+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; HEIGHT: 20px" align=middle nowrap>'+b[0].pCustomCols[V].key+"</TD>"}B+="</TR>";for(V=0;V<b.length;V++){task=b[V];if(task.getGroup()){vBGColor="f3f3f3";vRowType="group"}else{vBGColor="ffffff";vRowType="row"}R=task.getID();rowid=task.rowidCols[1].value+":"+task.rowidCols[2].value+":"+task.rowidCols[0].value;if(task.getVisible()==0){B+="<TR id=child_"+R+" rowid="+rowid+" bgcolor=#"+vBGColor+' style="display:none"  onMouseover=g.mouseOver(this,'+R+',"left","'+vRowType+'") onMouseout=g.mouseOut(this,'+R+',"left","'+vRowType+'")>'}else{B+="<TR id=child_"+R+" rowid="+rowid+" bgcolor=#"+vBGColor+" onMouseover=g.mouseOver(this,"+R+',"left","'+vRowType+'") onMouseout=g.mouseOut(this,'+R+',"left","'+vRowType+'")>'}B+='  <TD class=gdatehead style="WIDTH: 15px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;">&nbsp;</TD>  <TD class=gname style="WIDTH: '+M+'px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px;" nowrap><NOBR><span style="color: #aaaaaa">';for(j=1;j<task.getLevel();j++){B+="&nbsp&nbsp&nbsp&nbsp"}B+="</span>";if(task.getGroup()){if(task.getOpen()==1){B+='<SPAN id="group_'+R+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+R+","+y+");"+y+'.DrawDependencies();">&ndash;</span><span style="color:#000000">&nbsp</SPAN>'}else{B+='<SPAN id="group_'+R+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+R+","+y+");"+y+'.DrawDependencies();">+</span><span style="color:#000000">&nbsp</SPAN>'}}else{B+='<span style="color: #000000; font-weight:bold; FONT-SIZE: 12px;">&nbsp&nbsp&nbsp</span>'}B+='<span style="cursor:pointer"> '+task.getName()+"</span></NOBR></TD>";if(u==1){B+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+task.getResource()+"</NOBR></TD>"}if(n==1){B+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+task.getDuration(a)+"</NOBR></TD>"}if(t==1){B+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+task.getCompStr()+"</NOBR></TD>"}if(o==1){B+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(task.getStart(),h)+"</NOBR></TD>"}if(r==1){B+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(task.getEnd(),h)+"</NOBR></TD>"}for(var T=0;T<pCustomCols.length;T++){B+='  <TD class=gname style="HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=middle><NOBR>'+task.pCustomCols[T].value+"</NOBR></TD>"}B+="</TR>"}B+='</TD></TR><TR><TD border=1 colspan=5 align=left style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 11px; BORDER-LEFT: #efefef 1px solid; height=18px">';if(v.join().indexOf("minute")!=-1){if(a=="minute"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="minute" checked>Minute'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("minute",'+y+'); VALUE="minute">Minute'}}if(v.join().indexOf("hour")!=-1){if(a=="hour"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="hour" checked>Hour'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("hour",'+y+'); VALUE="hour">Hour'}}if(v.join().indexOf("day")!=-1){if(a=="day"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="day" checked>Day'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("day",'+y+'); VALUE="day">Day'}}if(v.join().indexOf("week")!=-1){if(a=="week"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="week" checked>Week'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("week",'+y+') VALUE="week">Week'}}if(v.join().indexOf("month")!=-1){if(a=="month"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="month" checked>Month'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("month",'+y+') VALUE="month">Month'}}if(v.join().indexOf("quarter")!=-1){if(a=="quarter"){B+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="quarter" checked>Quarter'}else{B+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("quarter",'+y+') VALUE="quarter">Quarter'}}B+="</TD></TR></TBODY></TABLE></TD>";z+=B;S='<TD style="width: '+U+'px;" vAlign=top bgColor=#ffffff><DIV class=scroll2 id=rightside><TABLE style="width: '+U+'px;" cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 20px">';D.setFullYear(W.getFullYear(),W.getMonth(),W.getDate());D.setHours(0);D.setMinutes(0);while(Date.parse(D)<=Date.parse(N)){P=D.getFullYear()+"";P=P.substring(2,4);if(a=="minute"){S+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=60>';S+=JSGantt.formatDateStr(D,h)+" "+D.getHours()+":00 -"+D.getHours()+":59 </td>";D.setHours(D.getHours()+1)}if(a=="hour"){S+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=24>';S+=JSGantt.formatDateStr(D,h)+"</td>";D.setDate(D.getDate()+1)}if(a=="day"){S+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=7>'+JSGantt.formatDateStr(D,h.substring(0,5))+" - ";D.setDate(D.getDate()+6);S+=JSGantt.formatDateStr(D,h)+"</td>";D.setDate(D.getDate()+1)}else{if(a=="week"){S+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+G+"px>`"+P+"</td>";D.setDate(D.getDate()+7)}else{if(a=="month"){S+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+G+"px>`"+P+"</td>";D.setDate(D.getDate()+1);while(D.getDate()>1){D.setDate(D.getDate()+1)}}else{if(a=="quarter"){S+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+G+"px>`"+P+"</td>";D.setDate(D.getDate()+81);while(D.getDate()>1){D.setDate(D.getDate()+1)}}}}}}S+='</TR><TR style="HEIGHT: 21px">';D.setFullYear(W.getFullYear(),W.getMonth(),W.getDate());K.setFullYear(W.getFullYear(),W.getMonth(),W.getDate());H=0;while(Date.parse(D)<=Date.parse(N)){if(a=="minute"){if(D.getMinutes()==0){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">'+D.getMinutes()+"</div></td>";I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>';D.setMinutes(D.getMinutes()+1)}else{if(a=="hour"){if(D.getHours()==0){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">'+D.getHours()+"</div></td>";I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>';D.setHours(D.getHours()+1)}else{if(a=="day"){if(JSGantt.formatDateStr(E,"mm/dd/yyyy")==JSGantt.formatDateStr(D,"mm/dd/yyyy")){vWeekdayColor="ccccff";vWeekendColor="9999ff";vWeekdayGColor="bbbbff";vWeekendGColor="8888ff"}else{vWeekdayColor="ffffff";vWeekendColor="cfcfcf";vWeekdayGColor="f3f3f3";vWeekendGColor="c3c3c3"}if(D.getDay()%6==0){Q+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekendColor+' align=center><div style="width: '+G+'px">'+D.getDate()+"</div></td>";I+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekendColor+' align=center><div style="width: '+G+'px">&nbsp</div></td>'}else{Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">'+D.getDate()+"</div></td>";if(JSGantt.formatDateStr(E,"mm/dd/yyyy")==JSGantt.formatDateStr(D,"mm/dd/yyyy")){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}D.setDate(D.getDate()+1)}else{if(a=="week"){K.setDate(K.getDate()+7);if(E>=D&&E<K){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(K<=N){Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+G+'px><div style="width: '+G+'px">'+(D.getMonth()+1)+"/"+D.getDate()+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}else{Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; bgcolor=#'+vWeekdayColor+' BORDER-RIGHT: #efefef 1px solid;" align=center width:'+G+'px><div style="width: '+G+'px">'+(D.getMonth()+1)+"/"+D.getDate()+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}D.setDate(D.getDate()+7)}else{if(a=="month"){K.setFullYear(D.getFullYear(),D.getMonth(),w[D.getMonth()]);if(E>=D&&E<K){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(K<=N){Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+G+'px><div style="width: '+G+'px">'+x[D.getMonth()].substr(0,3)+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}else{Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+G+'px><div style="width: '+G+'px">'+x[D.getMonth()].substr(0,3)+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}D.setDate(D.getDate()+1);while(D.getDate()>1){D.setDate(D.getDate()+1)}}else{if(a=="quarter"){K.setDate(K.getDate()+122);if(D.getMonth()==0||D.getMonth()==1||D.getMonth()==2){K.setFullYear(D.getFullYear(),2,31)}else{if(D.getMonth()==3||D.getMonth()==4||D.getMonth()==5){K.setFullYear(D.getFullYear(),5,30)}else{if(D.getMonth()==6||D.getMonth()==7||D.getMonth()==8){K.setFullYear(D.getFullYear(),8,30)}else{if(D.getMonth()==9||D.getMonth()==10||D.getMonth()==11){K.setFullYear(D.getFullYear(),11,31)}}}}if(E>=D&&E<K){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(K<=N){Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+G+'px><div style="width: '+G+'px">Qtr. '+e[D.getMonth()]+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}else{Q+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+G+'px><div style="width: '+G+'px">Qtr. '+e[D.getMonth()]+"</div></td>";if(E>=D&&E<K){I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}else{I+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+G+'px">&nbsp&nbsp</div></td>'}}D.setDate(D.getDate()+81);while(D.getDate()>1){D.setDate(D.getDate()+1)}}}}}}}}S+=Q+"</TR>";S+="</TBODY></TABLE>";for(V=0;V<b.length;V++){D.setFullYear(W.getFullYear(),W.getMonth(),W.getDate());vTaskStart=b[V].getStart();vTaskEnd=b[V].getEnd();H=0;R=b[V].getID();l=(b[V].getEnd()-b[V].getStart())/(24*60*60*1000)+1;if(a=="hour"){l=(b[V].getEnd()-b[V].getStart())/(60*1000)+1}else{if(a=="minute"){l=(b[V].getEnd()-b[V].getStart())/(60*1000)+1}}if(b[V].getVisible()==0){S+="<DIV id=childgrid_"+R+' style="position:relative; display:none;">'}else{S+="<DIV id=childgrid_"+R+' style="position:relative">'}if(b[V].getMile()){S+='<DIV><TABLE style="position:relative; top:0px; width: '+U+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+R+' class=yesdisplay style="HEIGHT: 21px" onMouseover=g.mouseOver(this,'+R+',"right","mile") onMouseout=g.mouseOut(this,'+R+',"right","mile")>'+I+"</TR></TABLE></DIV>";Q=JSGantt.formatDateStr(vTaskStart,h);O=(Date.parse(b[V].getStart())-Date.parse(W))/(24*60*60*1000);Y=1;S+="<div id=bardiv_"+R+' style="position:absolute; top:0px; left:'+Math.ceil((O*(J)+1))+'px; height: 18px; width:160px; overflow:hidden;">  <div id=taskbar_'+R+' title="'+b[V].getName()+": "+Q+'" style="height: 16px; width:12px; overflow:hidden; cursor: pointer;" onclick=JSGantt.taskLink("'+b[V].getLink()+'",300,200);>';if(b[V].getCompVal()<100){S+="&loz;</div>"}else{S+="&diams;</div>"}if(g.getCaptionType()){vCaptionStr="";switch(g.getCaptionType()){case"Caption":vCaptionStr=b[V].getCaption();break;case"Resource":vCaptionStr=b[V].getResource();break;case"Duration":vCaptionStr=b[V].getDuration(a);break;case"Complete":vCaptionStr=b[V].getCompStr();break}S+='<div style="FONT-SIZE:12px; position:absolute; top:2px; width:120px; left:12px">'+vCaptionStr+"</div>"}S+="</div>"}else{Q=JSGantt.formatDateStr(vTaskStart,h)+" - "+JSGantt.formatDateStr(vTaskEnd,h);if(a=="minute"){Y=(Date.parse(b[V].getEnd())-Date.parse(b[V].getStart()))/(60*1000)+1/F;O=Math.ceil((Date.parse(b[V].getStart())-Date.parse(W))/(60*1000))}else{if(a=="hour"){Y=(Date.parse(b[V].getEnd())-Date.parse(b[V].getStart()))/(60*60*1000)+1/F;O=(Date.parse(b[V].getStart())-Date.parse(W))/(60*60*1000)}else{Y=(Date.parse(b[V].getEnd())-Date.parse(b[V].getStart()))/(24*60*60*1000)+1/F;O=Math.ceil((Date.parse(b[V].getStart())-Date.parse(W))/(24*60*60*1000));if(a="day"){var C=new Date();C.setTime(Date.parse(b[V].getStart()));if(C.getMinutes()>29){O+=0.5}}}}if(b[V].getGroup()){S+='<DIV><TABLE style="position:relative; top:0px; width: '+U+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+R+' class=yesdisplay style="HEIGHT: 21px" bgColor=#f3f3f3 onMouseover=g.mouseOver(this,'+R+',"right","group") onMouseout=g.mouseOut(this,'+R+',"right","group")>'+I+"</TR></TABLE></DIV>";S+="<div id=bardiv_"+R+' style="position:absolute; top:5px; left:'+Math.ceil(O*(J)+1)+"px; height: 7px; width:"+Math.ceil((Y)*(J)-1)+'px"><div id=taskbar_'+R+' title="'+b[V].getName()+": "+Q+'" class=gtask style="background-color:#000000; height: 7px; width:'+Math.ceil((Y)*(J)-1)+'px;  cursor: pointer;opacity:0.9;"><div style="Z-INDEX: -4; float:left; background-color:#666666; height:3px; overflow: hidden; margin-top:1px; margin-left:1px; margin-right:1px; filter: alpha(opacity=80); opacity:0.8; width:'+b[V].getCompStr()+'; cursor: pointer;" onclick=JSGantt.taskLink("'+b[V].getLink()+'",300,200);></div></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:1px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:1px; overflow: hidden; width:1px;"></div>';if(g.getCaptionType()){vCaptionStr="";switch(g.getCaptionType()){case"Caption":vCaptionStr=b[V].getCaption();break;case"Resource":vCaptionStr=b[V].getResource();break;case"Duration":vCaptionStr=b[V].getDuration(a);break;case"Complete":vCaptionStr=b[V].getCompStr();break}S+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil((Y)*(J)-1)+6)+'px">'+vCaptionStr+"</div>"}S+="</div>"}else{vDivStr='<DIV><TABLE style="position:relative; top:0px; width: '+U+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+R+' class=yesdisplay style="HEIGHT: 21px" bgColor=#ffffff onMouseover=g.mouseOver(this,'+R+',"right","row") onMouseout=g.mouseOut(this,'+R+',"right","row")>'+I+"</TR></TABLE></DIV>";S+=vDivStr;S+="<div id=bardiv_"+R+' style="position:absolute; top:4px; left:'+Math.ceil(O*(J)+1)+"px; height:18px; width:"+Math.ceil((Y)*(J)-1)+'px"><div id=taskbar_'+R+' title="'+b[V].getName()+": "+Q+'" class=gtask style="background-color:#'+b[V].getColor()+"; height: 13px; width:"+Math.ceil((Y)*(J)-1)+'px; cursor: pointer;opacity:0.9;" onclick=JSGantt.taskLink("'+b[V].getLink()+'",300,200); ><div class=gcomplete style="Z-INDEX: -4; float:left; background-color:black; height:5px; overflow: auto; margin-top:4px; filter: alpha(opacity=40); opacity:0.4; width:'+b[V].getCompStr()+'; overflow:hidden"></div></div>';if(g.getCaptionType()){vCaptionStr="";switch(g.getCaptionType()){case"Caption":vCaptionStr=b[V].getCaption();break;case"Resource":vCaptionStr=b[V].getResource();break;case"Duration":vCaptionStr=b[V].getDuration(a);break;case"Complete":vCaptionStr=b[V].getCompStr();break}S+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil((Y)*(J)-1)+6)+'px">'+vCaptionStr+"</div>"}S+="</div>"}}S+="</DIV>"}z+=S+"</DIV></TD></TR></TBODY></TABLE></BODY></HTML>";d.innerHTML=z}};this.mouseOver=function(C,B,z,A){if(z=="right"){vID="child_"+B}else{vID="childrow_"+B}C.bgColor="#ffffaa";vRowObj=JSGantt.findObj(vID);if(vRowObj){vRowObj.bgColor="#ffffaa"}};this.mouseOut=function(C,B,z,A){if(z=="right"){vID="child_"+B}else{vID="childrow_"+B}C.bgColor="#ffffff";vRowObj=JSGantt.findObj(vID);if(vRowObj){if(A=="group"){C.bgColor="#f3f3f3";vRowObj.bgColor="#f3f3f3"}else{C.bgColor="#ffffff";vRowObj.bgColor="#ffffff"}}}};JSGantt.isIE=function(){if(typeof document.all!="undefined"){return true}else{return false}};JSGantt.processRows=function(c,s,p,d,b){var q=new Date();var e=new Date();var l=0;var n=0;var o=c;var a=d;var f=0;var m=0;var r=0;var h=b;for(f=0;f<c.length;f++){if(c[f].getParent()==s){h=b;c[f].setVisible(h);if(h==1&&c[f].getOpen()==0){h=0}c[f].setLevel(a);m++;if(c[f].getGroup()==1){JSGantt.processRows(o,c[f].getID(),f,a+1,h)}if(l==0||c[f].getStart()<q){q=c[f].getStart();l=1}if(n==0||c[f].getEnd()>e){e=c[f].getEnd();n=1}r+=c[f].getCompVal()}}if(p>=0){c[p].setStart(q);c[p].setEnd(e);c[p].setNumKid(m);c[p].setCompVal(Math.ceil(r/m))}};JSGantt.getMinDate=function getMinDate(c,b){var a=new Date();a.setFullYear(c[0].getStart().getFullYear(),c[0].getStart().getMonth(),c[0].getStart().getDate());for(i=0;i<c.length;i++){if(Date.parse(c[i].getStart())<Date.parse(a)){a.setFullYear(c[i].getStart().getFullYear(),c[i].getStart().getMonth(),c[i].getStart().getDate())}}if(b=="minute"){a.setHours(0);a.setMinutes(0)}else{if(b=="hour"){a.setHours(0);a.setMinutes(0)}else{if(b=="day"){a.setDate(a.getDate()-1);while(a.getDay()%7>0){a.setDate(a.getDate()-1)}}else{if(b=="week"){a.setDate(a.getDate()-7);while(a.getDay()%7>0){a.setDate(a.getDate()-1)}}else{if(b=="month"){while(a.getDate()>1){a.setDate(a.getDate()-1)}}else{if(b=="quarter"){if(a.getMonth()==0||a.getMonth()==1||a.getMonth()==2){a.setFullYear(a.getFullYear(),0,1)}else{if(a.getMonth()==3||a.getMonth()==4||a.getMonth()==5){a.setFullYear(a.getFullYear(),3,1)}else{if(a.getMonth()==6||a.getMonth()==7||a.getMonth()==8){a.setFullYear(a.getFullYear(),6,1)}else{if(a.getMonth()==9||a.getMonth()==10||a.getMonth()==11){a.setFullYear(a.getFullYear(),9,1)}}}}}}}}}}return(a)};JSGantt.getMaxDate=function(c,b){var a=new Date();a.setFullYear(c[0].getEnd().getFullYear(),c[0].getEnd().getMonth(),c[0].getEnd().getDate());for(i=0;i<c.length;i++){if(Date.parse(c[i].getEnd())>Date.parse(a)){a.setTime(Date.parse(c[i].getEnd()))}}if(b=="minute"){a.setHours(a.getHours()+1);a.setMinutes(59)}if(b=="hour"){a.setHours(a.getHours()+2)}if(b=="day"){a.setDate(a.getDate()+1);while(a.getDay()%6>0){a.setDate(a.getDate()+1)}}if(b=="week"){a.setDate(a.getDate()+11);while(a.getDay()%6>0){a.setDate(a.getDate()+1)}}if(b=="month"){while(a.getDay()>1){a.setDate(a.getDate()+1)}a.setDate(a.getDate()-1)}if(b=="quarter"){if(a.getMonth()==0||a.getMonth()==1||a.getMonth()==2){a.setFullYear(a.getFullYear(),2,31)}else{if(a.getMonth()==3||a.getMonth()==4||a.getMonth()==5){a.setFullYear(a.getFullYear(),5,30)}else{if(a.getMonth()==6||a.getMonth()==7||a.getMonth()==8){a.setFullYear(a.getFullYear(),8,30)}else{if(a.getMonth()==9||a.getMonth()==10||a.getMonth()==11){a.setFullYear(a.getFullYear(),11,31)}}}}}return(a)};JSGantt.findObj=function(b,a){var e,c,d;if(!a){a=document}if((e=b.indexOf("?"))>0&&parent.frames.length){a=parent.frames[b.substring(e+1)].document;b=b.substring(0,e)}if(!(d=a[b])&&a.all){d=a.all[b]}for(c=0;!d&&c<a.forms.length;c++){d=a.forms[c][b]}for(c=0;!d&&a.layers&&c<a.layers.length;c++){d=JSGantt.findObj(b,a.layers[c].document)}if(!d&&document.getElementById){d=document.getElementById(b)}return d};JSGantt.changeFormat=function(a,b){if(b){b.setFormat(a);b.DrawDependencies()}else{alert("Chart undefined")}};JSGantt.folder=function(a,b){var c=b.getList();for(i=0;i<c.length;i++){if(c[i].getID()==a){if(c[i].getOpen()==1){c[i].setOpen(0);JSGantt.hide(a,b);if(JSGantt.isIE()){JSGantt.findObj("group_"+a).innerText="+"}else{JSGantt.findObj("group_"+a).textContent="+"}}else{c[i].setOpen(1);JSGantt.show(a,1,b);if(JSGantt.isIE()){JSGantt.findObj("group_"+a).innerText="–"}else{JSGantt.findObj("group_"+a).textContent="–"}}}}};JSGantt.hide=function(b,d){var e=d.getList();var a=0;for(var c=0;c<e.length;c++){if(e[c].getParent()==b){a=e[c].getID();JSGantt.findObj("child_"+a).style.display="none";JSGantt.findObj("childgrid_"+a).style.display="none";e[c].setVisible(0);if(e[c].getGroup()==1){JSGantt.hide(a,d)}}}};JSGantt.show=function(b,f,d){var e=d.getList();var a=0;for(var c=0;c<e.length;c++){if(e[c].getParent()==b){a=e[c].getID();if(f==1){if(JSGantt.isIE()){if(JSGantt.findObj("group_"+b).innerText=="+"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}else{if(JSGantt.findObj("group_"+b).textContent=="+"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}}else{if(JSGantt.isIE()){if(JSGantt.findObj("group_"+b).innerText=="–"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}else{if(JSGantt.findObj("group_"+b).textContent=="–"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}}if(e[c].getGroup()==1){JSGantt.show(a,0,d)}}}};JSGantt.taskLink=function(d,a,c){if(a){vWidth=a}else{vWidth=400}if(c){vHeight=c}else{vHeight=400}var b=window.open(d,"newwin","height="+vHeight+",width="+vWidth)};JSGantt.parseDateStr=function(a,d){var c=new Date();c.setTime(Date.parse(a));switch(d){case"mm/dd/yyyy":var b=a.split("/");c.setFullYear(parseInt(b[2],10),parseInt(b[0],10)-1,parseInt(b[1],10));break;case"dd/mm/yyyy":var b=a.split("/");c.setFullYear(parseInt(b[2],10),parseInt(b[1],10)-1,parseInt(b[0],10));break;case"yyyy-mm-dd":var b=a.split("-");c.setFullYear(parseInt(b[0],10),parseInt(b[1],10)-1,parseInt(b[1],10));break}return(c)};JSGantt.formatDateStr=function(b,c){vYear4Str=b.getFullYear()+"";vYear2Str=vYear4Str.substring(2,4);vMonthStr=(b.getMonth()+1)+"";vDayStr=b.getDate()+"";var a="";switch(c){case"mm/dd/yyyy":return(vMonthStr+"/"+vDayStr+"/"+vYear4Str);case"dd/mm/yyyy":return(vDayStr+"/"+vMonthStr+"/"+vYear4Str);case"yyyy-mm-dd":return(vYear4Str+"-"+vMonthStr+"-"+vDayStr);case"mm/dd/yy":return(vMonthStr+"/"+vDayStr+"/"+vYear2Str);case"dd/mm/yy":return(vDayStr+"/"+vMonthStr+"/"+vYear2Str);case"yy-mm-dd":return(vYear2Str+"-"+vMonthStr+"-"+vDayStr);case"mm/dd":return(vMonthStr+"/"+vDayStr);case"dd/mm":return(vDayStr+"/"+vMonthStr)}};JSGantt.parseXML=function(b,a){var d=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;try{xmlDoc=new ActiveXObject("Microsoft.XMLDOM")}catch(c){try{if(d==false){xmlDoc=document.implementation.createDocument("","",null)}}catch(c){alert(c.message);return}}JSGantt.ChromeLoadXML(b,a);ta=null};JSGantt.AddXMLTask=function(a){Task=xmlDoc.getElementsByTagName("task");var d=xmlDoc.documentElement.childNodes.length;for(var c=0;c<d;c++){try{pID=Task[c].getElementsByTagName("pID")[0].childNodes[0].nodeValue}catch(b){pID=0}pID*=1;if(pID!=0){try{pName=Task[c].getElementsByTagName("pName")[0].childNodes[0].nodeValue}catch(b){pName="No Task Name"}try{pColor=Task[c].getElementsByTagName("pColor")[0].childNodes[0].nodeValue}catch(b){pColor="0000ff"}try{pParent=Task[c].getElementsByTagName("pParent")[0].childNodes[0].nodeValue}catch(b){pParent=0}pParent*=1;try{pStart=Task[c].getElementsByTagName("pStart")[0].childNodes[0].nodeValue}catch(b){pStart=""}try{pEnd=Task[c].getElementsByTagName("pEnd")[0].childNodes[0].nodeValue}catch(b){pEnd=""}try{pLink=Task[c].getElementsByTagName("pLink")[0].childNodes[0].nodeValue}catch(b){pLink=""}try{pMile=Task[c].getElementsByTagName("pMile")[0].childNodes[0].nodeValue}catch(b){pMile=0}pMile*=1;try{pRes=Task[c].getElementsByTagName("pRes")[0].childNodes[0].nodeValue}catch(b){pRes=""}try{pComp=Task[c].getElementsByTagName("pComp")[0].childNodes[0].nodeValue}catch(b){pComp=0}pComp*=1;try{pGroup=Task[c].getElementsByTagName("pGroup")[0].childNodes[0].nodeValue}catch(b){pGroup=0}pGroup*=1;try{pOpen=Task[c].getElementsByTagName("pOpen")[0].childNodes[0].nodeValue}catch(b){pOpen=1}pOpen*=1;try{pDepend=Task[c].getElementsByTagName("pDepend")[0].childNodes[0].nodeValue}catch(b){pDepend=0}if(pDepend.length==0){pDepend=""}try{pCaption=Task[c].getElementsByTagName("pCaption")[0].childNodes[0].nodeValue}catch(b){pCaption=""}a.AddTaskItem(new JSGantt.TaskItem(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption,pCustomCols,rowidCols))}}};XMLLoader=new XMLHttpRequest();JSGantt.ChromeLoadXML=function(b,a){XMLLoader.onreadystatechange=function(){JSGantt.ChromeXMLParse(a)};XMLLoader.open("GET",b,false);XMLLoader.send(null)};JSGantt.ChromeXMLParse=function(a){if(XMLLoader.readyState==4){JSGantt.XMLParse(a,XMLLoader.responseText)}};JSGantt.XMLParse=function(z,x){var w=x.split(/<task>/gi);rowidCols=new Array();pCustomCols=new Array();var d=new DOMParser();var v=d.parseFromString(x,"text/xml");var B=v.childNodes[0].childNodes[0].getElementsByTagName("*");for(E=0;E<B.length;E++){if("pID , pName, pStart, pEnd, pColor,  pLink, pMile, pRes,  pComp, pGroup, pParent, pOpen, pDepend, uniqueid, objecttype, version, displayname".indexOf(B[E].nodeName.toString())==-1){pCustomCols.push(B[E].nodeName)}if("uniqueid, objecttype, version".indexOf(B[E].nodeName.toString())!=-1){rowidCols.push(B[E].nodeName)}}var A=w.length;for(var E=1;E<A;E++){var y=[];var a=[];Task=w[E].replace(/<[/]p/g,"<p");var p=Task.split(/<pid>/i);if(p.length>2){var q=p[1]}else{var q=0}q*=1;var p=Task.split(/<pName>/i);if(p.length>2){var o=p[1]}else{var o="No Task Name"}var p=Task.split(/<pstart>/i);if(p.length>2){var h=p[1]}else{var h=""}var p=Task.split(/<pEnd>/i);if(p.length>2){var e=p[1]}else{var e=""}var p=Task.split(/<pColor>/i);if(p.length>2){var D=p[1]}else{var D="0000ff"}var p=Task.split(/<pLink>/i);if(p.length>2){var C=p[1]}else{var C=""}var p=Task.split(/<pMile>/i);if(p.length>2){var l=p[1]}else{var l=0}l*=1;var p=Task.split(/<pRes>/i);if(p.length>2){var H=p[1]}else{var H=""}var p=Task.split(/<pComp>/i);if(p.length>2){var f=p[1]}else{var f=0}f*=1;var p=Task.split(/<pGroup>/i);if(p.length>2){var s=p[1]}else{var s=0}s*=1;var p=Task.split(/<pParent>/i);if(p.length>2){var c=p[1]}else{var c=0}c*=1;var p=Task.split(/<pOpen>/i);if(p.length>2){var G=p[1]}else{var G=1}G*=1;var p=Task.split(/<pDepend>/i);if(p.length>2){var b=p[1]}else{var b=""}if(b.length==0){b=""}var p=Task.split(/<pCaption>/i);if(p.length>2){var r=p[1]}else{var r=""}for(j=0;j<pCustomCols.length;j++){var m=pCustomCols[j];var F=Task.split("<"+m+">");if(F.length>1){if(m.indexOf("p")==0){keyValue=F[1]}else{keyValue=F[1].substr(0,F[1].indexOf("<"))}}else{keyValue=""}var u={key:m,value:keyValue};a.push(u)}for(k=0;k<rowidCols.length;k++){var m=rowidCols[k];var F=Task.split("<"+m+">");if(F.length>1){keyValue=F[1].substr(0,F[1].indexOf("<"))}else{keyValue=""}var t={key:m,value:keyValue};y.push(t)}z.AddTaskItem(new JSGantt.TaskItem(q,o,h,e,D,C,l,H,f,s,c,G,b,r,a,y))}};JSGantt.benchMark=function(a){var b=new Date().getTime();alert(a+": Elapsed time: "+((b-vBenchTime)/1000)+" seconds.");vBenchTime=new Date().getTime()};